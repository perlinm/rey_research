\documentclass[nofootinbib,notitlepage,11pt]{revtex4-2}

%%% linking references
\usepackage{hyperref}
\hypersetup{
  breaklinks=true,
  colorlinks=true,
  linkcolor=blue,
  filecolor=magenta,
  urlcolor=cyan,
}

%%% header / footer
\usepackage{fancyhdr} % easier header and footer management
\pagestyle{fancy} % page formatting style
\fancyhf{} % clear all header and footer text
\renewcommand{\headrulewidth}{0pt} % remove horizontal line in header
\usepackage{lastpage} % for referencing last page
\cfoot{\thepage~of \pageref{LastPage}} % "x of y" page labeling


%%% symbols, notations, etc.
\usepackage{physics,braket,bm,amssymb} % physics and math
\renewcommand{\t}{\text} % text in math mode
\newcommand{\f}[2]{\dfrac{#1}{#2}} % shorthand for fractions
\newcommand{\p}[1]{\left(#1\right)} % parenthesis
\renewcommand{\sp}[1]{\left[#1\right]} % square parenthesis
\renewcommand{\set}[1]{\left\{#1\right\}} % curly parenthesis
\newcommand{\bk}{\Braket} % shorthand for braket notation

\renewcommand{\c}{\cdot} % inner product
\renewcommand{\oc}{\circ} % element-wise product

\newcommand{\m}{\bm} % bold symbol
\renewcommand{\v}{\vec} % arrow vector

\usepackage{dsfont} % for identity operator
\newcommand{\1}{\mathds{1}}

\newcommand{\up}{\uparrow}
\newcommand{\dn}{\downarrow}

\renewcommand{\d}{\text{d}}
\newcommand{\x}{\text{x}}
\newcommand{\y}{\text{y}}
\newcommand{\z}{\text{z}}

\newcommand{\B}{\mathcal{B}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\E}{\mathcal{E}}
\renewcommand{\H}{\mathcal{H}}
\newcommand{\I}{\mathcal{I}}
\renewcommand{\L}{\mathcal{L}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\N}{\mathcal{N}}
\renewcommand{\O}{\mathcal{O}}
\renewcommand{\P}{\mathcal{P}}
\newcommand{\Q}{\mathcal{Q}}
\newcommand{\R}{\mathcal{R}}
\newcommand{\T}{\mathcal{T}}
\renewcommand{\S}{\mathcal{S}}
\newcommand{\V}{\mathcal{V}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\Y}{\mathcal{Y}}
\newcommand{\Z}{\mathcal{Z}}

\newcommand{\EE}{\mathbb{E}}
\newcommand{\RR}{\mathbb{R}}
\renewcommand{\SS}{\mathbb{S}}
\newcommand{\VV}{\mathbb{V}}
\newcommand{\ZZ}{\mathbb{Z}}

\newcommand{\FS}{\text{FS}}
\newcommand{\EQFS}{=_{\text{FS}}}
\newcommand{\col}{\overline}

\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\cov}{cov}
\let\var\oldvar
\DeclareMathOperator{\var}{var}
\DeclareMathOperator{\diag}{diag}
\let\flat\oldflat
\DeclareMathOperator{\flat}{flat}
\DeclareMathOperator{\counts}{counts}
\newcommand{\flatvec}{\underline\flat\,}
\newcommand{\ul}{\underline}

\usepackage{accents}
\newcommand{\ut}{\undertilde}

\newcommand{\floor}[1]{\lfloor{#1}\rfloor}
\newcommand{\ceil}[1]{\lceil{#1}\rceil}

\def\obra#1{\mathinner{({#1}|}}
\def\oket#1{\mathinner{|{#1})}}
\def\obk#1{\mathinner{({#1})}}
\def\oop#1#2{\oket{#1}\!\obra{#2}}

\usepackage[inline]{enumitem} % in-line lists and \setlist{} (below)
\setlist[enumerate,1]{label={(\roman*)}} % default in-line numbering
\setlist{nolistsep} % more compact spacing between environments

%%% text markup
\usepackage{color} % text color
\newcommand{\red}[1]{{\color{red} #1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\title{Perturbing SU($n$)-symmetric interactions}%
\author{Michael A. Perlin}%
\date{\today}

\maketitle

\tableofcontents

\section{Introduction}

We consider an array of $N$ multilevel spins with non-uniform
SU($n$)-symmetric interactions that can be written in the form
\begin{align}
  H_0 = \sum_{p<q} h_{pq} \Pi_{pq},
  &&
  \Pi_{pq} \equiv \sum_{\mu,\nu} S_{\mu\nu}^{(p)} S_{\nu\mu}^{(q)},
  \label{eq:ints}
\end{align}
where $p,q$ index individual spins; $\mu,\nu$ index states in an
orthonormal basis for the $n$-dimensional Hilbert space $\H_n$ of a
single spin; $h_{pq}$ are scalar coefficients; the operator
$S_{\mu\nu}^{(p)}\equiv\op{\mu}{\nu}_p$ flips the state of spin $p$ to
$\ket\mu$ from $\ket\nu$; and the operator $\Pi_{pq}$ permutes the
states of spins $p$ and $q$.  The permutation operator $\Pi_{pq}$ is a
multilevel generalization of the SU(2)-symmetric spin interaction
$\v S_p\c\v S_q$ for $\v S=\p{S_\x,S_\y,S_\z}$.

We wish to determine the effective dynamics induced on the
ground-state manifold $\M_0$ of $H_0$ by weak single- and two-body
perturbations of the form
\begin{align}
  \V_1 \equiv \sum_X \sum_p v_{Xp} X_p = \sum_X \v v_X\c\v X,
  &&
  \V_2 \equiv \sum_O \sum_{p<q} w_{Opq} O_{pq}
  = \sum_O \v{\m w}_O\c \v{\m O}
  \label{eq:perturbations}
\end{align}
where $p,q$ index individual spins; $v_{Xp}$ and $w_{Opq}$ are real
numbers; $X$ is a trace-zero single-body operator on $\H_n$; $O$ is a
trace-zero two-body operator on $\H_n\otimes\H_n$; $\v v_X$ and $\v X$
are $N$-component vectors defined by
\begin{align}
  \v v_X \equiv \sum_p v_{Xp} \ket{p},
  &&
  \v X \equiv \sum_p X_p \ket{p};
\end{align}
and finally $\v{\m w_O}$ and $\v{\m O}$ are ${N \choose 2}$-component
vectors defined by
\begin{align}
  \v{\m w}_O \equiv \sum_{p<q} w_{Opq} \ket{\set{p,q}},
  &&
  \v{\m O} \equiv \sum_{p<q} O_{pq} \ket{\set{p,q}},
\end{align}
where the basis vectors $\ket{\set{p,q}}$ are labeled by a choice of
two distinct spins $p,q$.

If the coefficients $h_{pq}$ of the interaction Hamiltonian $H_0$ are
all negative, then the ground-state manifold $\M_0$ of the interaction
Hamiltonian $H_0$ consists of fully symmetric states that are
simultaneous $+1$ eigenstates of all permutation operators $\Pi_{pq}$.
We will adopt the restriction that all $h_{pq}<0$ throughout these
notes, but note that this restriction can be relaxed to the assumption
that the initial state of the spins is fully symmetric (e.g.~a
spin-polarized state).  We will also assume throughout these notes
that the fully symmetric manifold $\M_0$ is gapped away from all other
states by an interaction energy difference that is large compared to
any coupling between $\M_0$ and its orthogonal complement.  The
precise conditions for such a non-vanishing many-body interaction
energy gap is an important question that deserves further study in
future work.

The effective Hamiltonian $H_M$ induced on the ground-state manifold
$\M_0$ by an $M$-body perturbation $\V_M$ through second order in
perturbation theory is given by\cite{bravyi2011schrieffer,
  perlin2019effective}
\begin{align}
  H_M = H_M^{(1)} + H_M^{(2)},
  &&
  H_M^{(1)} = \P_0 \V_M \P_0,
  &&
  H_M^{(2)} = - \P_0 \V_M \E \V_M \P_0,
  &&
  \E \equiv \sum_{\Delta\ne0} \f{\P_\Delta}{\Delta},
\end{align}
where $\P_\Delta$ is a projector onto the eigenspace of the
interaction Hamiltonian $H_0$, with interaction energy $\Delta$ above
that of fully symmetric manifold $\M_0$; that is, the interaction
energy of states in the image of $\P_\Delta$ is $E_0+\Delta$, where
\begin{align}
  E_0 = \sum_{p<q} h_{pq}
\end{align}
is the interaction energy of fully symmetric states $\ket\psi\in\M_0$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Single-body perturbations}
\label{sec:single_body_pert}

To compute the effective Hamiltonian induced by the single-body
perturbation $\V_1$, we use the permutational symmetry of the
ground-state manifold to simplify
\begin{align}
  H_1^{(1)} = \sum_{X,p} v_{Xp} \P_0 X_p \P_0
  \EQFS \sum_{X,p} v_{Xp} X_0
  \EQFS \sum_X \bar v_X \col{X},
  \label{eq:H_1_1}
\end{align}
where $\EQFS$ denotes equality under a restriction to the fully
symmetric manifold $\M_0$, and
\begin{align}
  \bar v_X \equiv \f1N \sum_p v_{Xp},
  &&
  \col{X} \equiv \sum_p X_p,
\end{align}
are respectively the mean value in $\v v_X$ and the collective version
of $X$.  In order to compute the second order effective Hamiltonian
$H_1^{(2)}$, we first choose an arbitrary fully symmetric state
$\ket\psi\in\M_0$ and expand (see Appendix \ref{sec:H_V1_psi}):
\begin{align}
  H_0 \V_1 \ket\psi
  = E_0 \V_1 \ket\psi
  + \sum_X \p{\sum_{p,q} h_{pq} v_{Xp} X_q - \sum_p h_p v_{Xp} X_p}
  \ket\psi,
  &&
  h_p \equiv \sum_q h_{pq},
  \label{eq:H_V1_psi}
\end{align}
where we define $h_{pq}$ for all $p,q$ (as opposed to only $p<q$) by
enforcing $h_{pq}=h_{qp}$ and $h_{pp}=0$.  We thus find that a
perturbation $\V_1^\Delta\ket\psi$ indexed by a scalar $\Delta$ is an
eigenvector of the interaction Hamiltonian $H_0$ if its coefficient
vectors $\v v_X^\Delta$ all satisfy the eigenvalue equation
\begin{align}
  \p{\m h - \diag\v h}\c\v v = \Delta \v v,
  &&
  \m h \equiv \sum_{p,q} h_{pq} \op{p}{q},
  &&
  \v h \equiv \sum_q h_q \ket{q},
  \label{eq:cond_1}
\end{align}
where $\diag\v h\equiv\sum_p h_p \op{p}$ is a matrix with $\v h$ on
the diagonal and zeros everywhere else.  Solving the general
eigenvalue problem in \eqref{eq:cond_1} requires diagonalizing the
$N\times N$ matrix $\m h-\diag\v h$.  When the interaction Hamiltonian
$H_0$ is translationally invariant, however, this eigenvalue problem
can be solved analytically; we provide the corresponding solution in
Appendix \ref{sec:trans_inv}.

If we {\it construct} a perturbation $\V_1^\Delta$ with coefficients
$\v v_X^\Delta$ that satisfy \eqref{eq:cond_1} with eigenvalue
$\Delta$, then
\begin{align}
  H_0 \V_1^\Delta \ket\psi = \p{E_0 + \Delta} \V_1^\Delta \ket\psi.
\end{align}
Interestingly, the energy of the (unnormalized) state
$\V_1^\Delta\ket\psi$ depends only on the coefficients
$\v v_X^\Delta$, and is entirely independent of the state $\ket\psi$
or the choice of a trace-zero single-body operators $X$ used to build
$\V_1^\Delta$.  Finding operators $\V_1^\Delta$ that generate
eigenvectors of the interaction Hamiltonian $H_0$ when they act on
fully symmetric states $\ket\psi$ thus reduces to finding eigenvectors
of the interaction matrix $\m h-\diag\v h$.

If the fully symmetric manifold $\M_0$ is gapped away from all other
states, then then a vector $\V_1^\Delta\ket\psi$ with $\Delta=0$ must
lie within the fully symmetric manifold $\M_0$, which implies that the
operator $\V_1^\Delta$ preserves the permutational symmetry of $\M_0$.
Indeed, a constant vector $\v\1\equiv\p{1,1,1,\cdots}$ of ones
satisfies the condition in \eqref{eq:cond_1} with eigenvalue $0$,
which implies that all vectors $\v v$ satisfying \eqref{eq:cond_1}
with $\Delta\ne0$ must be orthogonal to $\v\1$, and therefore
mean-zero.

We now return to the task of computing the second-order effective
Hamiltonian $H_1^{(2)}$.  Any coefficient vector $\v v_X$ can be
expanded into its projections $\v v_X^\Delta$ onto the eigenspace of
vectors satisfying \eqref{eq:cond_1} with eigenvalue $\Delta$,
i.e.~$\v v_X = \sum_\Delta \v v_X^\Delta$, which also allows us to
expand
\begin{align}
  \V_1 = \sum_\Delta \V_1^\Delta,
  &&
  \V_1^\Delta \equiv \sum_X \v v_X^\Delta \c \v X,
\end{align}
where each operator $\V_1^\Delta$ generates a state with definite
interaction energy $\Delta$ above that of the fully symmetric manifold
$\M_0$.  We can therefore simplify
\begin{align}
  H_1^{(2)}
  = - \P_0 \V_1 \E \V_1 \P_0
  = - \sum_{\Delta\ne0} \f1{\Delta}
  \P_0 \V_1^\Delta \P_\Delta \V_1^\Delta \P_0
  = - \sum_{\Delta\ne0} \f1{\Delta} \P_0 \p{\V_1^\Delta}^2 \P_0,
\end{align}
where the product $\P_0 \p{\V_1^\Delta}^2 \P_0$ is worked out in
Appendix \ref{sec:PXYP}.  In total, we find
\begin{align}
  H_1^{(2)}
  \EQFS \f1{N\p{N-1}} \sum_{X,Y} \sum_{\Delta\ne0}
  \f{\v v_X^\Delta\c\v v_Y^\Delta}{\Delta}
  \p{\col{X}\,\col{Y} - N\, \col{XY}},
  \label{eq:H_1_2}
\end{align}
where $\EQFS$ denotes equality under a restriction to the fully
symmetric manifold $\M_0$; $\v v_X^\Delta$ is the projection of
$\v v_X$ onto the $\Delta$-eigenspace of the matrix $\m h-\diag\v h$;
and for any single-body operator $Z$, we define the collective operator
\begin{align}
  \col{Z} \equiv \sum_p Z_p.
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Two-body perturbations}
\label{sec:two_body_pert}

The first-order effective Hamiltonian $H_2^{(1)}$ induced on the fully
symmetric manifold $\M_0$ by the two-body perturbation $\V_2$ in
\eqref{eq:perturbations} is simply the restriction of $\V_2$ onto
$\M_0$:
\begin{align}
  H_2^{(1)} = \sum_O \sum_{p<q} w_{Opq} \P_0 O_{pq} \P_0
  \EQFS \sum_O \sum_{p<q} w_{Opq} O_{0,1}
  \EQFS \sum_O \bar w_O \col{O},
\end{align}
where
\begin{align}
  \bar w_O \equiv {N \choose 2}^{-1} \sum_{p<q} w_{Opq},
  &&
  \col{O} \equiv \sum_{p<q} O_{pq},
\end{align}
are an average of $w_{Opq}$ and a collective version of the two-body
operator $O_{pq}$.  If the two-body operator $O=X\otimes Y$, then
\begin{align}
  H_2^{(1)} \EQFS \f12 \sum_{\p{X,Y}} \bar w_{\p{X,Y}}
  \p{\col{X}\,\col{Y} - \col{XY}}.
\end{align}
In order to compute the second-order effective Hamiltonian
$H_2^{(2)}$, as before we pick an arbitrary fully symmetric state
$\ket\psi\in\M_0$ and expand (see Appendix \ref{sec:H_V2_psi})
\begin{align}
  H_0 \V_2 \ket\psi
  = E_0 \V_2 \ket\psi
  + \f12 \sum_{p\ne q} \sp{2\bar h_{pq} w_{Opq}
    + \sum_k \p{h_{pk} w_{Okq} + w_{Opk} h_{kq}}}
  O_{pq} \ket\psi,
  \label{eq:H_V2_psi}
\end{align}
where to keep notation compact, we define
\begin{align}
  \bar h_{pq} \equiv h_{pq} - \f12\p{h_p + h_q},
  &&
  h_p \equiv \sum_q h_{pq},
\end{align}
and we define $w_{Opq}$ for all $p,q$ (as opposed to only $p<q$) by
enforcing $w_{Opq}=w_{Oqp}$ and $w_{Opp}=0$.  We thus find that the
vector $\V_2^\Delta\ket\psi$ indexed by a scalar $\Delta$ is an
eigenvector of the interaction Hamiltonian $H_0$ if its coefficients
$\v{\m w}_O^\Delta$ all satisfy the eigenvalue equation
\begin{align}
  \check{\m h} \c \v{\m w} = \Delta \v{\m w},
  \label{eq:cond_2}
\end{align}
where
\begin{align}
  \check{\m h} \equiv 2\sum_{p<q} \bar h_{pq} \op{\set{p,q}}
  + \sum_{p<q} \ket{\set{p,q}} \sum_{k\notin\set{p,q}}
  \p{h_{pk} \bra{\set{k,q}} + h_{kq} \bra{\set{p,k}}}.
  \label{eq:h_super_mat}
\end{align}
The eigenvalue problem in \eqref{eq:cond_2} can be simplified somewhat
when the interaction Hamiltonian $H_0$ is translationally invariant;
we discuss this simplification in Appendix \ref{sec:trans_inv}.

If we {\it construct} a perturbation $\V_2^\Delta$ with coefficients
$\v{\m w}_O^\Delta$ that satisfy \eqref{eq:cond_2} with eigenvalue
$\Delta$, then
\begin{align}
  H_0 \V_2^\Delta \ket\psi = \p{E_0 + \Delta} \V_2^\Delta \ket\psi,
\end{align}
which implies that $\V_2^\Delta\ket\psi$ is an (unnormalized state of
definite energy that depends only on the coefficients $\m w_O^\Delta$.
Similarly to the case of single-body perturbations, we can decompose
any vector $\v{\m w}_O$ into its projections $\v{\m w}_O^\Delta$ onto
the eigenspace of vectors satisfying \eqref{eq:cond_2} with eigenvalue
$\Delta$, i.e.~$\v{\m w}_O=\sum_\Delta\v{\m w}_O^\Delta$, which allows
us to expand
\begin{align}
  \V_2 = \sum_\Delta \V_2^\Delta,
  &&
  \V_2^\Delta \equiv \sum_O \v{\m w}_O^\Delta \c \v{\m O},
\end{align}
and in turn write
\begin{align}
  H_2^{(2)} = - \P_0 \V_2^\Delta \E \V_2^\Delta \P_0
  = -\sum_{\Delta\ne0} \f1\Delta \P_0 \p{\V_2^\Delta}^2 \P_0,
\end{align}
where the product $\P_0 \p{\V_2^\Delta}^2 \P_0$ is simplified in
Appendices \ref{sec:POQP} and \ref{sec:multi_to_collective}.  In the
special case that
\begin{align}
  \V_2 = \sum_{p<q} w_{pq} s_\z^{(p)} s_\z^{(q)},
\end{align}
where $s_\z\equiv\p{\op\up-\op\dn}/2$ is an SU(2) spin-$z$ operator,
then
\begin{align}
  H_2^{(2)} \EQFS W_4 S_\z^4 - W_2 S_\z^2,
\end{align}
where $S_\z\equiv\sum_p s_\z^{(p)}$ is a collective SU(2) spin
operator, $W_k$ are scalar coefficients, and we have neglected scalar
terms in $H_2^{(2)}$ without physical consequence.  In order to expand
the coefficients $W_k$, for any ${N \choose 2}$-component vector
$\v{\m m}=\sum_{p<q}m_{pq}\ket{\set{p,q}}$ we define the $N$-component
vector
\begin{align}
  \v m \equiv \sum_{p,q} m_{pq} \ket{p},
\end{align}
where we define $m_{pq}$ for all $p,q$ (as opposed to only $p<q$) by
enforcing $m_{pq}=m_{qp}$ and $m_{pp}=0$.  We then denote the
projection of $\v{\m m}$ onto the $\Delta$-eigenspace of the matrix
$\check{\m h}$ defined in \eqref{eq:h_super_mat} by $\v{\m m}_\Delta$,
which allows us to expand
\begin{align}
  W_4
  \equiv \sum_{\Delta\ne0} \f1\Delta \f{\v w_\Delta\c\v w_\Delta
    - \v{\m w}_\Delta\c\v{\m w}_\Delta}{N!_4},
\end{align}
and
\begin{align}
  W_2
  \equiv \sum_{\Delta\ne0} \f1{\Delta} \sp{\f{\v w_\Delta\c\v w_\Delta
      - 2\v{\m w}_\Delta\c\v{\m w}_\Delta}{4N!_2}
    + \f{\p{3N-4}\p{\v w_\Delta\c\v w_\Delta
        - \v{\m w}_\Delta\c\v{\m w}_\Delta}}{2N!_4}},
\end{align}
where
\begin{align}
  N!_k \equiv \prod_{j=0}^{k-1} \p{N-j} = \f{N!}{\p{N-k}!}.
\end{align}

\newpage
\appendix

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Diagnosing perturbed states with the interaction Hamiltonian}

Here we simplify vectors of the form $H_0\V_M\ket\psi$ to arrive at
the expansions in \eqref{eq:H_V1_psi} and \eqref{eq:H_V2_psi}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Single-body perturbation}
\label{sec:H_V1_psi}

We wish to simplify
\begin{align}
  H_0 \V_1 \ket\psi
  = \sum_{X,k} \sum_{p<q} h_{pq} v_{Xk} \Pi_{pq} X_k \ket\psi,
  \label{eq:H_V1_psi_start}
\end{align}
which has terms with $k\in\set{p,q}$, and terms with
$k\notin\set{p,q}$.  In the case of $k\notin\set{p,q}$, the
permutation operator $\Pi_{pq}$ commutes with $X_k$ and annihilates on
$\ket\psi$, leaving terms at each fixed $k$ of the form
\begin{align}
  \sum_{\substack{p<q\\k\notin\set{p,q}}} h_{pq}
  = \sum_{p<q} h_{pq} - \sum_{\substack{p<q\\k\in\set{p,q}}} h_{pq}
  = E_0 - \f12 \sum_{\substack{p,q\\k\in\set{p,q}}} h_{pq}
  = E_0 - h_k,
\end{align}
where we define $h_{pq}$ for all $p,q$ (as opposed to only $p<q$) by
enforcing $h_{pq}=h_{qp}$ and $h_{pp}=0$; and
$h_k \equiv \sum_\ell h_{k\ell}$.  The terms in
\eqref{eq:H_V1_psi_start} with $k\notin\set{p,q}$ are then
\begin{align}
  \sum_X \sum_{\substack{p<q\\k\notin\set{p,q}}}
  h_{pq} v_{Xk} \Pi_{pq} X_k \ket\psi
  = \sum_{X,k} \p{E_0 - h_k} v_{Xk} X_k \ket\psi
  = E_0 \V_1 \ket\psi - \sum_{X,k} h_k v_{Xk} X_k \ket\psi
\end{align}
while the terms in \eqref{eq:H_V1_psi_start} with $k\in\set{p,q}$ for
each fixed $X$ take the form
\begin{align}
  \sum_{\substack{p<q\\k\in\set{p,q}}}
  h_{pq} v_{Xk} \Pi_{pq} X_k \ket\psi
  = \sum_{k<q} h_{kq} v_{Xk} X_q \ket\psi
  + \sum_{p<k} h_{pk} v_{Xk} X_p \ket\psi
  = \sum_{k,q} h_{kq} v_{Xk} X_q \ket\psi
\end{align}
which implies
\begin{align}
  H_0 \V_1 \ket\psi
  = E_0 \V_1 \ket\psi
  + \sum_X \p{\sum_{p,q} h_{pq} v_{Xp} X_q - \sum_p h_p v_{Xp} X_p}
  \ket\psi.
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Two-body perturbation}
\label{sec:H_V2_psi}

We wish to simplify
\begin{align}
  H_0 \V_2 \ket\psi
  = \sum_O \sum_{\substack{k<\ell\\p<q}} w_{Ok\ell} h_{pq}
  \Pi_{pq} O_{k\ell} \ket\psi,
  \label{eq:H_V2_psi_start}
\end{align}
which has terms with $\set{p,q}=\set{k,\ell}$, terms with
$p,q\notin\set{k,\ell}$, and terms with only one of $p$ or
$q\in\set{k,\ell}$.  The permutation operator $\Pi_{pq}$ acts
trivially on $O_{k_\ell}\ket\psi$ when $\set{p,q}=\set{k,\ell}$ or
$p,q\notin\set{k,\ell}$, leaving terms at each fixed $k,\ell$ of the
form
\begin{align}
  h_{k\ell} + \sum_{\substack{p<q\\p,q\notin\set{k,\ell}}} h_{pq}
  = \sum_{p<q} h_{pq}
  - \sum_{\substack{p\in\set{k,\ell}\\q\notin\set{k,\ell}}} h_{pq}
  = E_0 - h_k - h_\ell + 2 h_{k\ell}
  = E_0 + 2 \bar h_{k\ell},
\end{align}
where
\begin{align}
  \bar h_{k\ell} \equiv h_{k\ell} - \f12\p{h_k + h_\ell}.
\end{align}
The corresponding terms in \eqref{eq:H_V2_psi_start} with
$\set{p,q}=\set{k,\ell}$ or $p,q\notin\set{k,\ell}$ are then
\begin{align}
  E_0 \V_2 \ket\psi
  + \sum_O \sum_{k<\ell} 2 \bar h_{k\ell} w_{Ok\ell} O_{k\ell} \ket\psi.
\end{align}
Using similar techniques, we can simplify the terms in
\eqref{eq:H_V2_psi_start} with only one of $p,q\in\set{k,\ell}$ to
\begin{align}
  \f12 \sum_{k\ne\ell} \sum_q \p{h_{kq} w_{Oq\ell} + w_{Okq} h_{q\ell}}
  O_{k\ell} \ket\psi.
\end{align}
In total,
\begin{align}
  H_0 \V_2 \ket\psi
  &= E_0 \V_2 \ket\psi
  + \sum_{k<\ell} 2\bar h_{k\ell} w_{Ok\ell} O_{k\ell} \ket\psi
  + \f12 \sum_{k\ne\ell} \sum_q \p{h_{kq} w_{Oq\ell} + w_{Okq} h_{q\ell}}
  O_{k\ell} \ket\psi \\
  &= E_0 \V_2 \ket\psi
  + \f12 \sum_{k\ne\ell} \sp{2\bar h_{k\ell} w_{Ok\ell}
    + \sum_q \p{h_{kq} w_{Oq\ell} + w_{Okq} h_{q\ell}}}
  O_{k\ell} \ket\psi.
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Simplifying operator products restricted to the fully
  symmetric manifold}
\label{sec:sym_prod}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Single-body product}
\label{sec:PXYP}

Calculating the second-order effective Hamiltonian $H_1^{(2)}$ induced
on the fully symmetric manifold $\M_0$ by the perturbation $\V_1$ in
\eqref{eq:perturbations} requires us to simplify
\begin{align}
  \P_0 \p{\V_1^\Delta}^2 \P_0
  \EQFS \sum_{\substack{X,Y\\p,q}} v_{Xp} v_{Yq} X_p Y_q
  = \sum_{X,Y,p} v_{Xp} v_{Yp} X_p Y_p
  + \sum_{\substack{X,Y\\p\ne q}} v_{Xp} v_{Yq} X_p Y_q,
  \label{eq:PXYP_start}
\end{align}
where $\EQFS$ denotes equality under a restriction to the fully
symmetric manifold $\M_0$; and all coefficient vectors $\v v_X$
satisfy \eqref{eq:cond_1} with eigenvalue $\Delta\ne0$, which implies
that all $\v v_X$ are mean-zero.  The first sum on the right of
\eqref{eq:PXYP_start} is then
\begin{align}
  \sum_{X,Y,p} v_{Xp} v_{Yp} X_p Y_p
  \EQFS \sum_{X,Y,p} v_{Xp} v_{Yp} X_0 Y_0
  \EQFS \f1N \sum_{X,Y} \v v_X \c\v v_Y \col{XY},
  &&
  \col{Z} \equiv \sum_p Z_p.
  \label{eq:PXYP_eq}
\end{align}
The second sum on the right of \eqref{eq:PXYP_start}, meanwhile, is
\begin{align}
  \sum_{\substack{X,Y\\p\ne q}} v_{Xp} v_{Yq} X_p Y_q
  \EQFS \sum_{\substack{X,Y\\p\ne q}} v_{Xp} v_{Yq} X_0 Y_1,
  \label{eq:PXYP_neq_start}
\end{align}
where we can use the fact that the vectors $\v v_X,\v v_Y$ are
mean-zero to simplify the sum over $p\ne q$ in
\eqref{eq:PXYP_neq_start} to
\begin{align}
  \sum_{p\ne q} v_{Xp} v_{Yq}
  = \sum_{p,q} v_{Xp} v_{Yq} - \sum_{p=q} v_{Xp} v_{Yq}
  = - \v v_X\c\v v_Y,
\end{align}
In order to simplify the product of operators in
\eqref{eq:PXYP_neq_start}, we expand
\begin{align}
  \col{X}\,\col{Y} = \sum_{p,q} X_p Y_q
  = \sum_{p=q} X_p Y_q + \sum_{p\ne q} X_p Y_q
  \EQFS \col{XY} + N\p{N-1} X_0 Y_1,
  \label{eq:PXYP_neq_ops}
\end{align}
which implies that
\begin{align}
  \sum_{\substack{X,Y\\p\ne q}} v_{Xp} v_{Yq} X_p Y_q
  \EQFS - \sum_{X\ne Y} \v v_X\c\v v_Y X_0 Y_1
  \EQFS - \f1{N\p{N-1}}\sum_{X,Y} \v v_X\c\v v_Y
  \p{\col{X}\,\col{Y} - \col{XY}}.
  \label{eq:PXYP_neq}
\end{align}
Altogether, we have that
\begin{align}
  \P_0 \p{\V_1^\Delta}^2 \P_0
  = - \f1{N\p{N-1}} \sum_{X,Y} \v v_X \c\v v_Y
  \p{\col{X}\,\col{Y} - N\,\col{XY}}.
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Two-body product}
\label{sec:POQP}

Calculating the second-order effective Hamiltonian $H_2^{(2)}$ induced
on the fully symmetric manifold $\M_0$ by the perturbation $\V_2$ in
\eqref{eq:perturbations} requires us to simplify
\begin{align}
  \P_0 \p{\V_2^\Delta}^2 \P_0
  = \sum_{O,Q} \sum_{\substack{k<\ell\\p<q}}
  w_{Ok\ell} w_{Qpq} O_{k\ell} Q_{pq}
  \EQFS \f14 \sum_{O,Q} \sum_{k,\ell,p,q}
  w_{Ok\ell} w_{Qpq} O_{k\ell} Q_{pq},
  \label{eq:POQP_start}
\end{align}
where $\EQFS$ denotes equality under a restriction to the fully
symmetric manifold $\M_0$; we define $w_{Opq}$ for all $p,q$ (as
opposed to only $p<q$) by enforcing $w_{Opq}=w_{Oqp}$ and $w_{Opp}=0$;
and the coefficient vectors $\v w_O$ satisfy the eigenvalue equation
\eqref{eq:cond_2} with eigenvalue $\Delta\ne0$, which implies that all
$\v{\m w}_O$ are mean-zero.  To simplify the sum in
\eqref{eq:POQP_start}, we first consider the terms with
$\p{p,q}=\p{k,\ell}$:
\begin{align}
  \sum_{k<\ell}
  w_{Ok\ell} w_{Qk\ell} O_{k\ell} Q_{k\ell}
  = \v{\m w}_O \c \v{\m w}_Q O_{0,1} Q_{0,1}.
\end{align}
We then consider terms $p\in\set{k,\ell}$ and $q\notin\set{k,\ell}$ or
vice versa:
\begin{align}
  \f14 \sum_{\substack{k,\ell\\p\in\set{k,\ell}\\q\notin\set{k,\ell}}}
  w_{Ok\ell} w_{Qpq} O_{k\ell} Q_{pq}
  &\EQFS \f14 \sum_{\substack{k,\ell\\q\notin\set{k,\ell}}}
  w_{Ok\ell} w_{Qkq} \p{O_{0,1} Q_{0,2} + O_{0,1} Q_{1,2}} \\
  \f14 \sum_{\substack{k,\ell\\p\notin\set{k,\ell}\\q\in\set{k,\ell}}}
  w_{Ok\ell} w_{Qpq} O_{k\ell} Q_{pq}
  &\EQFS \f14 \sum_{\substack{k,\ell\\q\notin\set{k,\ell}}}
  w_{Ok\ell} w_{Qkq} \p{O_{0,1} Q_{2,0} + O_{0,1} Q_{2,1}},
\end{align}
where
\begin{align}
  \f14 \sum_{\substack{k,\ell\\q\notin\set{k,\ell}}} w_{Ok\ell} w_{Qkq}
  = \f14 \sum_{k,\ell,q} w_{Ok\ell} w_{Qkq}
  - \f14 \sum_{k,\ell} w_{Ok\ell} w_{Qk\ell}
  = \f14 \v w_O\c\v w_Q - \f12 \v{\m w}_O \c \v{\m w}_Q.
\end{align}
Finally, the terms in \eqref{eq:POQP_start} with
$p,q\notin\set{k,\ell}$ are
\begin{align}
  \f14 \sum_{\substack{k,\ell\\p,q\notin\set{k,\ell}}}
  w_{Ok\ell} w_{Qpq} O_{k\ell} Q_{pq}
  \EQFS \f14 \sum_{\substack{k,\ell\\p,q\notin\set{k,\ell}}}
  w_{Ok\ell} w_{Qpq} O_{0,1} Q_{2,3},
\end{align}
where, using the fact that all $\v{\m w}_O$ are mean-zero,
\begin{multline}
  \f14 \sum_{\substack{k,\ell\\p,q\notin\set{k,\ell}}} w_{Ok\ell} w_{Qpq}
  = - \f14 \sum_{\substack{k,\ell\\p,q\in\set{k,\ell}}} w_{Ok\ell} w_{Qpq}
  - \f14 \sum_{\substack{k,\ell\\p\in\set{k,\ell}\\q\notin\set{k,\ell}}}
  w_{Ok\ell} w_{Qpq}
  - \f14 \sum_{\substack{k,\ell\\p\notin\set{k,\ell}\\q\in\set{k,\ell}}}
  w_{Ok\ell} w_{Qpq} \\
  = -\v w_O \c \v w_Q + \v{\m w}_O \c \v{\m w}_Q.
\end{multline}
Altogether, we thus have that
\begin{multline}
  \P_0 \p{\V_2^\Delta}^2 \P_0
  \EQFS - \sum_{O,Q} \bigg[
  \p{\v w_O \c \v w_Q - \v{\m w}_O \c \v{\m w}_Q} O_{0,1} Q_{2,3}
  - \v{\m w}_O \c \v{\m w}_Q O_{0,1} Q_{0,1} \\
  -\f14 \p{\v w_O\c\v w_Q - 2 \v{\m w}_O \c \v{\m w}_Q}
  O_{0,1} \p{Q_{0,2} + Q_{2,0} + Q_{1,2} + Q_{2,1}} \bigg].
  \label{eq:POQP}
\end{multline}
In principle, our next task is to write this result in terms of
collective operators within the fully symmetric manifold; this task
turns out to be rather non-trivial in general.  We therefore discuss
the decomposition of multi-local operators (e.g.~$O_{0,1} Q_{1,2}$, a
3-local operator) into a sum of collective operators within the fully
symmetric manifold in Appendix \ref{sec:multi_to_collective}.  At the
end of Appendix \ref{sec:multi_to_collective}, we provide analytical
expressions for the special cases of
\begin{enumerate*}
\item multi-local operators that are tensor powers of a single
  operator, i.e.~of the form $X^{\otimes k}$; and
\item multi-local operators of the form $X^{\otimes k}$ with $X^2=1$.
\end{enumerate*}
These cases are relevant for e.g.~the SU(2) case with Ising-type
interactions of the form $Z\otimes Z$, with $Z$ a single-spin Pauli
operator.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Analytical results in translationally invariant systems}
\label{sec:trans_inv}

Here we simplify the eigenvalue problems that appear at second order
in the single- and two-body theory in Sections
\ref{sec:single_body_pert} and \ref{sec:two_body_pert} in the case of
a translationally invariant system with periodic boundary conditions.
We solve the single-body eigenvalue problem analytically, and reduce
the two-body eigenvalue problem to that of diagonalizing an
$\floor{N/2}\times\floor{N/2}$ matrix.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Single-body eigenvalue problem}
\label{sec:trans_inv_single}

For reference, the single-body eigenvalue problem is
\begin{align}
  \p{\m h - \diag\v h}\c\v v = \Delta \v v,
  \label{eq:cond_1_ref}
\end{align}
where $\m h$ is a matrix of all couplings $h_{pq}$ that appear in the
interaction Hamiltonian $H_0$ in \eqref{eq:ints}; $\v h$ is a vector
of all $h_p\equiv\sum_q h_{pq}$; $\diag\v h$ is a matrix with $\v h$
on the diagonal and zeroes everywhere else; and $\v v$ is a vector of
coefficients used to construct the single-body perturbation
$\V_1\p{\v v}$ defined in \eqref{eq:perturbations}.  When the
interaction Hamiltonian $H_0$ is translationally invariant, the
couplings $h_{pq}$ depend only on the separation $\abs{p-q}$, so the
eigenvectors of $\m h$ are plane waves of the form
\begin{align}
  \v v_k \equiv \sum_p e^{ipk} \ket{p},
\end{align}
where $k\in\ZZ_N\times2\pi/N$.  The corresponding eigenvalues can be
determined by expanding
\begin{align}
  \m h\c\v v_k = \sum_{p,q} h_{pq} e^{iqk} \ket{p}
  = \sum_{p,d} h_{p,d+p} e^{i\p{d+p}k} \ket{p}
  = \sum_d h_{0,d} e^{idk} \sum_p e^{ipk}\ket{p}
  = \sum_d h_{0,d} \cos\p{dk} \v v_k.
\end{align}
The remainder of \eqref{eq:cond_1_ref} that we need to sort out is
$\diag\v h$, where all $h_p=\sum_qh_{pq}=\sum_dh_{0,d}$ are equal,
which implies that $\diag\v h=\sum_dh_{0,d}$ is a scalar.  We thus
find that
\begin{align}
  \p{\m h - \diag\v h}\c\v v_k = \Delta_k \v v_k,
  &&
  \Delta_k \equiv \sum_d h_{0,d} \sp{\cos\p{dk}-1}.
\end{align}
Note that $\Delta_k=\Delta_{-k}$, which implies that there are at most
$\lceil N/2\rceil$ distinct eigenvalues of $\m h - \diag\v h$ (one of
which is $\Delta_0=0$).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Two-body eigenvalue problem}
\label{sec:trans_inv_two}

The two-body eigenvalue equation in \eqref{eq:cond_2} is designed to
find solutions $\m w$ to the equation
\begin{align}
  \p{2h_{pq}-h_p-h_q} w_{pq}
  + \sum_{k\notin\set{p,q}} \p{h_{pk} w_{kq} + w_{pk} h_{kq}}
  = \Delta w_{pq},
  \label{eq:cond_2_ref_start}
\end{align}
where $h_p\equiv\sum_q h_{pq}$.  If the interaction Hamiltonian $H_0$
and perturbation $\V_2\p{\m w}$ are translationally invariant, then
the couplings $h_{pq}$ and coefficients $w_{pq}$ depend only on the
separation $\abs{p-q}$.  In this case, all $h_p=h_0$ are equal, and
\eqref{eq:cond_2_ref_start} can be written in the form
\begin{align}
  2 \m h\circ \m w + \m h\c\m w + \m w\c\m h
  = \sp{\Delta + 2h_0} \m w,
  \label{eq:cond_2_ref}
\end{align}
where $\m h\circ\m w$ denotes an element-wise (Kronecker) product of
$\m h$ and $\m w$, i.e.~with matrix elements $h_{pq}w_{pq}$.  In order
to find solutions to \eqref{eq:cond_2_ref}, we we expand the matrices
$\m h,\m w$ in a basis that respects translational symmetry.  To this
end, for all $d\in\ZZ_N$ we define the {\it shift matrices}
\begin{align}
  \m s_d \equiv \sum_p \op{p+d}{p},
\end{align}
where the sum $p+d$ is implicitly taken modulo $N$.  The shift
matrices allow us to expand
\begin{align}
  \m h = \sum_{p,q} h_{pq} \op{p}{q}
  = \sum_{d,q} h_{q+d,q} \op{q+d}{q}
  = \sum_d h_{d,0} \m s_d,
  &&
  \m w = \sum_d w_{d,0} \m s_d,
\end{align}
and write the condition in \eqref{eq:cond_2_ref} as
\begin{align}
  \sum_{d\ne 0} h_{d,0} w_{d,0} \m s_d
  + \sum_{\substack{c,d\ne0\\c+d\ne0}} h_{c,0} w_{d,0} \m s_{c+d}
  = \p{\f12\Delta + h_0} \sum_{d\ne 0} w_{d,0} \m s_d,
\end{align}
where we explicitly exclude terms that always vanish due to the fact
that $\m h,\m w$ are zero on the diagonal.  With some re-indexing, we
can write
\begin{align}
  \sum_{d\ne 0} h_{d,0} w_{d,0} \m s_d
  + \sum_{\substack{c,d\ne0}} h_{d-c,0} w_{c,0} \m s_d
  = \p{\f12\Delta + h_0} \sum_{d\ne 0} w_{d,0} \m s_d,
  \label{eq:cond_2_shift}
\end{align}
and define
\begin{align}
  \ul{\check{\m h}}
  \equiv \sum_{d\ne0} h_{d,0} \op{d}
  + \sum_{c,d\ne0} h_{d-c,0} \op{d}{c},
  &&
  \ul{\v{\m w}} \equiv \sum_{d\ne0} w_{d,0} \ket{d},
\end{align}
in order to express \eqref{eq:cond_2_shift} as the eigenvalue
equation
\begin{align}
  \ul{\check{\m h}} \c \ul{\v{\m w}}
  = \p{\f12\Delta + h_0} \ul{\v{\m w}}.
  \label{eq:cond_2_square}
\end{align}
We can reduce this eigenvalue problem even further by making use of a
reflection symmetry that comes from the fact that $h_{pq}=h_{qp}$ and
$w_{pq}=w_{qp}$, which implies $h_{d,0}=h_{-d,0}$ and
$w_{d,0}=w_{-d,0}$ (where all indices are taken modulo $N$, taking
$-d\to N-d$).  To this end, we define a complete basis of orthogonal
vectors that are symmetric under reflection, namely for all
$d\in\VV_N\equiv\set{1,2,\cdots,\floor{N/2}}$,
\begin{align}
  \ket{d_+} \equiv \f{\eta_d}{\sqrt{2}}\p{\ket{d} + \ket{-d}},
  &&
  \eta_d \equiv
  \begin{cases}
    1 & d \ne N/2, \\
    1/\sqrt{2} & d = N/2
  \end{cases},
\end{align}
where the special case of $d=N/2$ affects only even $N$, for which
$\ket{N/2}=\ket{-N/2}$.  We can use these vectors to define a
projector onto the reflection-symmetric subspace and expand
$\ul{\v{\m w}}$ as
\begin{align}
  \P_+ \equiv \sum_{d\in\VV_N} \op{d_+},
  &&
  \ul{\v{\m w}} = \sum_{d\in\VV_N} w_{d,0} \,
  \eta_d \sqrt{2} \ket{d_+}.
\end{align}
Finally, we project $\ul{\check{\m h}}$ onto the reflection-symmetric
subspace,
\begin{align}
  \P_+ \ul{\check{\m h}} \P_+
  &= \sum_{a,b\in\VV_N} \sum_{c,d\ne0}
  \p{h_{d,0} \delta_{cd} + h_{c-d,0}} \op{a_+} \op{d} \op{b_+} \\
  &= \sum_{a,b\in\VV_N} \op{a_+}{b_+} \f12 \eta_a\eta_b
  \sum_{c,d\ne0} \p{h_{d,0} \delta_{cd} + h_{c-d,0}}
  \p{\delta_{ac} + \delta_{-a,c}} \p{\delta_{bd} + \delta_{-b,d}} \\
  &= \sum_{a\in\VV_N} h_{a,0} \op{a_+}
  + \sum_{a,b\in\VV_N} \eta_a\eta_b
  \p{h_{a-b,0} + h_{a+b,0}} \op{a_+}{b_+},
\end{align}
which allows us to write down the reduced eigenvalue problem
\begin{align}
  \P_+ \ul{\check{\m h}} \P_+ \c \ul{\v{\m w}}
  = \p{\f12\Delta + h_0} \ul{\v{\m w}}.
\end{align}
Note that the factors of $\eta_a,\eta_b$ in
$\P_+ \ul{\check{\m h}} \P_+$ only matter when $N$ is even, in which
case these factors merely multiply the last row and last column of
$\P_+ \ul{\check{\m h}} \P_+$ by a factor of $1/\sqrt{2}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Collective and multi-local operators in the fully symmetric
  manifold}
\label{sec:multi_to_collective}

Here we provide a decomposition multi-local operators into sums of
collective operators (and vice versa) within the fully symmetric
manifold of $N$ spins.  Multi-local operators are operators of the
form
\begin{align}
  O_S \equiv \bigotimes_{O\in S} O,
  \label{eq:multi_op_set}
\end{align}
where $S\equiv\set{O}$ is a set of single-spin operators $O$.  The
order of tensor factors in \eqref{eq:multi_op_set} does not matter
after projecting operators onto the fully symmetric manifold, as we
always will in this section.  While the decomposition of a collective
operator into a sum of multi-local operators is unique, the opposite
is not true: there is generally no unique decomposition of a
multi-local operator into a sum of collective operators.  We can,
however, enforce a canonical decomposition by choosing a set of
collective operators that obey the same symmetries as $O_S$, namely
invariance under arbitrary permutations of the single-spin operators
$O\in S$.

Even though $S$ contains $\abs{S}$ spins, a collective operator built
from the single-spin operators $O\in S$ may have multiple
(single-spin) operators acting on the same spin, resulting in a
$k$-local operator with $k<\abs{S}$.  We therefore {\it
  partition}\footnote{A partition $P\equiv\set{p}$ of $S$ is a set of
  mutually disjoint, non-empty subsets $p\subset S$ with
  $\bigcup_{p\in P}p=S$.} $S$ into subsets of operators that act on
the same spin.  For any partition $P\equiv\set{p}$ of $S$ (here
$p\subset S$ is a subset of operators $O\in S$ that address the same
spin), we then define the $\abs{P}$-local operator
\begin{align}
  O_P \equiv \bigotimes_{p\in P} \bigodot_{O\in p} O,
\end{align}
where $\bigodot_{x\in\X} x$ denotes a symmetrized product of all
elements in $\X$, i.e.
\begin{align}
  \bigodot_{x\in\X} x
  \equiv \f1{\abs{\X}!}
  \sum_{\substack{\t{permutations}\\\sigma~\t{of}~\X}}
  ~ \prod_{k=1}^{\abs{\X}} x_{\sigma_k},
\end{align}
with $\sigma_k$ the $k$-th element of the permutation $\sigma$ when
expressed in one-line notation; for example,
\begin{align}
  \bigodot_{j=1}^2 x_j &= x_1 \odot x_2 = \f12 \p{x_1x_2 + x_2x_1}, \\
  \bigodot_{j=1}^3 x_j
  &= \f1{3!} \p{x_1x_2x_3 + x_1x_3x_2 + x_2x_1x_3
    + x_2x_3x_1 + x_3x_1x_2 + x_3x_2x_1}.
\end{align}
The set of multi-local operators $\set{O_P:\t{partitions}~P~\t{of}~S}$
consists of all operators that
\begin{enumerate*}
\item can be built from ordinary products and tensor products of all
  single-spin operators $O\in S$, and
\item are invariant under arbitrary permutations of $S$.
\end{enumerate*}
For any set $S$ of single-spin operators and any partition $P$ of $S$,
we can similarly define the collective operators
\begin{align}
  \O_S \equiv \bigodot_{O\in S} \col{O},
  &&
  \O_P \equiv \bigodot_{p\in P} \col{\textstyle\bigodot_{O\in p} O},
\end{align}
where we place a bar over a single-spin operator to denote its
collective version, i.e.~$\col{Q}\equiv\sum_j Q^{(j)}$, where
$Q^{(j)}$ is an operator that acts with the single-spin operator $Q$
on spin $j$ and trivially on all other spins.  By construction, the
set of collective operators $\set{\O_P:\t{partitions}~P~\t{of}~S}$ is
one-to-one to the set of multi-local operators
$\set{O_P:\t{partitions}~P~\t{of}~S}$, and it is straightforward to
work out that for any set $S$ of single-spin operators,
\begin{align}
  \O_S
  \EQFS \sum_{\substack{\t{partitions}\\P~\t{of}~S}}
  N!_{\abs{P}}\, O_P,
  &&
  N!_k \equiv \prod_{j=0}^{k-1}\p{N-j}! = \f{N!}{\p{N-k}!},
  \label{eq:collective_to_multi_full}
\end{align}
where $\EQFS$ denotes equality under a restriction to the fully
symmetric manifold.  For any multi-local operator $O_S$ indexed by a
set $S$ of single-spin operators, we can collect expansions of the
form \eqref{eq:collective_to_multi_full} for all collective operators
built from non-empty subsets of $S$ into a system of linear equations
$\L$, and in turn solve $\L$ for $O_S$.  When
$\abs{S}\in\set{1,2,3,4}$ (and, by conjecture, for all $S$), by use of
a computer algebra system (namely, Mathematica) we find that
\begin{align}
  N!_{\abs{S}}\, O_S
  &\EQFS \sum_{\substack{\t{partitions}\\P~\t{of}~S}}
  \p{-1}^{\abs{S}-\abs{P}} \O_P \times \prod_{p\in P}\p{\abs{p}-1}!
  \label{eq:multi_to_collective_full} \\
  &\EQFS \f1{\abs{S}!} \sum_{\substack{\t{permutations}\\\Pi~\t{of}~S}}
  \sum_{\substack{\t{ordered}\\\t{partitions}\\\tilde P~\t{of}~\Pi}}
  \p{-1}^{\abs{S}-\abs{\tilde P}} \O_{\tilde P}
  \times \prod_{\tilde p\in\tilde P} \p{\abs{\tilde p}-1}!
  \label{eq:multi_to_collective_full_simp}
\end{align}
where we identify permutations $\Pi$ of $S$ with an ordered list
(tuple) $\p{O_1,O_2,\cdots,O_{\abs{S}}}$ of all single-spin operators
in $S$; and we enforce that partitions $\tilde P$ of an ordered list
$\Pi$, as well as parts $\tilde p\in\tilde P$, are lexicographically
ordered in accordance with the ordering of operators in $\Pi$.  If
$S=\set{X,Y,Z}$, for example, then the ordered partitions of the
trivial permutation $\Pi=\p{X,Y,Z}$ are
\begin{align}
  \p{\p{X,Y,Z}}, &&
  \p{\p{X,Y},\p{Z}}, &&
  \p{\p{X,Z},\p{Y}}, &&
  \p{\p{X},\p{Y,Z}}, &&
  \p{\p{X},\p{Y},\p{Z}}.
\end{align}
For ordered lists $\tilde S$ and ordered partitions $\tilde P$, we
define
\begin{align}
  O_{\tilde S} \equiv \bigotimes_{O\in\tilde S} O,
  &&
  O_{\tilde P}
  \equiv \bigotimes_{\tilde p\in\tilde P} \prod_{O\in\tilde p} O,
  &&
  \O_{\tilde S} \equiv \prod_{O\in\tilde S} \col{O},
  &&
  \O_{\tilde P}
  \equiv \prod_{\tilde p\in\tilde P}
  \col{\textstyle\prod_{O\in\tilde p} O},
\end{align}
where products over elements of $\tilde S,\tilde P,\tilde p$ are taken
in order according to the elements of these ordered lists, e.g.~if
$\tilde S=\p{O_1,O_2,\cdots,O_{\abs{S}}}$, then
$\prod_{O\in\tilde S}\equiv O_1O_2\cdots O_{\abs{S}}$.  These
definitions allow us to expand
\begin{align}
  \O_{\tilde S} \EQFS
  \sum_{\substack{\t{ordered}\\\t{partitions}\\\tilde P~\t{of}~\tilde S}}
  N!_{\abs{\tilde P}} O_{\tilde P},
\end{align}
in analogy to \eqref{eq:collective_to_multi_full}.

While the expansions in \eqref{eq:multi_to_collective_full} and
\eqref{eq:multi_to_collective_full_simp} closely resemble each other,
in practice the latter involves less computational overhead due to the
lack of symmetrization in the construction of $\O_{\tilde P}$.  There
are, in principle, even more economical decompositions of a
multi-local operators into collective opreators, for example
\begin{align}
  N!_2\, X\otimes Y
  &\EQFS \col{X}\,\col{Y} - \col{XY}, \\
  N!_3\, X\otimes Y \otimes Z
  &\EQFS \col{X}\,\col{Y}\,\col{Z}
  - \col{X}\,\col{YZ} - \col{Y}\,\col{XZ} - \col{Z}\,\col{XY}
  + \col{ZXY} + \col{YXZ},
\end{align}
but these decompositions generally do not preserve the manifest
symmetry of a multi-local operator $O_S$ under arbitrary permutations
of $S$, and we do not know of any general prescription to arrive at
such decompositions aside from solving systems of equations relating
collective operators to multi-local operators.

On a final note, we consider the special case that all operators
$O\in S$ are identical, for which we provide the expansions
\begin{align}
  N!_2\, X\otimes X \EQFS {\col{X}\,}^2 - \col{X^2},
  &&
  N!_3\, X^{\otimes 3} \EQFS {\col{X}\,}^3
  - 3 \col{X} \odot \col{X^2} + 2\col{X^3},
\end{align}
\begin{align}
  N!_4\, X^{\otimes 4}
  \EQFS {\col{X}\,}^4 - 4 {\col{X}\,}^2 \odot \col{X^2}
  - 2 \col{X} \, {\col{X}\,}^2 \, \col{X}
  + 3 {\col{X^2}\,}^2 + 8 \col{X} \odot \col{X^3}
  - 6 \col{X^4}.
\end{align}
If furthermore $X^2=1$, as with e.g.~the Pauli operators of SU(2),
then
\begin{align}
  N!_2\, X\otimes X \EQFS {\col{X}\,}^2 - N,
  &&
  N!_3\, X^{\otimes 3} \EQFS {\col{X}\,}^3 - \p{3N-2} \col{X},
\end{align}
\begin{align}
  N!_4\, X^{\otimes 4} \EQFS {\col{X}\,}^4
  - 2\p{3N-4} {\col{X}\,}^2 + 3 N \p{N-2}.
\end{align}

\bibliography{multilevel_spin_notes.bib}

\end{document}
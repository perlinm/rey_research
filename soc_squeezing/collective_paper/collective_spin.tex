\documentclass[aps,pra,twocolumn,longbibliography]{revtex4-2}

% linking references
\usepackage{hyperref}
\hypersetup{
  breaklinks=true,
  colorlinks=true,
  linkcolor=blue,
  urlcolor=cyan,
}

%%% symbols, notations, etc.
\usepackage{physics,braket,bm,commath,amssymb}
\renewcommand{\t}{\text} % text in math mode
\newcommand{\f}[2]{\dfrac{#1}{#2}} % shorthand for fractions
\newcommand{\p}[1]{\left( #1 \right)} % parenthesis
\renewcommand{\sp}[1]{\left[ #1 \right]} % square parenthesis
\renewcommand{\v}{\bm} % bold vectors
\newcommand{\uv}[1]{\bm{\hat{#1}}} % unit vectors

\renewcommand{\abs}[1]{\lvert #1 \rvert}

\newcommand{\bk}{\braket} % shorthand for braket notation
\newcommand{\Bk}{\Braket}

\newcommand{\ul}{\underline} % shorthand for underline

\newcommand{\A}{\mathcal{A}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\E}{\mathcal{E}}
\newcommand{\J}{\mathcal{J}}
\renewcommand{\O}{\mathcal{O}}
\newcommand{\Q}{\mathcal{Q}}
\renewcommand{\S}{\mathcal{S}}
\newcommand{\U}{\mathcal{U}}

\newcommand{\C}{\mathbb{C}}
\newcommand{\N}{\mathbb{N}}

\newcommand{\z}{\text{z}}
\newcommand{\x}{\text{x}}
\newcommand{\y}{\text{y}}
\newcommand{\Z}{\text{Z}}
\newcommand{\X}{\text{X}}
\newcommand{\Y}{\text{Y}}
\newcommand{\bmu}{{\bar\mu}}
\newcommand{\bnu}{{\bar\nu}}

\usepackage{dsfont} % for identity operator
\newcommand{\1}{\mathds{1}}

\newcommand{\up}{\uparrow}
\newcommand{\dn}{\downarrow}

\renewcommand{\a}{\alpha} % free index
\renewcommand{\b}{\beta} % free index

%%% figures
\usepackage{graphicx} % for figures
\usepackage[caption=false]{subfig} % subfigures (via \subfloat[]{})
\newcommand{\sref}[1]{\protect\subref{#1}} % for referencing subfigures
\graphicspath{{./figures/}} % set path for all figures

\usepackage[inline]{enumitem} % for inline enumeration
\setenumerate{label=(\roman*)}


\begin{document}

\title{Short-time expansion of Heisenberg operators in open collective
  quantum spin systems}

\author{Michael A. Perlin}
\email{mika.perlin@gmail.com}
\author{Ana Maria Rey}
\affiliation{JILA, National Institute of Standards and Technology and
  University of Colorado, 440 UCB, Boulder, Colorado 80309, USA}
\affiliation{Center for Theory of Quantum Matter, 440 UCB, Boulder,
  Colorado 80309, USA}
\affiliation{Department of Physics, University of Colorado, 390 UCB,
  Boulder, Colorado 80309, USA}

\begin{abstract}
  We present a new method to compute short-time expectation values in
  large collective spin systems with generic Markovian decoherence.
  Our method is based on a Taylor expansion of a formal solution to
  the equations of motion for Heisenberg operators.  This expansion
  can be truncated at finite order to obtain virtually exact results
  at short times that are relevant for metrological applications such
  as spin squeezing.  In order to evaluate the expansion for
  Heisenberg operators, we compute the relevant structure constants of
  a collective spin operator algebra.  We demonstrate the utility of
  our method by computing spin squeezing, two-time correlation
  functions, and out-of-time-ordered correlators for $10^4$ spins in
  strong-decoherence regimes that are otherwise inaccessible via
  existing numerical methods.  Our method can be straightforwardly
  generalized to the case of a collective spin coupled to bosonic
  modes, relevant for trapped ion and cavity QED experiments, and may
  be used to investigate short-time signatures of quantum chaos and
  information scrambling.
\end{abstract}

\maketitle

\section{Introduction}

Collective spin systems are a versatile resource in quantum science
for a range of applications including quantum-enhanced metrology and
quantum simulation.  The study of such systems dates back to the
mid-twentieth century with the introduction of the Dicke
model\cite{dicke1954coherence} that describes atoms cooperatively
interacting with a single mode of a radiation field, and the
Lipkin-Meshkov-Glick (LMG) model, a toy model for testing many-body
approximation methods in contemporary nuclear
physics\cite{lipkin1965validity, meshkov1965validity,
  glick1965validity}.  On the experimental side, the development of
advanced trapping, cooling, and control techniques in atomic,
molecular, and optical (AMO) systems have enabled the realization of
collective spin models in a broad range of platforms, including atomic
ensembles\cite{takano2009spin, appel2009mesoscopic,
  schleier-smith2010states, chen2011conditional}, Bose-Einstein
condensates\cite{esteve2008squeezing, riedel2010atomchipbased,
  gross2010nonlinear, klinder2015dynamical}, ultracold Fermi
gasses\cite{martin2013quantum}, trapped ions\cite{bohnet2016quantum},
and optical cavities\cite{leroux2010implementation, bohnet2014reduced,
  cox2016deterministic, hosten2016measurement,
  norcia2018cavitymediated}, among others.  These implementations
compliment theoretical studies in a variety of rich subjects,
including quantum phase transitions and
criticality\cite{latorre2005entanglement, alcalde2007functional,
  wang2012quantum, majd2014lmg}, non-equilibrium
phenomena\cite{walls1978nonequilibrium, morrison2008dynamical,
  morrison2008dissipationdriven, morrison2008collective,
  kessler2012dissipative, bhattacherjee2014nonequilibrium,
  zhiqiang2017nonequilibrium, lang2018concurrence}, and precision
mentrology\cite{wineland1992spin, kitagawa1993squeezed,
  zhong2010simplified, schleier-smith2010squeezing, ma2011quantum,
  huang2015twoaxis, muessel2015twistandturn, huang2015quantum,
  mirkhalaf2018robustifying, lewis-swan2018robust, he2019engineering}.

One of the primary motivations for studying collective spin systems is
their application to quantum-enhanced metrology.  Quantum projection
noise limits the error $\Delta\phi$ in the measurement of a phase
angle $\phi$ with $N$ independent spins to
$\Delta\phi\sim1/\sqrt{N}$\cite{wineland1992spin, itano1993quantum}.
Collective spin systems provide a means to break through this limit
via the preparation of many-body entangled states such as spin-cat
states\cite{agarwal1997atomic, lau2014proposal, huang2015quantum} and
most notably spin-squeezed states\cite{wineland1992spin,
  kitagawa1993squeezed, ma2011quantum} that allow for measurement
errors $\Delta\phi\sim1/N^\varepsilon$ with $1/2<\varepsilon\le1$,
where $\varepsilon=1$ saturates the Heisenberg
limit\cite{zwierz2010general}.  Such entangled states can be prepared
either via heralded methods such as quantum nondemolition
measurements\cite{takano2009spin, appel2009mesoscopic,
  schleier-smith2010states, chen2011conditional}, or via deterministic
methods that require nonlinear dynamics, typically realized with
phonon-mediated\cite{bohnet2016quantum},
photon-mediated\cite{leroux2010implementation, bohnet2014reduced,
  cox2016deterministic, hosten2016measurement,
  norcia2018cavitymediated} or collisional\cite{esteve2008squeezing,
  riedel2010atomchipbased, gross2010nonlinear, bromley2018dynamics}
interactions.  Although a truly collective spin model requires
uniform, all-to-all interactions, as long as measurements do not
distinguish between constituent particles, even non-uniform systems
may be effectively described by a uniform model with renormalized
parameters\cite{hu2015entangled}.

In the absence of decoherence, permutation symmetry and total spin
conservation divide the total Hilbert space of a collective spin
system into superselection sectors that grow only linearly with system
size $N$, thereby admitting efficient classical simulation of its
dynamics.  Decoherence generally violates total spin conservation and
requires the use of density operators, increasing the dimension of
accessible state space to $O\p{N^3}$\cite{hartmann2016generalized,
  xu2013simulating}.  In this case, exact simulations can be carried
out for $N\lesssim100$ particles.  If decoherence is sufficiently
weak, dynamics can be numerically solvable for $N\lesssim10^5$
particles via ``quantum trajectory'' Monte Carlo
methods\cite{plenio1998quantumjump, zhang2018montecarlo} (also known
as ``quantum jump'' or ``Monte Carlo wavefunction'' methods) that can
reproduce all expectation values of interest.  When decoherence is
strong, however, these Monte Carlo methods can take a prohibitively
long time to converge, as simulations become dominated by incoherent
jumps that generate large numbers of distinct quantum trajectories
that need to be averaged in order to accurately compute expectation
values.  Even with strong decoherence, dynamics are sometimes solvable
through the cumulant expansion\cite{meiser2010steadystate} that
neglects all $n$-body connected correlators for $n>2$.  The growth of
genuinely multi-body correlations, however, eventually causes the
cumulant expansion to yield unphysical results with no clear signature
of failure.  In the absence of other means to compute correlators, it
can therefore be difficult to identify the point at which correlators
computed via the cumulant expansion can no longer be trusted.

In this work, we present a new method to compute short-time dynamics
of collective spin systems with generic Markovian decoherence.  The
only restriction on decoherence (beyond Markovianity) is that, like
the coherent collective dynamics, it must act identically on all
constituent particles.  Our method is based on a short-time expansion
of exact solutions to the equations of motion for Heisenberg
operators.  Evaluating this expansion requires knowing the structure
constants of a collective spin operator algebra; the calculation of
these structure constants (in Appendices
\ref{sec:identities}--\ref{sec:general_product}) is one of the main
technical results of this work, which we hope will empower both
analytical and numerical studies of collective spin systems in the
future.  We benchmark our method against both exact and quantum
trajectory Monte Carlo computations of spin squeezing in accessible
parameter regimes, highlighting both advantages and limitations of our
short-time expansion.  Finally, we showcase applications of our method
by computing quantities that are inaccessible to other numerical
methods.


\section{Theory}
\label{sec:theory}

In this section we provide the basic theory for our method to compute
expectation values of collective spin operators, deferring lengthy
derivations to the appendices.  We consider a system of $N$ distinct
spin-1/2 particles.  Defining individual spin-1/2 operators
$\hat s_{\a=\x,\y,\z}\equiv\hat\sigma_\a/2$ and
$\hat s_\pm\equiv\hat s_\x\pm i\hat s_\y=\hat\sigma_\pm$ with Pauli
operators $\hat\sigma_\a$, we denote an operator that acts with
$\hat s_\a$ on the spin indexed by $j$ and trivially (i.e.~with the
identity $\hat\1$) on all other spins by $\hat s_\a^{(j)}$.  We then
define the collective spin operators
$\hat S_\a\equiv\sum_{j=1}^N\hat s_\a^{(j)}$ for
$\a\in\set{\x,\y,\z,+,-}$.  Identifying the set $\set{\hat\S_{\v m}}$
as a basis for all collective spin operators, with
$\v m\equiv\p{m_+,m_\z,m_-}\in\N_0^3$ and
$\hat\S_{\v m}\equiv \hat S_+^{m_+} \hat S_\z^{m_\z} \hat S_-^{m_-}$,
we can expand any collective spin operator $\hat\O$ in the form
\begin{align}
  \hat\O = \sum_{\v m} \O_{\v m} \hat\S_{\v m}
\end{align}
with scalar coefficients $\O_{\v m}\in\C$.  If $\hat\O$ is
self-adjoint, for example, then $\O_{\v m}^*=\O_{\v m^*}$ with
$\v m^*\equiv\p{m_-,m_\z,m_+}$.
%
% The corresponding Heisenberg operator is then
% $\hat\O\p{t}=\sum_{\v m}\O_{\v m}\p{t}\hat\S_{\v m}$, with
% time-dependent coefficients $\O_{\v n}\p{t}$ for time-independent
% (Schr\"odinger) operators $\hat\S_{\v m}$.  The time evolution of
% Heisenberg operators is determined by
%
The corresponding Heisenberg operator is then
$\hat\O\p{t}=\sum_{\v m}\O_{\v m}\p{t}\hat\S_{\v m}+\hat\E_\O\p{t}$,
with time-dependent coefficients $\O_{\v n}\p{t}$ for time-independent
(Schr\"odinger) operators $\hat\S_{\v m}$, and mean-zero ``noise''
operators $\hat\E_\O\p{t}$ that result from interactions between the
spin system and its environment, initially $\hat\E_\O\p{0}=0$.  These
noise operators will essentially play no role in the present work, but
are necessary to include for a consistent formalism of Heisenberg
operators in an open quantum system; see Appendix \ref{sec:noise} for
further discussion.  The expectation values of Heisenberg operators
evolve according to
%
\begin{align}
  \f{d}{dt} \bk{\hat\O\p{t}}
  = \bk{\check T \hat\O\p{t}}
  = \sum_{\v m, \v n} \bk{\hat\S_{\v m}} T_{\v m\v n} \O_{\v n}\p{t}
  \label{eq:EOM}
\end{align}
with a Heisenberg-picture time derivative operator $\check T=d/dt$
whose matrix elements $T_{\v m\v n}\in\C$ are defined by
\begin{align}
  \check T \hat\S_{\v n} \equiv i \sp{\hat H, \hat\S_{\v n}}_-
  + \sum_\J \gamma_\J \check\D\p{\J} \hat\S_{\v n}
  = \sum_{\v m} \hat\S_{\v m} T_{\v m\v n},
  \label{eq:time_deriv}
\end{align}
where $\sp{X,Y}_\pm\equiv XY\pm YX$; $\hat H$ is the collective spin
Hamiltonian; $\J$ is a set of jump operators with a corresponding
decoherence rate $\gamma_\J$; and $\check\D$ is a Heisenberg-picture
dissipator, or Lindblad superoperator, defined by
\begin{align}
  \check\D\p{\J} \hat \O
  \equiv \sum_{\hat J\in\J} \p{\hat J^\dag \hat \O \hat J
    - \f12\sp{\hat J^\dag \hat J, \hat \O}_+}.
\end{align}
Decoherence via uncorrelated decay of individual spins, for example,
would be described by the set of jump operators
$\J_-\equiv\set{\hat s_-^{(j)}:j=1,2,\cdots,N}$.  The commutator in
Eq.~\eqref{eq:time_deriv} can be computed by expanding the product
$\hat\S_{\v\ell}\hat\S_{\v m} = \sum_{\v n} f_{\v\ell\v m\v
  n}\hat\S_{\v n}$ with structure constants
$f_{\v\ell\v m\v n}\in\mathbb{R}$ that we work out in Appendices
\ref{sec:identities}--\ref{sec:general_product}, and the effects of
decoherence from jump operators (i.e.~elements of $\J$) of the form
$\hat g^{(j)} = \sum_\a g_\a \hat s_\a^{(j)}$ and
$\hat G = \sum_\a G_\a \hat S_\a$ are worked out in Appendices
\ref{sec:sandwich_single}--\ref{sec:decoherence_collective}.  We
consider these calculations to be some of the main technical
contributions of this work, with potential applications beyond the
short-time simulation method presented here.  These ingredients are
sufficient to compute matrix elements $T_{\v m\v n}$ of the time
derivative operator $\check T$ in Eq.~\eqref{eq:time_deriv} in most
cases of practical interest.

The time derivative operator $\check T$ will generally couple spin
operators $\hat\S_{\v n}$ to spin operators $\hat\S_{\v m}$ with
higher ``weight'', i.e.~with $\abs{\v m}>\abs{\v n}$, where
$\abs{\v\ell}\equiv\sum_\a\ell_\a$.  The growth of operator weight
signifies the growth of many-body correlations.  Keeping track of this
growth eventually becomes intractable, requiring us to truncate our
equations of motion somehow.  The simplest truncation strategy would
be to take
\begin{align}
  \f{d}{dt} \bk{\hat\O\p{t}}
  \to \sum_{w\p{\v m}<W} \bk{\hat\S_{\v m}}
  \sum_{\v n} T_{\v m\v n} \O_{\v n}\p{t}
  \label{eq:weight_truncation}
\end{align}
for some weight measure $w$, e.g.~$w\p{\v m}=\abs{\v m}$, and a
high-weight cutoff $W$.  The truncation in
Eq.~\eqref{eq:weight_truncation} closes the system of differential
equations defined by Eq.~\eqref{eq:EOM}, and allows us to solve it
using standard numerical methods.  Some initial conditions for this
system of differential equations, namely expectation values of
collective spin operators with respect to spin-polarized (Gaussian)
states that are generally simple to prepare experimentally, are
provided in Appendix \ref{sec:initial_conditions}.

The truncation strategy in Eq.~\eqref{eq:weight_truncation} has a few
limitations:
\begin{enumerate*}
\item simulating a system of differential equations for a large number
  of operators can be time-consuming,
\item the weight measure $w$ may need to be chosen carefully, as the
  optimal measure is generally system-dependent, and
\item simulation results can only be trusted up to the time at which
  the initial value of operators $\hat\S_{\v m}$ with weight
  $w\p{\v m}\ge W$ have a non-negligible contribution to expectation
  values of interest.\label{pt:limitation}
\end{enumerate*}
The last limitation in particular unavoidably applies in some form to
any method tracking only a subset of all relevant operators.  We
therefore devise an alternate truncation strategy built around
limitation \ref*{pt:limitation}.

We can formally expand Heisenberg operators $\hat\O\p{t}$ in a Taylor
series about the time $t=0$ to write
\begin{align}
  \bk{\hat\O\p{t}}
  = \bk{e^{t\check T} \hat \O\p{0}}
  = \sum_{k\ge0} \f{t^k}{k!}
  \sum_{\v m, \v n} \bk{\hat\S_{\v m}} T^k_{\v m\v n} \O_{\v n}\p{0},
  \label{eq:time_series}
\end{align}
where the matrix elements $T^k_{\v m\v n}$ of the $k$-th time
derivative operator $\check T^k$ are
\begin{align}
  T^0_{\v m\v n} &\equiv \delta_{\v m\v n}, \\
  T^1_{\v m\v n} &\equiv T_{\v m\v n}, \\
  T^{k>1}_{\v m\v n}
  &\equiv \sum_{\v p_1,\v p_2,\cdots,\v p_{k-1}}
  T_{\v m\v p_{k-1}} \cdots T_{\v p_3\v p_2}
  T_{\v p_2\v p_1} T_{\v p_1\v n},
\end{align}
with $\delta_{\v m\v n}=1$ if $\v m=\v n$ and 0 otherwise.  For
sufficiently short times, we can truncate the series in
Eq.~\eqref{eq:time_series} by taking
\begin{align}
  \bk{\hat\O\p{t}}
  \to \sum_{k=0}^M \f{t^k}{k!}
  \sum_{\v m, \v n} \bk{\hat\S_{\v m}} T^k_{\v m\v n} \O_{\v n}\p{0}.
  \label{eq:TST}
\end{align}
%
% We refer Eq.~\eqref{eq:TST} as the truncated short-time (TST)
% expansion of Heisenberg operators.  Unlike the truncation in
% Eq.~\eqref{eq:weight_truncation}, the nonzero matrix elements
% $T^k_{\v m\v n}$ for $k=0,1,\cdots,M$ in Eq.~\eqref{eq:TST} tell us
% which operators are relevant for computing the expectation value
% $\bk{\hat\O\p{t}}$ to a fixed order $M$.  Note that using the
% relation $\hat\S_{\v m}^\dag=\hat\S_{\v m^*}$, which by Hermitian
% conjugation of Eq.~\eqref{eq:EOM} also implies that
% $T_{\v m^*\v n^*}=T_{\v m\v n}^*$, can cut both the number of
% initial-time expectation values $\bk{\hat\S_{\v m}}_{t=0}$ and the
% number of matrix elements $T_{\v m\v n}$ that we may need to
% explicitly compute roughly in half.
%
We refer Eq.~\eqref{eq:TST} as the truncated short-time (TST)
expansion of Heisenberg operators.  Note that when computing an
expectation value $\bk{\hat\O\p{t}}$, the relation
$\hat\S_{\v m}^\dag=\hat\S_{\v m^*}$, which by Hermitian conjugation
of Eq.~\eqref{eq:EOM} also implies that
$T_{\v m^*\v n^*}=T_{\v m\v n}^*$, cuts both the number of
initial-time expectation values $\bk{\hat\S_{\v m}}$ and the number of
matrix elements $T_{\v m\v n}$ that we may need to explicitly compute
roughly in half.

Unlike the weight-based truncation in
Eq.~\eqref{eq:weight_truncation}, the nonzero matrix elements
$T^k_{\v m\v n}$ for $k=0,1,\cdots,M$ in Eq.~\eqref{eq:TST} tell us
which operators $\hat\S_{\v m}$ are relevant for computing the
expectation value $\bk{\hat\O\p{t}}$ to a fixed order $M$.  The TST
expansion thereby avoids the introduction of a weight measure $w$ that
chooses which operators to keep track of, and trades the cost of
solving a system of differential equations for the cost of computing
expectation values $\bk{\hat\S_{\v m}}$ and matrix elements
$T_{\v m\v n}^k$.  In all cases considered in this work, we find that
the TST expansion is both faster to evaluate and provides accurate
correlators $\bk{\hat\O\p{t}}$ until later times $t$ than the
weight-based expansion in \eqref{eq:weight_truncation} with weight
measure $w\p{\v m}=\abs{\v m}$ and cutoff $W\approx M$.  We therefore
restrict the remainder of our discussions to the TST expansion in
Eq.~\eqref{eq:TST}, and provide a pedagogical tutorial for computing
correlators using the TST expansion in Appendix \ref{sec:tutorial}.
%

%
% In principle, the factorial suppression of terms at higher orders of
% the expansion in Eq.~\eqref{eq:time_series} implies for any given
% time $t$, there exists a truncation order $M_t$ for which the
% truncation error in Eq.~\eqref{eq:TST} is negligibly small.  In
% practice, only a maximal truncation order $M_{\t{max}}$ is
% accessible with limited computational resources, such that the TST
% expansion in Eq.~\eqref{eq:TST} only allows us to compute the
% expectation value $\bk{\hat\O\p{t}}$ to a maximal time
% $t_{M_{\t{max}}}$.  As we will see in the following section,
% $M_{\t{max}}=35$ will suffice for the computation of collective spin
% correlators up to times that are relevant e.g.~for spin squeezing
% protocols.  Appendix \ref{sec:tutorial} provides a pedagogical
% tutorial for computing correlators using the TST expansion.
%
Three primary considerations limit the maximum time $t$ to which we
can accurately compute a correlator $\bk{\hat S_{\v n}\p{t}}$ using
the TST expansion.  First, maintaining accuracy at larger times $t$
requires going to higher orders $M$ in the TST expansion.  An
order-$M$ TST expansion of the correlator $\bk{\hat S_{\v n}\p{t}}$
can involve a significant fraction of operators $\hat S_{\v m}$ with
weight $\abs{\v m}\lesssim M$, which implies the need to compute
$O\p{M^3}$ initial-time expectation values $\bk{\hat S_{\v m}}$ and
$O\p{M^4}$ matrix elements $T^k_{\v m\v n}$.  In practice, with a
straightforward implementation of the TST expansion we find that these
requirements generally restrict $M\lesssim 50$ -- $70$ with $8$ --
$50$ gigabytes of random access memory (RAM).  Second, individual
terms at high orders of the TST expansion in Eq.~\eqref{eq:TST} can
grow excessively large, greatly amplifying any numerical errors and
thereby spoiling cancellations that are necessary to arrive at a
physical value of a correlator, i.e.~with
$\abs{\bk{\hat S_{\v n}\p{t}}}\lesssim S^{\abs{\v n}}$.  Finally, the
TST expansion is essentially perturbative in the time $t$, which
implies that the validity of this a formal expansion eventually breaks
down.  Precisely characterizing the implications of these last two
considerations for the TST expansion requires additional analysis that
we defer to future work.  As we show from benchmarks of the TST
expansion in Section \ref{sec:squeezing}, however, a detailed
understanding of these limitations is not necessary to diagnose the
breakdown time $t_{\t{break}}^{(M)}$ beyond which the TST expansion
yields inaccurate results.  Empirically, we find that going beyond
order $M\approx35$ yields no significant gains in all cases considered
in this work.
%


\section{Spin squeezing, benchmarking, and breakdown}
\label{sec:squeezing}

To benchmark our method for computing collective spin correlators, we
consider three collective spin models known to generate spin-squeezed
states: the one-axis twisting (OAT), two-axis twisting (TAT), and
twist-and-turn (TNT) models described by the collective spin
Hamiltonians\cite{ma2011quantum}
\begin{align}
  H_{\t{OAT}} &= \chi \hat S_\z^2, \label{eq:OAT} \\
  H_{\t{TAT}}
  &= \f{\chi}{3} \p{\hat S_\z^2 - \hat S_\y^2}, \label{eq:TAT} \\
  H_{\t{TNT}} &= \chi \hat S_\z^2 + \Omega \hat S_\x, \label{eq:TNT}
\end{align}
where we include a factor of $1/3$ in the TAT Hamiltonian because it
naturally appears in realistic proposals to experimentally implement
TAT\cite{liu2011spin, huang2015twoaxis}.  For simplicity, we further
fix $\Omega=\chi S$ (with $S\equiv N/2$ throughout this work) to the
critical value known to maximize the entanglement generation rate of
TNT in the large-$N$ limit\cite{micheli2003manyparticle,
  sorelli2019fast}.

Note that the OAT model is a special case of the zero-field Ising
model, whose quantum dynamics admits an exact analytic solution even
in the presence of decoherence\cite{foss-feig2013nonequilibrium}.  We
will benchmark our calculations using these analytical OAT results
wherever applicable (see Appendix \ref{sec:OAT}, as well as the
Supplementary Material of Ref.~[\citenum{bohnet2016quantum}]).

The Hamiltonians in Eqs.~\eqref{eq:OAT}--\eqref{eq:TNT} squeeze the
initial product state $\ket{\X}\propto\p{\ket\up+\ket\dn}^{\otimes N}$
with $\hat S_\x\ket{\X}=S\ket{\X}$.  Our measure of spin squeezing is
the directionally-unbiased Ramsey squeezing parameter determined by
the maximal gain in resolution $\Delta\phi$ of a phase angle $\phi$
over that achieved by any spin-polarized product state
(e.g.~$\ket{\X}$)\cite{wineland1992spin, ma2011quantum},
\begin{align}
  \xi^2
  \equiv \f{\p{\Delta\phi_{\t{min}}}^2}{\p{\Delta\phi_{\t{polarized}}}^2}
  = \f{N}{\abs{\braket{\uv S}}^2}
  \min_{\substack{\v v\perp\bk{\uv S}\\\v v\cdot\v v=1}}
  \Bk{\p{\uv S\cdot\v v}^2},
  \label{eq:squeezing}
\end{align}
where $\uv S\equiv\p{\hat S_\x,\hat S_\y,\hat S_\z}$ is a collective
spin operator-valued vector, the minimization is performed over all
unit vectors $\v v$ orthogonal to the mean spin vector $\bk{\uv S}$,
and for brevity we have suppressed the explicit time dependence of
operators in Eq.~\eqref{eq:squeezing}.  This squeezing parameter is
entirely determined by one- and two-spin correlators of the form
$\bk{\hat S_\a}$ and $\bk{\hat S_\a \hat S_\b}$.  For the unitary
dynamics discussed in this work, these correlators are obtainable via
exact simulations of quantum dynamics in the $\p{N+1}$-dimensional
Dicke manifold of states $\set{\ket{S,m}}$ with net spin $S$ and spin
projection $m$ onto the $z$ axis, i.e.~with
$\bk{S,m|\uv S^2|S,m}=S\p{S+1}$ and $\bk{S,m|\hat S_\z|S,m}=m$ for
$m\in\set{-S,-S+1,\cdots,S}$.  In the presence of single-spin or
collective decoherence, meanwhile, these correlators are obtainable
with the collective-spin quantum trajectory Monte Carlo method
developed in ref.~\cite{zhang2018montecarlo}.  In this work, these
exact and quantum trajectory simulations will be used to benchmark the
TST expansion in Eq.~\eqref{eq:TST}.

\begin{figure}
  \centering
  \subfloat[Squeezing with unitary dynamics
  \label{fig:squeezing_unitary}]
  {\includegraphics{unitary.pdf}} \\
  \subfloat[Squeezing with decoherence:
  $\gamma_-=\gamma_+=\gamma_\z=\chi$
  \label{fig:squeezing_incoherent}]
  {\includegraphics{decoherence_weak.pdf}}
  \caption{Spin squeezing of $N=10^4$ spins initially in $\ket\X$
    under \sref{fig:squeezing_unitary} unitary and
    \sref{fig:squeezing_incoherent} non-unitary dynamics, computed
    using exact methods (solid lines), quantum trajectory simulations
    (dots), and the TST expansion in Eq.~\eqref{eq:TST} with $M=35$
    (dashed lines).  Solid circles mark the times at which the TST
    expansion gives an unphysical result with $\xi^2<0$.}
  \label{fig:benchmarking}
\end{figure}

Figure \ref{fig:benchmarking} compares the squeezing parameter $\xi^2$
for $N=10^4$ spins initially in the state $\ket{\X}$ evolved under the
Hamiltonians in Eqs.~\eqref{eq:OAT}--\eqref{eq:TNT}, as computed via
both benchmarking simulations and the TST expansion in
Eq.~\eqref{eq:TST} with $M=35$.  Squeezing is shown for both unitary
dynamics (Figure \ref{fig:squeezing_unitary}), as well as non-unitary
dynamics in the presence of spontaneous decay, excitation, and
dephasing of individual spins at rates $\chi$ (Figure
\ref{fig:squeezing_incoherent}), respectively described by the sets of
jump operators $\J_\a\equiv\set{\hat s_\a^{(j)}}$ with corresponding
decoherence rates $\gamma_\a=\chi$ for $\a\in\set{-,+,\z}$.  The
results shown in Figure \ref{fig:benchmarking} were computed in a
rotated basis with
$\p{\hat s_\z,\hat s_\x}\to\p{\hat s_\x,-\hat s_\z}$ and
$\ket\X\to\ket{-\Z}\equiv\ket\dn^{\otimes N}$, as well as appropriate
transformations of the Hamiltonian and jump operators.
%
% The only effect of this rotation on the results presented in Figure
% \ref{fig:benchmarking} is to prolong the time for which the TST
% expansion agrees with the benchmarking simulations.  The reason for
% different results in rotated basis has to do with the breakdown of
% the TST expansion, which we discuss further below.
%
The only effects of this rotation on the results presented in Figure
\ref{fig:benchmarking} are to
\begin{enumerate*}
\item reduce the time it takes to compute correlators
  $\bk{\hat\O\p{t}}$ with the TST expansion, and
\item prolong the time for which the TST expansion of TNT results
  agree with benchmarking simulations.
\end{enumerate*}
The speedup in a different basis occurs because for the initial state
$\ket{-\Z}$, all initial-time correlators $\bk{\hat S_{\v m}}$ are
zero unless $m_+=m_-=0$, and all non-zero correlators take $O\p{1}$
(i.e.~constant in $N$) time to compute, rather than $O\p{N}$ time (see
Appendix \ref{sec:initial_conditions}).  In total, the use of a
rotated basis reduces the computation time of initial-time correlators
from $O\p{M^3N}$ to $O\p{M}$.  The reason for prolonged agreement of
TNT results in a rotated basis is not entirely understood, and
provides a clue into the precise mechanism by which the TST expansion
breaks down (discussed below).  We defer a detailed study of this
breakdown to future work.
%

The main lesson from Figure \ref{fig:benchmarking} is that the TST
expansion yields essentially exact results right up until a sudden and
drastic departure that can be diagnosed by inspection.  The breakdown
of the TST expansion in Figure \ref{fig:benchmarking} is marked by an
unphysical squeezing parameter $\xi^2<0$, which occurs due to
individual correlators taking unphysical values with
$\abs{\bk{\hat\S_{\v n}\p{t}}}\gtrsim S^{\abs{\v n}}$.
%
% The sudden and drastic departure from virtually exact results occurs
% because the TST expansion neglects high-weight
% (i.e.~large-$\abs{\v m}$) operators $\hat\S_{\v m}$ whose
% contributions to a Heisenberg operator $\hat\O\p{t}$ of interest
% eventually become non-negligible.  For sufficiently large times $t$,
% these individual contributions can become comparable in magnitude to
% the expectation value $\bk{\hat\O\p{t}}$, and will grow with some
% large power of $t$, so their truncation will have a drastic effect
% on the estimated value of $\bk{\hat\O\p{t}}$.  This breakdown
% mechanism is also the reason for prolonged agreement between the TST
% expansion and benchmarking methods when squeezing the initial state
% $\ket{-\Z}$ rather than $\ket{\X}$: for initial states $\ket{-\Z}$,
% all initial-time correlators $\bk{\hat\S_{\v m}}$ vanish unless
% $m_+=m_-=0$ (see Appendix \ref{sec:initial_conditions}), so there is
% a substantially smaller number of neglected terms with non-zero
% contribution to the correlator $\bk{\hat\O\p{t}}$.
%
Going up through order $M=70$ in the TST expansion does not
significantly increase the breakdown time $t_{\t{break}}^{(M)}$, and
in some cases even shortens $t_{\t{break}}^{(M)}$.  The sudden and
drastic departure from virtually exact results is consistent with the
limitations of the TST expansion discussed at the end of Section
\ref{sec:theory}.  Specifically, we identify three possible mechanisms
for breakdown:
\begin{enumerate*}
\item a rapid growth in the order $M$ necessary for the TST expansion
  to converge,
\item the growth of numerical errors in excessively large terms of the
  TST expansion, and
\item the formal breakdown of the perturbative expansion in the time
  $t$.
\end{enumerate*}
In all of these cases, a detailed cancellation eventually ceases to
occur between large terms at high orders in the TST expansion.  These
large terms grow with the time $t$ raised to some large power (as high
as $M$), and therefore rapidly yield wildly unphysical results.  In
contrast to other approximate methods such as the cumulant
expansion\cite{meiser2010steadystate}, the TST expansion can thus
diagnose its own breakdown, which is an important feature when working
in parameter regimes that are inaccessible via other means to compute
correlators.
%

%
% Although the TST expansion breaks down at short times, it has two
% key advantages over other methods to compute collective spin
% correlators.  First, computing spin correlators with the TST
% expansion is generally much faster and requires much fewer computing
% resources than the alternatives.  The quantum trajectory Monte Carlo
% simulations performed for Figure \ref{fig:squeezing_incoherent}, for
% example, take $\sim10^4$ CPU hours to compute on standard modern
% computing hardware; the bulk of this time is spent performing sparse
% matrix-vector multiplication, leaving little room to further
% optimize serial runtime.  Parallelization can reduce the actual
% runtime of these quantum trajectory simulations to $\sim10$ hours by
% running all trajectories at once, but at the cost of greatly
% increasing computing resource requirements.  The TST expansion
% results in Figure \ref{fig:squeezing_incoherent}, meanwhile, take
% $\sim10$ seconds to compute with a single CPU on similar hardware.
%
Although the TST expansion breaks down at short times, it has two key
advantages over the quantum trajectory Monte Carlo method to compute
correlators in the presence of decoherence.  First, computing spin
correlators with the TST expansion is generally faster and requires
fewer computing resources.  The TST expansion results in Figure
\ref{fig:squeezing_incoherent}, for example, take $\sim10$ seconds to
compute with a single CPU on modern computing hardware.  The quantum
trajectory Monte Carlo results in the same figure, meanwhile, take
$\sim10^4$ CPU hours to compute on similar hardware; the bulk of this
time is spent performing sparse matrix-vector multiplication, leaving
little room to further optimize serial runtime.  Parallelization can
reduce actual runtime of the Monte Carlo simulations to $\sim10$ hours
by running all trajectories at once, but at the cost of greatly
increasing computing resource requirements.  Though it may be possible
to further speed up quantum trajectory Monte Carlo simulations by
introducing new truncation schemes, any modifications
\begin{enumerate*}
\item should be made carefully to ensure that simulations still yield
  correct results, and
\item are unlikely to bridge the orders of magnitude in computing
  resource requirements.
\end{enumerate*}
%

\begin{figure}
  \centering
  \includegraphics{decoherence_strong.pdf}
  \caption{Spin squeezing of $N=10^4$ spins initially in $\ket\X$ with
    spontaneous decay, excitation, and dephasing of individual spins
    at rates $\gamma_-=\gamma_+=\gamma_\z=100\chi$.  Computed using
    the TST expansion in Eq.~\eqref{eq:TST} with $M=35$.  Solid
    circles mark the times at which the TST expansion gives an
    unphysical result with $\xi^2<0$.}
  \label{fig:decoherence_strong}
\end{figure}

The second advantage of the TST expansion is the capability to compute
spin correlators in strong-decoherence regimes of large systems that
are entirely inaccessible to other methods.  As an example, Figure
\ref{fig:decoherence_strong} shows squeezing of $N=10^4$ spins
initially in $\ket{\X}$, undergoing spontaneous decay, excitation, and
dephasing of individual spins at rates
$\gamma_-=\gamma_+=\gamma_\z=100\chi$.
%
% These results show that
%
The system size in these simulations is too large for straightforward
application of exact methods for open quantum systems.  Quantum
trajectory Monte Carlo simulations, meanwhile, take a prohibitively
long time to converge with such strong decoherence due to the
multiplicity of quantum trajectories that require averaging.

The results in Figure \ref{fig:decoherence_strong} show that
%
TNT is much more robust to single-spin decoherence than OAT or TAT, a
finding that could not necessarily be deduced from the
weak-decoherence simulations presented in Figure
\ref{fig:benchmarking}.  Strong-decoherence computations of this sort
were used to put lower bounds on theoretically achievable spin
squeezing via TAT with decoherence in
Ref.~[\citenum{he2019engineering}], exemplifying a concrete and
practical application of the TST expansion and the collective-spin
structure constants calculated in this work.


\section{Two-time correlation functions and out-of-time-ordered
  correlators}
\label{sec:multi_time}

As a final example of collective-spin physics that is numerically
accessible via the TST expansion of Heisenberg operators, we consider
the calculation of two-time correlation functions and
out-of-time-ordered correlators (OTOCs).  In particular, we consider
the effect of decoherence on short-time behavior of the two-time
connected correlator
\begin{align}
  C\p{t}
  \equiv \f1S\p{\bk{\hat S_+\p{t} \hat S_-\p{0}}
    - \bk{\hat S_+\p{t}}\bk{\hat S_-\p{0}}},
  \label{eq:two_time}
\end{align}
and the expectation value of a squared commutator,
\begin{align}
  D\p{t}
  \equiv \f1{S^2} \Bk{\sp{\hat S_+\p{t},\hat S_-\p{0}}_-^\dag
    \sp{\hat S_+\p{t},\hat S_-\p{0}}_-}_{\t{nn}},
  \label{eq:four_point}
\end{align}
in the context of the squeezing models in Section \ref{sec:squeezing}.
%
The subscript on $\bk{\cdot}_{\t{nn}}$ in Eq.~\eqref{eq:four_point}
stands for ``no noise'', and denotes a correlator computed without the
noise contributions $\hat\E_\O\p{t}$ to Heisenberg operators
$\hat\O\p{t}$.  While linear contributions from noise operators as
e.g.~in Eq.~\eqref{eq:two_time} always vanish under Markovian
decoherence (see Appendix \ref{sec:noise}), quadratic contributions
that would otherwise appear in Eq.~\eqref{eq:four_point} generally do
not\cite{blocher2019quantum}.  Determining the effect of these noise
terms generally requires making additional assumptions about the
environment, which would be a digression for the purposes of the
present work.  We therefore exclude these noise terms in
\eqref{eq:four_point} in order to keep our discussion simple and
general; see Ref.~[\citenum{blocher2019quantum}] for more detailed
discussions of noise terms and the quantum regression theorem
underlying the calculation of multi-time correlators.
%

In an equilibrium setting, correlation functions similar to that in
Eq.~\eqref{eq:two_time} contain information about the linear response
of Heisenberg operators to perturbations of a system; in a
non-equilibrium setting, they contribute to short-time linear response
(see Appendix \ref{sec:linear_response}).  Similar correlators have
made appearances as order parameters for diagnosing time-crystalline
phases of matter\cite{tucker2018shattered}.  Squared commutators such
as that in Eq.~\eqref{eq:four_point}, meanwhile, are commonly examined
for signatures of quantum chaos and information
scrambling\cite{maldacena2016bound, swingle2018unscrambling,
  garcia-mata2018chaos}.  In typical scenarios, such squared
commutators initially vanish by construction through to a choice of
spatially separated operators.  Collective spin systems, however, have
no intrinsic notion of locality or spatial separation.  In our case,
therefore, with the choice of initial state
$\ket\X\propto\p{\ket\up+\ket\dn}^{\otimes N}$ we merely have
$D\p{0}\sim1/N$.

\begin{figure*}
  \centering
  \begin{minipage}{0.49\linewidth}
    \subfloat[Two-time correlator
    $C\p{t}\equiv\abs{C\p{t}}\exp\sp{i\phi\p{t}}$.
    \label{fig:two_time}]
    {\includegraphics{two_time.pdf}}
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \subfloat[Squared commutator $D\p{t}$.
    \label{fig:four_point}]
    {\includegraphics{FPC.pdf}}
  \end{minipage}
  \caption{The two-time connected correlator $C\p{t}$ and squared
    commutator $D\p{t}$, respectively defined in
    Eqs.~\eqref{eq:two_time} and \eqref{eq:four_point}, for $N=10^4$
    spins initially in the polarized state
    $\ket{\X}\propto\p{\ket\up+\ket\dn}^{\otimes N}$ evolving under
    the squeezing Hamiltonians in Eqs.~\eqref{eq:OAT}--\eqref{eq:TNT}.
    Results are shown for both unitary dynamics (solid lines) and
    non-unitary dynamics with $\gamma_-=\gamma_+=\gamma_\z=100\chi$
    (dashed lines), computed using the TST expansion in
    Eq.~\eqref{eq:TST} with $M=20$.}
  \label{fig:multi_time}
\end{figure*}

Figure \ref{fig:multi_time} shows the behavior of $C\p{t}$ and
$D\p{t}$ for $N=10^4$ spins, initially in the state $\ket\X$, evolving
under the squeezing Hamiltonians in
Eqs.~\eqref{eq:OAT}--\eqref{eq:TNT} both with and without spontaneous
decay, excitation, and dephasing of individual spins at rates
$\gamma_-=\gamma_+=\gamma_\z=100\chi$.  In the case of unitary
evolution under OAT, we find that to an excellent approximation
$\abs{C\p{t}}$ takes the functional form
$f\p{t}=f\p{0}+aN\chi t+\p{bN\chi t}^2$ with $a\sim b\sim 1$, and with
a virtually perfect fit $D\p{t}=D\p{0}+\p{\sp{N+1}\chi t}^2$.  For
unitary evolution under TAT and TNT, we find that to an excellent
approximation both $\abs{C\p{t}}$ and $D\p{t}$ take the functional
form $f\p{t}=f\p{0}+a\sp{\exp\p{bN\chi t}-1}$ with $a\sim b\sim 1$.
As may be expected, the growth of $C\p{t}$ and $D\p{t}$ is generally
suppressed by decoherence.  Figure \ref{fig:multi_time} serves as an
example for the type of behavior that is accessible at short times
with the TST expansion.  These examples are straightforward extend to
equilibrium settings and spin-boson systems.


\section{Conclusions}

We have presented a new method for computing correlators at short
times in collective spin systems.  This method is based on truncating
a short-time expansion of Heisenberg operators, and can access
correlators on time scales that are relevant to metrological
applications such as spin squeezing.  In order to evaluate the
truncated short-time (TST) expansion of Heisenberg operators, we have
computed the structure constants of a collective spin operator
algebra, which we hope will empower future analytical and numerical
studies of collective spin systems.  Even though we considered only
non-equilibrium spin-squeezing processes in this work, our method can
be applied directly in an equilibrium setting, and is straightforward
to generalize to systems such as trapped ions and optical cavities
with collective spin-boson interactions.  In such contexts, our method
may be used to benchmark the short-time effects of decoherence, or
study the onset of quantum chaos and information scrambling.


\begin{acknowledgments}
  We acknowledge helpful discussions with Robert Lewis-Swan, Kris
  Tucker, and Colin Kennedy; as well as some technical contributions
  from Diego Barberena.  This work is supported by the Air Force
  Office of Scientific Research (AFOSR) grant FA9550-18-1-0319; the
  AFOSR Multidisciplinary University Research Initiative (MURI) grant;
  the Defense Advanced Research Projects Agency (DARPA) and Army
  Research Office (ARO) grant W911NF-16-1-0576 and W911NF-19-1-0210;
  the National Science Foundation (NSF) grant PHY-1820885; JILA-NSF
  grant PFC-173400; and the National Institute of Standards and
  Technology (NIST).
\end{acknowledgments}

\vfill
\onecolumngrid
\appendix

\input{calculations_main.tex}

\input{tutorial.tex}

\input{calculations_OAT.tex}

\input{noise_operators.tex}

\input{linear_response.tex}

% \input{changing_bases.tex}

\bibliography{\jobname}

\end{document}

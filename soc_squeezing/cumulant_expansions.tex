\documentclass[aps,notitlepage,nofootinbib,11pt]{revtex4-1}

% linking references
\usepackage{hyperref}
\hypersetup{
  breaklinks=true,
  colorlinks=true,
  linkcolor=blue,
  filecolor=magenta,
  urlcolor=cyan,
}

%%% symbols, notations, etc.
\usepackage{physics,braket,bm,commath,amssymb}
\renewcommand{\t}{\text} % text in math mode
\newcommand{\f}[2]{\dfrac{#1}{#2}} % shorthand for fractions
\newcommand{\p}[1]{\left(#1\right)} % parenthesis
\renewcommand{\sp}[1]{\left[#1\right]} % square parenthesis
\renewcommand{\set}[1]{\left\{#1\right\}} % curly parenthesis
\renewcommand{\v}{\bm} % bold vectors
\newcommand{\uv}[1]{\v{\hat{#1}}} % unit vectors
\renewcommand{\c}{\cdot} % inner product
\newcommand{\bk}{\Braket} % shorthand for braket notation
\renewcommand{\d}{\text{d}} % "d" for integration measure

\newcommand{\C}{\mathcal{C}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\I}{\mathcal{I}}
\newcommand{\J}{\mathcal{J}}
\renewcommand{\O}{\mathcal{O}}
\renewcommand{\S}{\mathcal{S}}

\newcommand{\N}{\mathbb{N}}

\newcommand{\z}{\text{z}}
\newcommand{\x}{\text{x}}
\newcommand{\y}{\text{y}}
\newcommand{\Z}{\text{Z}}
\newcommand{\X}{\text{X}}
\newcommand{\Y}{\text{Y}}
\newcommand{\bmu}{{\bar\mu}}
\newcommand{\bnu}{{\bar\nu}}
\newcommand{\floor}[1]{\left\lfloor{#1}\right\rfloor}

\usepackage{dsfont} % for identity operator
\newcommand{\1}{\mathds{1}}

\usepackage[inline]{enumitem} % for inline enumeration

%%% figures
\usepackage{graphicx} % for figures
\usepackage{grffile} % help latex properly identify figure extensions
\usepackage[caption=false]{subfig} % subfigures (via \subfloat[]{})
\graphicspath{{./figures/}} % set path for all figures

% for strikeout text
% normalem included to prevent underlining titles in the bibliography
\usepackage[normalem]{ulem}

% for leaving notes in the text
\newcommand{\note}[1]{\textcolor{red}{#1}}


\begin{document}

\title{Short-time simulation of collective spin Hamiltonians with
  arbitrary decoherence}

\author{Michael A. Perlin}

\maketitle

\tableofcontents

\newpage

\section{Introduction}

Previous work has shown how to realize spin-squeezing Hamiltonians
with a variety of ultracold atomic and trapped ion systems.  While
simulating the dynamics of initially Gaussian states evolving under
these Hamiltonians is straightforward in the context of a closed
quantum system, here we develop a method to simulate short-time
dynamics in the presence of decoherence.  In particular, we will
consider dynamics induced by the one-axis twisting (OAT), two-axis
twisting (TAT), and transverse field (TVF) Hamiltonians of the form
\begin{align}
  H_{\t{OAT}} = \chi S_\z^2,
  &&
  H_{\t{TAT}}^{\z,\y} = \chi \p{S_\z^2 - S_\y^2},
  &&
  H_{\t{TVF}} = \chi S_\z^2 + \Omega S_\x.
\end{align}
In order to determine the squeezing behavior of these Hamiltonians, we
will study the dynamics of Heisenburg operators $\O$, whose evolution
under a Hamiltonian $H$ is given by
\begin{align}
  \f{d}{dt} \O = i\sp{H,\O}_- + \sum_\J \gamma_\J \D\p{\J;\O},
  &&
  \D\p{\J;\O}
  \equiv \sum_{J\in\J}\p{J^\dag \O J - \f12\sp{J^\dag J,\O}_+},
  \label{eq:EOM}
\end{align}
where $\J$ is a set of jump operators with a corresponding decoherence
rate $\gamma_\J$ and $\sp{X,Y}_\pm\equiv XY\pm YX$.  Our measure of
spin squeezing is
\begin{align}
  \xi^2 \equiv \f{N}{\abs{\bk{\v S}}^2}
  \min_{\uv n\perp\bk{\v S}} \bk{\p{\v S\c\uv n}^2},
  \label{eq:squeezing}
\end{align}
where $N$ is the total number of spins, $\v S$ is the collective spin
vector, and the minimization is performed over all unit vectors
$\uv n$ in the plane orthogonal to the mean spin vector $\bk{\v S}$.
This squeezing parameter is entirely determined by one- and two-spin
correlators of the form $\bk{S_\alpha}$ and $\bk{S_\alpha S_\beta}$;
our task is therefore to compute these expectation values in all
scenarios of interest.


\section{One-axis twisting}

The simplest case is that of one-axis twisting, as we can write the
Hamiltonian in the form
\begin{align}
  H_{\t{OAT}} = \f14 \chi \sum_{j,k} \sigma_\z^{(j)} \sigma_\z^{(k)}
  = \f12 \chi \sum_{j<k} \sigma_\z^{(j)} \sigma_\z^{(k)} + \f14 N \chi,
\end{align}
which admits an exact solution previously worked out by Foss-Feig et
al.~in ref.~\cite{foss-feig2013nonequilibrium}.  Adapting exact
expectation values with respect to the initial state $\ket{\X}$
satisfying $S_\x\ket{\X}=S\ket{\X}$, in terms of $S\equiv N/2$ and
$\mu,\nu\in\set{+1,-1}$ we find that
\begin{align}
  \bk{S_+}
  &= \sum_j\bk{\sigma_+^{(j)}}
  = S e^{-\Gamma t} \Phi\p{\chi,t}^{N-1}, \label{eq:S+_OAT} \\
  \bk{S_\mu S_\z}
  &= \f12\sum_j\bk{\sigma_\mu^{(j)}\sigma_\z^{(j)}}
  + \f12\sum_{j\ne k} \bk{\sigma_\mu^{(j)} \sigma_\z^{(k)}} \\
  &= -\f{\mu}{2}\bk{S_\mu} + S \p{S-\f12} e^{-\Gamma t}
  \Psi\p{\mu\chi,t} \Phi\p{\chi,t}^{N-2}, \\
  \bk{S_\mu S_\nu}
  &= \sum_j \bk{\sigma_\mu^{(j)} \sigma_\nu^{(j)}}
  + \sum_{j\ne k} \bk{\sigma_\mu^{(j)} \sigma_\nu^{(k)}} \\
  &= \delta_{\mu,-\nu} \p{S + \mu\bk{S_\z}}
  + S \p{S-\f12} e^{-2\Gamma t}
  \Phi\p{\sp{\mu+\nu}\chi,t}^{N-2}, \label{eq:SS+-_OAT}
\end{align}
where
\begin{align}
  \Phi\p{X,t}
  &\equiv e^{-\lambda t} \sp{\cos\p{t\sqrt{s_X^2-r}}
    + \lambda t~\t{sinc}\p{t\sqrt{s_X^2-r}}},
  \\
  \Psi\p{X,t}
  &\equiv e^{-\lambda t} \p{is_X-\gamma}t~
  \t{sinc}\p{t\sqrt{s_X^2-r}},
\end{align}
for
\begin{align}
  \gamma \equiv \f12 \p{\gamma_+ - \gamma_-},
  &&
  \lambda \equiv \f12 \p{\gamma_+ + \gamma_-},
  &&
  r \equiv \gamma_+ \gamma_-,
  &&
  \Gamma \equiv \f12\gamma_\z + \lambda,
  &&
  s_X \equiv X + i\gamma,
\end{align}
defined respectively in terms of uncorrelated spin dephasing,
excitation, and decay rates $\gamma_\z$, $\gamma_+$, $\gamma_-$.  The
last ingredients we need to compute spin squeezing at any time are
$\bk{S_\z}$ and $\bk{S_\z^2}$.  As these operators commute with the
OAT Hamiltonian, their evolution is governed entirely by decoherence
(see Appendix \ref{sec:decay_single}), which means
\begin{align}
  \f{d}{dt} S_\z
  &= S\p{\gamma_+-\gamma_-} - \p{\gamma_++\gamma_-} S_\z,
  \\
  \f{d}{dt}\p{S_\z^2}
  &= S\p{\gamma_++\gamma_-} + 2\p{\gamma_+-\gamma_-}\p{S-\f12} S_\z
  - 2 \p{\gamma_++\gamma_-} S_\z^2.
\end{align}
The initial conditions $\bk{S_\z}_{t=0}=0$ and $\bk{S_\z^2}_{t=0}=S/2$
then imply
\begin{align}
  \bk{S_\z}
  = S\p{\f{\gamma_+-\gamma_-}{\gamma_++\gamma_-}}
  \p{1-e^{-\p{\gamma_+ + \gamma_-} t}},
  &&
  \bk{S_\z^2} = S \sp{\f12 + \p{S-\f12} \f{\bk{S_\z}^2}{S^2}}.
  \label{eq:Sz_OAT}
\end{align}
The expectation values in \eqref{eq:S+_OAT}-\eqref{eq:SS+-_OAT} and
\eqref{eq:Sz_OAT} are sufficient to compute the squeezing parameter
$\xi^2$ defined in \eqref{eq:squeezing} at any time throughout
evolution of the initial state $\ket{\X}$ under $H_{\t{OAT}}$.


\section{Short-time evolution via truncated equations of motion}

Unlike the one-axis twisting Hamiltonian, the two-axis twisting and
transverse-field Hamiltonians do not admit exact analytical solutions.
We will therefore simulate dynamics under these Hamiltonians
numerically using alternate methods.  The basic strategy will be to
first find equations of motion for all operators of interest using
some complete basis for collective-spin operators.  These equations of
motion will generally yield a system of equations involving a number
of operators that grows too fast with system size for exact
simulation.  We will therefore look for ways to truncate the equations
of motion to arrive at a reasonably-sized expressions that are
practical to compute.  To benchmark this method, we test it against
collective Hamiltonian dynamics in the absence of decoherence, exact
one-axis twisting results in the presence of decoherence, and exact
simulations of small systems.

Ultimately, we are interested in the dynamics of collective spin
operators.  Choosing a basis $\set{\S_{\v m}}$ for these operators,
e.g.~$\S_{\v m}\equiv S_+^{m_+} S_\z^{m_\z} S_-^{m_-}$ with
$\v m\equiv\p{m_+,m_\z,m_-}\in\mathbb{N}_0^3$, we can expand all
collective-spin Hamiltonians in the form
\begin{align}
  H = \sum_{\v m} h_{\v m} \S_{\v m},
  \label{eq:H_general}
\end{align}
where if $\S_{\v m}=S_+^{m_+} S_\z^{m_\z} S_-^{m_-}$ then Hermiticity
requires that $h_{m_+,m_\z,m_-}=h_{m_-,m_\z,m_+}^*$.  The one-axis
twisting Hamiltonian with a transverse field, for example, is
\begin{align}
  H_{\t{TVF}}
  = \chi S_\z^2 + \Omega S_\x
  = \chi S_\z^2 + \f{\Omega}{2} S_+ + \f{\Omega}{2} S_-,
\end{align}
while the two-axis twisting Hamiltonians about $\p{z,y}$ and $\p{y,x}$
are
\begin{align}
  H_{\t{TAT}}^{\z,\y}
  \propto S_\z^2 - S_\y^2
  = S_\z^2 + \f14 S_+^2 + \f14 S_-^2
  - \f12 S_+ S_- + \f12 S_\z,
\end{align}
and
\begin{align}
  H_{\t{TAT}}^{\y,\x}
  \propto S_\y^2 - S_\x^2
  = -\f12 S_+^2 - \f12 S_-^2.
\end{align}
The evolution of a general operator $\S_{\v m}$ under a Hamiltonian of
the form in \eqref{eq:H_general} is given by
\begin{align}
  \f{d}{dt} \S_{\v m}
  = i \sum_{\v n} h_{\v n}
  \sp{\S_{\v n}, \S_{\v m}}_-
  + \sum_\J \gamma_\J \D\p{\J; \S_{\v m}}
  \equiv \sum_{\v n} T_{\v m\v n} \S_{\v n},
  \label{eq:time_derivative}
\end{align}
where commutator and decoherence terms necessary for computing the
matrix elements $T_{\v m\v n}$ of the time derivative operator $d/dt$
are worked out Appendices \ref{sec:prod_general},
\ref{sec:decoherence_single}, and \ref{sec:decoherence_collective}.

The time derivative operator $d/dt$ will generally couple spin
operators $\S_{\v m}$ to spin operators $\S_{\v n}$ with higher
``weight'', i.e.~with $\abs{\v n}>\abs{\v m}$ where
$\abs{\v\ell}\equiv\sum_\lambda\ell_\lambda$.  The growth of operator
weight signifies the growth of many-body correlations.  In practice,
keeping track of this growth will eventually require more
computational resources than are available, so we truncate it by
taking
\begin{align}
  \f{d}{dt} \S_{\v m}
  = \sum_{\v n} T_{\v m\v n} \S_{\v n}
  \to \sum_{w\p{\v n}<W} T_{\v m\v n} \S_{\v n}
  \label{eq:time_derivative_truncation}
\end{align}
for some weight measure $w$, e.g.~$w\p{\v n}=\abs{\v n}$, and cutoff
$W$.  The truncation in \eqref{eq:time_derivative_truncation} will
close the system of differential equations defined by
\eqref{eq:time_derivative}, and allow us to solve it using standard
numerical methods.  The initial conditions for this system of
differential equations, i.e.~expectation values of operators with
respect to states that are simple to prepare, are provided in Appendix
\ref{sec:initial_conditions}.

The truncation strategy in \eqref{eq:time_derivative_truncation} has a
few limitations:
\begin{enumerate*}[label=(\roman*)]
\item simulating a system of differential equations for a large number
  of operators can be very time-consuming,
\item the weight measure $w$ may need to be chosen carefully, as the
  optimal measure is generally system-dependent,
\item simulation results can only be trusted up to the time at which
  the initial value of operators $\S_{\v m}$ with weight
  $w\p{\v m}\ge W$ have a non-negligible contribution to operators of
  interest.\label{pt:limitation}
\end{enumerate*}
The last limitation in particular {\it necessarily} applies in some
form to any method tracking only a subset of all relevant operators.
Embracing the unavoidable, we therefore try to devise an alternate
truncation strategy built around \ref{pt:limitation}.

We can expand Heisenberg operators in a Taylor series about $t=0$ to
write
\begin{align}
  \bk{\S_{\v m}}
  = \sum_{k\ge0} \f{t^k}{k!} \bk{\f{d^k}{dt^k} \S_{\v m}}_{t=0}
  = \sum_{k\ge0} \f{t^k}{k!}
  \sum_{\v n} T_{\v m\v n;k} \bk{\S_{\v n}}_{t=0},
  \label{eq:time_series}
\end{align}
where the matrix elements of the $k$-th time derivative are given by
\begin{align}
  T_{\v m\v n;0} \equiv \delta_{\v m\v n},
  &&
  T_{\v m\v n;1} \equiv T_{\v m\v n},
  &&
  T_{\v m\v n;k>1}
  \equiv \sum_{\v p_1,\v p_2,\cdots\v p_{k-1}}
  T_{\v m\v p_1} T_{\v p_1\v p_2} T_{\v p_2\v p_3}
  \cdots T_{\v p_{k-1}\v n}.
\end{align}
Instead of explicitly choosing a weight function that determines which
operators to keep track of, we can now truncate the series in
\eqref{eq:time_series} by taking
\begin{align}
  \bk{\S_{\v m}}
  = \sum_{k\ge0} \f{t^k}{k!}
  \sum_{\v n} T_{\v m\v n;k} \bk{\S_{\v n}}_{t=0}
  \to \sum_{k=0}^M \f{t^k}{k!}
  \sum_{\v n} T_{\v m\v n;k} \bk{\S_{\v n}}_{t=0}.
\end{align}
The nonzero entries of $T_{\v m\v n;k}$ for $k=0,1,\cdots,M$ now tell
us which operators we need to keep track of in order to compute the
expectation value $\bk{\S_{\v m}}$.  Furthermore, after computing all
relevant matrix elements $T_{\v m\v n;k}$ and expectation values
$\bk{\S_{\v n}}_{t=0}$, computing $\bk{\S_{\v m}}$ takes only a short
time independent of system size.  Finally, the relation
$\S_{\v m}^\dag=\S_{\v m^*}$ for $\v m^*\equiv\p{m_-,m_\z,m_+}$ can be
exploited to cut both the number of matrix elements $T_{\v m\v n}$ and
expectation values $\bk{\S_{\v m}}_{t=0}$ that we need to compute
explicitly roughly in half.


\bibliography{\jobname}

\newpage
\appendix

\section{Basic spin operator identities}
\label{sec:identities}

The appendices in this text make ubiquitous use of various spin
operator identities; we collect and derive some basic identities here
for reference.  Defining the individual spin-1/2 operators
\begin{align}
  s_{n=\x,\y,\z} \equiv \f12 \sigma_n,
  &&
  s_\pm \equiv s_\x \pm i s_\y,
  \label{eq:single_spin}
\end{align}
in terms of Pauli operators $\sigma_n$, we denote the operator which
acts with $s_n$ on a spin indexed by $j$ and trivially (i.e.~with the
identity $\1$) on all other spins by $s_n^{(j)}$.  We then define the
collective spin operators
\begin{align}
  S_n \equiv \sum_j s_n^{(j)}.
  \label{eq:collective_spin}
\end{align}
Despite our working definition in \eqref{eq:collective_spin}, the
identities we will derive for collective spin operators alone apply
just as well to large-spin operators that cannot be expressed as the
sum of individual spin-1/2 operators.

The elementary commutation relations between spin
operators are, with $\bmu\equiv-\mu\in\set{+1,-1}$ for brevity,
\begin{align}
  \sp{s_\z^{(j)},s_\mu^{(k)}}_-
  &= \delta_{jk} \mu s_\mu^{(j)},
  &
  \sp{S_\z,s_\mu^{(j)}}_-
  &= \sp{s_\z^{(j)},S_\mu}_- = \mu s_\mu^{(j)},
  &
  \sp{S_\z,S_\mu}_-
  &= \mu S_\mu,
  \label{eq:comm_z_base} \\
  \sp{s_\mu^{(j)},s_\bmu^{(k)}}_-
  &= \delta_{jk} 2 \mu s_\z^{(j)},
  &
  \sp{S_\mu,s_\bmu^{(j)}}_-
  &= \sp{s_\mu^{(j)},S_\bmu}_- = 2 \mu s_\z^{(j)},
  &
  \sp{S_\mu,S_\bmu}_-
  &= 2 \mu S_\z.
  \label{eq:comm_mu_base}
\end{align}
These relations can be used to inductively compute identities
involving powers of collective spin operators.  By pushing through one
spin operator at a time, we can find
\begin{align}
  \p{\mu S_\z}^m s_\mu^{(j)}
  = \p{\mu S_\z}^{m-1} s_\mu^{(j)} \p{1 + \mu S_\z}
  = \p{\mu S_\z}^{m-2} s_\mu^{(j)} \p{1 + \mu S_\z}^2
  = \cdots
  = s_\mu^{(j)} \p{1 + \mu S_\z}^m,
  \label{eq:push_z_mu_Ss}
\end{align}
and
\begin{align}
  \mu s_\z^{(j)} S_\mu^m
  = S_\mu \mu s_\z^{(j)} S_\mu^{m-1} + s_\mu^{(j)} S_\mu^{m-1}
  = \cdots
  = ms_\mu^{(j)} S_\mu^{m-1} + S_\mu^m \mu s_\z^{(j)},
  \label{eq:push_z_mu_sS}
\end{align}
where we will generally find it nicer to express results in terms of
$\mu s_\z^{(j)}$ and $\mu S_\z$ rather than $s_\z^{(j)}$ and $S_\z$.
Summing over the single-spin index $j$ in both of these cases gives us
the purely collective-spin versions of these identities:
\begin{align}
  \p{\mu S_\z}^m S_\mu = S_\mu \p{1 + \mu S_\z}^m,
  &&
  \mu S_\z S_\mu^m = S_\mu^m \p{m + \mu S_\z},
  \label{eq:push_z_mu_single}
\end{align}
where we can repeat the process of pushing through individual $S_\z$
operators $\ell$ times to get
\begin{align}
  \p{\mu S_\z}^\ell S_\mu^m
  = \p{\mu S_\z}^{\ell-1} S_\mu^m \p{m + \mu S_\z}
  = \p{\mu S_\z}^{\ell-2} S_\mu^m \p{m + \mu S_\z}^2
  = \cdots
  = S_\mu^m \p{m + \mu S_\z}^\ell.
  \label{eq:push_z_mu}
\end{align}
Multiplying \eqref{eq:push_z_mu} through by $\p{\mu\nu}^\ell$ (for
$\nu\in\set{+1,-1}$) and taking its Hermitian conjugate, we can say
that more generally
\begin{align}
  \p{\nu S_z}^\ell S_\mu^m
  = S_\mu^m \p{\mu\nu m+\nu S_\z}^\ell,
  &&
  S_\mu^m \p{\nu S_z}^\ell
  = \p{-\mu\nu m+\nu S_\z}^\ell S_\mu^m.
\end{align}
Finding commutation relations between powers of transverse spin
operators, i.e.~$S_\mu$ and $S_\bmu$, turns out to be considerably
more difficult than the cases we have worked out thus far.  We
therefore save this work for Appendix \ref{sec:comm_transverse}.


\section{Commutation relations between powers of transverse spin
  operators}
\label{sec:comm_transverse}

To find commutation relations between powers of transverse collective
spin operators, we first compute
\begin{align}
  S_\mu^m s_\bmu^{(j)}
  &= S_\mu^{m-1}s_\bmu^{(j)} S_\mu
  + S_\mu^{m-1} 2\mu s_\z^{(j)} \\
  &= S_\mu^{m-2} s_\bmu^{(j)} S_\mu^2
  + S_\mu^{m-2} 2\mu s_\z^{(j)} S_\mu
  + S_\mu^{m-1} 2\mu s_\z^{(j)} \\
  &= s_\bmu^{(j)} S_\mu^m
  + \sum_{k=0}^{m-1} S_\mu^k 2\mu s_\z^{(j)} S_\mu^{m-k-1}
  \label{eq:push_mu_Ss_start}.
\end{align}
While \eqref{eq:push_mu_Ss_start} gives us the commutator
$\sp{S_\mu^m,s_\bmu^{(j)}}_-$, we would like to enforce an ordering on
products of spin operators, which will ensure that we only keep track
of operators that are linearly independent.  We choose (for now) to
impose an ordering with all $s_\bmu^{(j)}$ operators on the left, and
all $s_\z^{(j)}$ operators on the right, as such an ordering will
prove convenient for the calculations in this section.  This choice of
ordering compels us to expand
\begin{align}
  \sum_{k=0}^{m-1} S_\mu^k 2\mu s_\z^{(j)} S_\mu^{m-k-1}
  &= \sum_{k=0}^{m-1} S_\mu^k
  \sp{2\p{m-k-1} s_\mu^{(j)} S_\mu^{m-k-2}
    + S_\mu^{m-k-1} 2\mu s_\z^{(j)}} \\
  &= m \p{m-1} s_\mu^{(j)} S_\mu^{m-2}
  + m S_\mu^{m-1} 2\mu s_\z^{(j)},
\end{align}
which implies
\begin{align}
  S_\mu^m s_\bmu^{(j)}
  = s_\bmu^{(j)} S_\mu^m + m \p{m-1} s_\mu^{(j)} S_\mu^{m-2}
  + m S_\mu^{m-1} 2\mu s_\z^{(j)},
  \label{eq:push_mu_Ss}
\end{align}
and in turn
\begin{align}
  S_\mu^m S_\bmu = S_\bmu S_\mu^m
  + m S_\mu^{m-1} \p{m - 1 + 2\mu S_\z}.
  \label{eq:push_mu_single}
\end{align}
As the next logical step, we take on the task of computing
\begin{align}
  S_\mu^m S_\bmu^n
  &= S_\mu^{m-1} S_\bmu^n S_\mu
  + n \sp{S_\mu^{m-1} S_\bmu^{n-1} \p{1 - n + 2\mu S_\z}} \\
  &= S_\bmu^n S_\mu^m
  + n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_\z} S_\mu^k,
\end{align}
which implies
\begin{align}
  \sp{S_\mu^m, S_\bmu^n}_-
  = C_{mn;\mu}
  \equiv n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_\z} S_\mu^k.
\end{align}
We now need rearrange the operators in $C_{mn;\mu}$ into a standard
order, which means pushing all $S_\z$ operators to the right and, for
the purposes of this calculation, all $S_\bmu$ operators to the left.
We begin by pushing $S_\mu^k$ to the left of $S_\z$, which takes
$2\mu S_\z\to 2\mu S_\z+2k$, and then push $S_\mu^{m-k-1}$ to the
right of $S_\bmu^{n-1}$, giving us
\begin{align}
  C_{mn;\mu}
  &= n \sum_{k=0}^{m-1}
  \p{S_\bmu^{n-1} S_\mu^{m-k-1} + C_{m-k-1,n-1;\mu}} S_\mu^k
  \p{2k + 1 - n + 2\mu S_\z} \\
  &= D_{mn;\mu}
  + n \sum_{k=0}^{m-2} C_{m-k-1,n-1;\mu}
  S_\mu^k \p{2k + 1 - n + 2\mu S_\z},
  \label{eq:C_mn}
\end{align}
where we have dropped the last ($k=m-1$) term in the remaining sum
because $C_{m-k-1,n-1;\mu}=0$ if $k=m-1$, and
\begin{align}
  D_{mn;\mu}
  \equiv mn S_\bmu^{n-1} S_\mu^{m-1} \p{m - n + 2\mu S_\z}.
  \label{eq:D_mn}
\end{align}
To our despair, we have arrived in \eqref{eq:C_mn} at a {\it
  recursive} formula for $C_{mn;\mu}$.  Furthermore, we have not even
managed to order all spin operators, as $C_{m-k-1,n-1;\mu}$ contains
$S_\z$ operators which are to the left of $S_\mu^k$.  To sort all spin
operators once and for all, we define
\begin{align}
  C_{mn;\mu}^{(k)} \equiv C_{m-k,n;\mu} S_\mu^k,
  &&
  D_{mn;\mu}^{(k)} \equiv D_{m-k,n;\mu} S_\mu^k,
\end{align}
which we can expand as
\begin{align}
  D_{mn;\mu}^{(k)}
  &\equiv D_{m-k,n;\mu}S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-k-1}
  \p{m-k-n+2\mu S_\z} S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-1} \p{k+m-n+2\mu S_\z},
  \label{eq:D_mn_k}
\end{align}
and
\begin{align}
  C_{mn;\mu}^{(k)}
  &= D_{m-k,n;\mu} S_\mu^k + n \sum_{j=0}^{m-k-2}
  C_{m-k-j-1,n-1;\mu} S_\mu^j \p{2j+1-n+2\mu S_\z} S_\mu^k \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{m-k-j-1,n-1;\mu} S_\mu^{j+k} \p{2j+2k+1-n+2\mu S_\z} \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{m-1,n-1;\mu}^{(k+j)} \p{2\sp{j+k}+1-n+2\mu S_\z} \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=k}^{m-2}
  C_{m-1,n-1;\mu}^{(j)} \p{2j+1-n+2\mu S_\z}.
  \label{eq:C_mn_k}
\end{align}
While the resulting expression in \eqref{eq:C_mn_k} strongly resembles
that in \eqref{eq:C_mn}, there is one crucial difference: all spin
operators in \eqref{eq:C_mn_k} have been sorted into a standard order.
We can now repeatedly substitute $C_{mn;\mu}^{(k)}$ into itself, each
time decreasing $m$ and $n$ by 1, until one of $m$ or $n$ reaches
zero.  Such repeated substitution yields the expansion
\begin{align}
  C_{mn;\mu}
  = C_{mn;\mu}^{(0)}
  = D_{mn;\mu}
  + \sum_{p=1}^{\min\set{m,n}-1} E_{mn;\mu}^{(p)},
  \label{eq:C_mn_E}
\end{align}
where the first two terms in the sum over $p$ are
\begin{align}
  E_{mn;\mu}^{(1)}
  &= n \sum_{k=0}^{m-2} D_{m-1,n-1;\mu}^{(k)} \p{2k+1-n+2\mu S_\z}, \\
  E_{mn;\mu}^{(2)}
  &= n \sum_{k_1=0}^{m-2} \p{n-1} \sum_{k_2=k_1}^{m-3}
  D_{m-2,n-2;\mu}^{(k_2)} \p{2k_2+2-n+2\mu S_\z} \p{2k_1+1-n+2\mu S_\z},
\end{align}
and more generally for $p>1$,
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{k_1=0}^{m-2} \sum_{k_2=k_1}^{m-3} \cdots\sum_{k_p=k_{p-1}}^{m-p-1}
  D_{m-p,n-p;\mu}^{(k_p)} \prod_{j=1}^p \p{2k_j+j-n+2\mu S_\z}.
  \label{eq:E_mn_p}
\end{align}
In principle, the expressions in \eqref{eq:D_mn_k} and
\eqref{eq:C_mn_E}-\eqref{eq:E_mn_p} can be used to evaluate the
commutator $\sp{S_\mu^m,S_\bmu^n}_- = C_{mn;\mu}$, but these result
are -- to put it lightly -- quite a mess: the expression for
$E_{mn;\mu}^{(p)}$ in \eqref{eq:E_mn_p} involves a sum over $p$
mutually dependent intermediate variables, each term of which
additionally contains a product of $p$ factors.  We therefore devote
the rest of this section to simplifying our result for the commutator
$\sp{S_\mu^m,S_\bmu^n}_-$.

Observing that we always have
$0\le k_1\le k_2\le\cdots\le k_p\le m-p-1$ in \eqref{eq:E_mn_p}, we
can rearrange the order of the sums and relabel $k_p\to\ell$ to get
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{\ell=0}^{m-p-1} D_{m-p,n-p;\mu}^{(\ell)} \p{2\ell+F_{np;\mu}}
  \sum_{\p{\v k,p-1,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}},
  \label{eq:E_mn_p_sum}
\end{align}
where for shorthand we define
\begin{align}
  F_{np;\mu} \equiv p - n + 2\mu S_\z,
  &&
  \sum_{\p{\v k,q,\ell}} X \equiv
  \sum_{k_1=0}^\ell \sum_{k_2=k_1}^\ell
  \cdots \sum_{k_q=k_{q-1}}^\ell X.
\end{align}
We now further define
\begin{align}
  f_{np\ell;\mu}\p{k,q} \equiv \p{\ell-k+q} \p{\ell+k-q+F_{np;\mu}},
\end{align}
and evaluate sums successively over $k_{p-1},k_{p-2},\cdots,k_1$,
finding
\begin{align}
  \sum_{\p{\v k,p-1,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  &= \sum_{\p{\v k,p-2,\ell}}
  \prod_{j=2}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  f_{np\ell;\mu}\p{k_{p-2},1} \\
  &= \f1{\p{r-1}!} \sum_{\p{\v k,p-r,\ell}}
  \prod_{j=r}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  \prod_{q=1}^{r-1} f_{np\ell;\mu}\p{k_{p-r},q} \\
  &= \f1{\p{p-1}!} \prod_{q=1}^{p-1} f_{np\ell;\mu}\p{0,q} \\
  &= { \ell + p - 1 \choose p - 1 }
  \prod_{q=1}^{p-1} \p{\ell-q+F_{np;\mu}}.
\end{align}
Substitution of this result together with $D_{m-p,n-p;\mu}^{(\ell)}$
using \eqref{eq:D_mn_k} into \eqref{eq:E_mn_p_sum} then gives us
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p-1}!} S_\bmu^{n-p-1} S_\mu^{m-p-1} G_{mnp;\mu}
\end{align}
with
\begin{align}
  G_{mnp;\mu}
  &\equiv \sum_{\ell=0}^{m-p-1} { \ell + p - 1 \choose p - 1 }
  \p{m-p-\ell} \p{\ell+m-p+F_{np;\mu}}
  \p{2\ell + F_{np;\mu}}
  \prod_{q=1}^{p-1} \p{\ell-q+F_{np;\mu}} \\
  &= { m \choose p + 1 } \prod_{q=0}^p \p{m-p-q+F_{np;\mu}}.
\end{align}
We can further simplify
\begin{align}
  \prod_{q=0}^p \p{m-p-q+F_{np;\mu}}
  = \prod_{q=0}^p \p{m-n-q+2\mu S_\z}
  = \sum_{q=0}^{p+1} \p{-1}^{p+1-q}
  { p+1 \brack q } \p{m-n+2\mu S_\z}^q,
\end{align}
where ${ n \brack k }$ is an unsigned Stirling number of the first
kind, and finally
\begin{align}
  \sum_{q=0}^p \p{-1}^{p-q} { p \brack q } \p{m-n+2\mu S_\z}^q
  &= \sum_{q=0}^p \p{-1}^{p-q} { p \brack q } \sum_{\ell=0}^q
  { q \choose \ell } \p{m-n}^{q-\ell} \p{2\mu S_\z}^\ell \\
  &= \sum_{\ell=0}^p 2^\ell \sum_{q=\ell}^p \p{-1}^{p-q}
  { p \brack q } { q \choose \ell } \p{m-n}^{q-\ell} \p{\mu S_\z}^\ell.
\end{align}
Putting everything together, we finally have
\begin{align}
  E_{mn;\mu}^{(p-1)}
  = p! { m \choose p } { n \choose p }
  S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \epsilon_{mn}^{p\ell} \p{\mu S_\z}^\ell,
\end{align}
with
\begin{align}
  \epsilon_{mn}^{p\ell}
  \equiv 2^\ell \sum_{q=\ell}^p \p{-1}^{p-q}
  { p \brack q } { q \choose \ell } \p{m-n}^{q-\ell},
\end{align}
where in this final form $E_{mn;\mu}^{(0)} = D_{mn;\mu}$, which
together with the expansion for $C_{mn;\mu}$ in \eqref{eq:C_mn_E}
implies that
\begin{align}
  \sp{S_\mu^m, S_\bmu^n}_-
  = \sum_{p=1}^{\min\set{m,n}}
  p! { m \choose p } { n \choose p } S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \epsilon_{mn}^{p\ell} \p{\mu S_\z}^\ell,
  \label{eq:comm_mu}
\end{align}
and
\begin{align}
  S_\mu^m S_\bmu^n
  = \sum_{p=0}^{\min\set{m,n}}
  p! { m \choose p } { n \choose p } S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \epsilon_{mn}^{p\ell} \p{\mu S_\z}^\ell,
  \label{eq:push_mu_bmu}
\end{align}
If we wish to order products of collective spin operators with $S_\z$
in between $S_\bmu$ and $S_\mu$, then
\begin{align}
  S_\mu^m S_\bmu^n
  = \sum_{p=0}^{\min\set{m,n}} p! { m \choose p } { n \choose p }
  S_\bmu^{n-p} Z_{mn;\bmu}^{(p)} S_\mu^{m-p},
\end{align}
where
\begin{align}
  Z_{mn;\bmu}^{(p)}
  \equiv \sum_{\ell=0}^p \epsilon_{mn}^{p\ell}
  \p{-\sp{m-p} + \mu S_\z}^\ell
  = \sum_{\ell=0}^p \epsilon_{mn}^{p\ell}
  \p{-1}^\ell \p{\sp{m-p} + \bmu S_\z}^\ell
  = \sum_{q=0}^p \zeta_{mn}^{pq} \p{\bmu S_\z}^q,
  \label{eq:Z_mnp}
\end{align}
with
\begin{align}
  \zeta_{mn}^{pq}
  \equiv \sum_{\ell=q}^p \epsilon_{mn}^{p\ell} \p{-1}^\ell
  { \ell \choose q } \p{m-p}^{\ell-q}
  = \p{-1}^p 2^q \sum_{s=q}^p
  { p \brack s } { s \choose q } \p{m+n-2p}^{s-q}.
  \label{eq:zeta_mnpq}
\end{align}


\section{Product of arbitrary ordered collective spin operators}
\label{sec:prod_general}

The most general product of collective spin operators that we need to
compute is
\begin{align}
  \S^{pqr}_{\ell mn;\mu}
  = S_\mu^p \p{\mu S_\z}^q S_\bmu^r
  S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n
  = \sum_{k=0}^{\min\set{r,\ell}} k! { r \choose k } { \ell \choose k }
  S_\mu^{p+\ell-k} \tilde Z_{qr\ell m;\mu}^{(k)} S_\bmu^{r+n-k},
  \label{eq:general_product}
\end{align}
where
\begin{align}
  \tilde Z_{qr\ell m;\mu}^{(k)}
  &\equiv \p{\ell-k+\mu S_\z}^q
  Z_{r\ell;\mu}^{(k)} \p{r-k+\mu S_\z}^m \\
  &= \sum_{a=0}^k \zeta_{r\ell}^{ka}
  \sum_{b=0}^q \p{\ell-k}^{q-b} { q \choose b }
  \sum_{c=0}^m \p{r-k}^{m-c} { m \choose c }
  \p{\mu S_\z}^{a+b+c},
\end{align}
is defined in terms of $Z_{r\ell;\mu}^{(k)}$ and $\zeta_{r\ell}^{ka}$
as respectively given in \eqref{eq:Z_mnp} and \eqref{eq:zeta_mnpq}.
The (anti-)commutator of two ordered products of collective spin
operators is then
\begin{align}
  \sp{S_\mu^p \p{\mu S_\z}^q S_\bmu^r,
    S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_\pm
  = \S^{pqr}_{\ell mn;\mu} \pm \S^{\ell mn}_{pqr;\mu}.
\end{align}


\section{Sandwich identities for single-spin decoherence calculations}
\label{sec:sandwich_single}

In this section we derive several identities which will be necessary
for computing the effects of single-spin decoherence on ordered
products of collective spin operators.  These identities all involve
sandwiching a collective spin operator between operators that act on
individual spins only, and summing such terms over all individual spin
indices.  Our general strategy will be to use commutation relations to
push single-spin operators together, and then evaluate the sum to
arrive at an expression in terms of collective spin operators only.

We first compute sums of single-spin operators sandwiching
$\p{\mu S_\z}^m$, which will in turn be used to compute similar sums
sandwiching $S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$.  Up to Hermitian
conjugation, the unique cases are, for $\mu,\nu\in\set{+1,-1}$,
\begin{align}
  \sum_j s_\z^{(j)} \p{\mu S_\z}^m s_\z^{(j)}
  &= \sum_j s_\z^{(j)} s_\z^{(j)} \p{\mu S_\z}^m
  = \f14 \sum_j \1_j \p{\mu S_\z}^m
  = \f12 S \p{\mu S_\z}^m, \\
  \sum_j s_\z^{(j)} \p{\mu S_\z}^m s_\nu^{(j)}
  &= \p{\mu S_\z}^m \sum_j s_\z^{(j)} s_\nu^{(j)}
  = \f12 \p{\mu S_\z}^m \nu S_\nu
  = \f12 \nu S_\nu \p{\mu\nu+\mu S_\z}^m, \\
  \sum_j s_\nu^{(j)} \p{\mu S_\z}^m s_\nu^{(j)}
  &= \sum_j s_\nu^{(j)} s_\nu^{(j)} \p{\mu\nu+\mu S_\z}^m
  = 0, \\
  \sum_j s_\bnu^{(j)} \p{\mu S_\z}^m s_\nu^{(j)}
  &= \sum_j s_\bnu^{(j)} s_\nu^{(j)} \p{\mu\nu+\mu S_\z}^m
  = \p{S-\nu S_\z} \p{\mu\nu+\mu S_\z}^m.
\end{align}
We are now equipped to derive similar identities for general ordered
products of collective spin operators.  Making heavy use of identities
\eqref{eq:push_z_mu_sS} and \eqref{eq:push_mu_Ss} to push single-spin
operators through transverse collective-spin operators, we again work
through all combinations that are unique up to Hermitian conjugation,
finding
\begin{align}
  \sum_j s_\z^{(j)} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n s_\z^{(j)}
  &= \f12 \p{S-\ell-n} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n
  + \ell n S_\mu^{\ell-1} \p{S+\mu S_\z}
  \p{-1+\mu S_\z}^m S_\bmu^{n-1},
  \label{eq:san_z_z} \allowdisplaybreaks \\
  \sum_j s_\z^{(j)} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n s_\mu^{(j)}
  &= \f12 \mu S_\mu^{\ell+1} \p{1+\mu S_\z}^m S_\bmu^n
  - \mu n \p{S-\ell-\f12\sp{n-1}} S_\mu^\ell
  \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad - \mu\ell n\p{n-1} S_\mu^{\ell-1}
  \p{S+\mu S_\z} \p{-1+\mu S_\z}^m S_\bmu^{n-2},
  \label{eq:san_z_mu} \allowdisplaybreaks \\
  \sum_j s_\z^{(j)} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n s_\bmu^{(j)}
  &= -\f12 \mu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^{n+1}
  + \mu \ell S_\mu^{\ell-1} \p{S+\mu S_\z} \p{-1+\mu S_\z}^m S_\bmu^n,
  \label{eq:san_z_bmu} \allowdisplaybreaks \\
  \sum_j s_\mu^{(j)} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n s_\mu^{(j)}
  &= n S_\mu^{\ell+1} \p{\mu S_\z}^m S_\bmu^{n-1}
  - n\p{n-1} S_\mu^\ell \p{S+\mu S_\z} \p{-1+\mu S_\z}^m S_\bmu^{n-2},
  \label{eq:san_mu_mu} \allowdisplaybreaks \\
  \sum_j s_\mu^{(j)} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n s_\bmu^{(j)}
  &= S_\mu^\ell \p{S+\mu S_\z}\p{-1+\mu S_\z}^m S_\bmu^n,
  \label{eq:san_mu_bmu} \allowdisplaybreaks \\
  \sum_j s_\bmu^{(j)} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n s_\mu^{(j)}
  &= S_\mu^\ell \p{S - \ell - n - \mu S_\z}
  \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n \p{2S - \ell - n + 2}
  S_\mu^{\ell-1} \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad + \ell n \p{\ell-1} \p{n-1} S_\mu^{\ell-2} \p{S+\mu S_\z}
  \p{-1+\mu S_\z}^m S_\bmu^{n-2}.
  \label{eq:san_bmu_mu}
\end{align}


\section{Uncorrelated, permutationally-symmetric single-spin
  decoherence}
\label{sec:decoherence_single}

In this section we work out the effects of permutationally-symmetric
decoherence of individual spins on ordered products of collective spin
operators.  For shorthand, we define
\begin{align}
  \D\p{\gamma;\O} \equiv \D\p{\set{\gamma^{(j)}};\O}
  = \sum_j\p{{\gamma^{(j)}}^\dag \O \gamma^{(j)}
    - \f12\sp{{\gamma^{(j)}}^\dag \gamma^{(j)}, \O}_+},
\end{align}
where $\gamma$ is an operator that acts on a single spin, and
$\gamma^{(j)}$ is an operator that acts with $\gamma$ on spin $j$ and
the identity on all other spins.


\subsection{Decay-type decoherence}
\label{sec:decay_single}

The effect of decoherence via uncorrelated decay ($\mu=-1$) or
excitation ($\mu=1$) of individual spins is described by
\begin{align}
  \D\p{s_\mu; \O}
  = \sum_j\p{s_\bmu^{(j)} \O s_\mu^{(j)}
    - \f12\sp{s_\bmu^{(j)} s_\mu^{(j)},\O}_+}
  = \sum_j s_\bmu^{(j)} \O s_\mu^{(j)}
  - S \O + \f{\mu}{2} \sp{S_\z, \O}_+.
\end{align}
In order to determine the effect of this decoherence on ordered
products of collective spin operators, we expand the anti-commutator
\begin{align}
  \sp{S_\z, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  = S_\z S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n
  + S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\z
  = \mu S_\mu^\ell\p{\ell+n+2\mu S_\z} \p{\mu S_\z}^m S_\bmu^n,
\end{align}
which implies, using \eqref{eq:san_mu_bmu},
\begin{align}
  \D\p{s_\bmu; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  = S_\mu^\ell \p{S+\mu S_\z}\p{-1+\mu S_\z}^m S_\bmu^n
  - S_\mu^\ell\sp{S + \f12\p{\ell+n} + \mu S_\z}
  \p{\mu S_\z}^m S_\bmu^n,
  \label{eq:decay_diff}
\end{align}
and, using \eqref{eq:san_bmu_mu},
\begin{align}
  \D\p{s_\mu; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  &= S_\mu^\ell \p{S - \ell - n - \mu S_\z} \p{1+\mu S_\z}^m S_\bmu^n
  - S_\mu^\ell\sp{S - \f12\p{\ell+n} - \mu S_\z}
  \p{\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n \p{2S - \ell - n + 2}
  S_\mu^{\ell-1} \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad + \ell n \p{\ell-1} \p{n-1} S_\mu^{\ell-2} \p{S + \mu S_\z}
  \p{-1+\mu S_\z}^m S_\bmu^{n-2}.
  \label{eq:decay_same}
\end{align}
Decoherence via jump operators $s_\bmu^{(j)}$ only couples operators
$S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$ to operators
$S_\mu^\ell \p{\mu S_\z}^{m'} S_\bmu^n$ with $m'\le m$.  Decoherence
via jump operators $s_\mu^{(j)}$, meanwhile, makes operators
$S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$ ``grow'' in $m$ through the last
term in \eqref{eq:decay_same} with $k=m$, although the sum $\ell+m+n$
does not grow.


\subsection{Dephasing}
\label{sec:dephasing_single}

The effect of decoherence via single-spin dephasing is described by
\begin{align}
  \D\p{s_\z; \O}
  = \sum_j\p{s_\z^{(j)} \O s_\z^{(j)}
    - \f12\sp{s_\z^{(j)} s_\z^{(j)},\O}_+}
  = \sum_j s_\z^{(j)} \O s_\z^{(j)} - \f12 S \O.
\end{align}
From \eqref{eq:san_z_z}, we then have
\begin{align}
  \D\p{s_\z; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  = -\f12\p{\ell+n} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n
  + \ell n S_\mu^{\ell-1} \p{S + \mu S_\z}
  \p{-1 + \mu S_\z}^m S_\bmu^{n-1}.
\end{align}
Decoherence via single-spin dephasing makes operators
$S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$ ``grow'' in $m$, although the sum
$\ell+m+n$ does not grow.


\subsection{The general case}
\label{sec:general_single}

The most general type of single-spin decoherence is described by
\begin{align}
  \D\p{\gamma;\O}
  = \sum_j\p{{\gamma^{(j)}}^\dag \O \gamma^{(j)}
    - \f12\sp{{\gamma^{(j)}}^\dag \gamma^{(j)}, \O}_+},
  &&
  \gamma \equiv \gamma_\z s_\z + \gamma_+ s_+ + \gamma_- s_-.
  \label{eq:D_general_single}
\end{align}
To simplify \eqref{eq:D_general_single}, we expand
\begin{align}
  \gamma^\dag \O \gamma
  = \abs{\gamma_\z}^2 s_\z \O s_\z
  + \sum_\mu \p{\abs{\gamma_\mu}^2 s_\bmu \O s_\mu
    + \gamma_\bmu^* \gamma_\mu s_\mu \O s_\mu
    + \gamma_\z^* \gamma_\mu s_\z \O s_\mu
    + \gamma_\bmu^* \gamma_\z s_\mu \O s_\z},
\end{align}
and
\begin{align}
  \gamma^\dag \gamma
  = \f14 \abs{\gamma_\z}^2
  + \f12 \sum_\mu \sp{\abs{\gamma_\mu}^2 \p{1-2\mu s_\z}
    + \mu \p{\gamma_\z^*\gamma_\mu - \gamma_\bmu^*\gamma_\z} s_\mu},
\end{align}
which implies
\begin{align}
  \D\p{\gamma;\O}
  &= \sum_{X\in\set{\z,+,-}} \abs{\gamma_X}^2 \D\p{s_X;\O}
  + \sum_{\mu,j}
  \p{\gamma_\bmu^* \gamma_\mu s_\mu^{(j)} \O s_\mu^{(j)}
    + \gamma_\z^* \gamma_\mu s_\z^{(j)} \O s_\mu^{(j)}
    + \gamma_\bmu^* \gamma_\z s_\mu^{(j)} \O s_\z^{(j)}}
  \notag \\
  &\qquad -\f14 \sum_\mu \mu
  \p{\gamma_\z^*\gamma_\mu - \gamma_\bmu^*\gamma_\z} \sp{S_\mu, \O}_+.
\end{align}
In order to compute the effect of this decoherence on ordered products
of collective spin operators, we expand the anti-commutator
\begin{align}
  \sp{S_\mu, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  = S_\mu^{\ell+1} \sp{\p{\mu S_\z}^m+\p{1+\mu S_\z}^m} S_\bmu^n
  - n S_\mu^\ell \p{n-1+2\mu S_\z} \p{\mu S_\z}^m S_\bmu^{n-1}.
  \label{eq:S_mu_acomm}
\end{align}
Recognizing a resemblance between \eqref{eq:S_mu_acomm} and
\eqref{eq:san_z_mu}, we can collect terms to simplify
\begin{align}
  \sum_j s_\z^{(j)} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n s_\mu^{(j)}
  - \f14 \mu \sp{S_\mu, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  = K_{\ell mn;\mu} + L_{\ell mn;\mu}
  \label{eq:dec_z_mu}
\end{align}
and likewise
\begin{align}
  \sum_j s_\mu^{(j)} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n s_\z^{(j)}
  + \f14 \mu \sp{S_\mu, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  = K_{\ell mn;\mu} + M_{\ell mn;\mu}
  \label{eq:dec_mu_z}
\end{align}
with
\begin{align}
  K_{\ell mn;\mu}
  &\equiv \f14 \mu S_\mu^{\ell+1}
  \sp{\p{1+\mu S_\z}^m-\p{\mu S_\z}^m} S_\bmu^n, \\
  L_{\ell mn;\mu}
  &\equiv -\mu n S_\mu^\ell \sp{S-\ell-\f34\p{n-1}-\f12\mu S_\z}
  \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad - \mu\ell n\p{n-1} S_\mu^{\ell-1}
  \p{S+\mu S_\z} \p{-1+\mu S_\z}^m S_\bmu^{n-2}, \\
  M_{\ell mn;\mu}
  &\equiv \mu n S_\mu^\ell \sp{\p{S+\mu S_\z}\p{-1+\mu S_\z}^m
    - \f12\p{\f12\sp{n-1}+\mu S_\z}\p{\mu S_\z}^m} S_\bmu^{n-1}.
\end{align}
Defining for completion
\begin{align}
  P_{\ell mn;\mu}
  &\equiv \sum_j s_\mu^{(j)} S_\mu^\ell
  \p{\mu S_\z}^m S_\bmu^n s_\mu^{(j)} \\
  &= n S_\mu^{\ell+1} \p{\mu S_\z}^m S_\bmu^{n-1}
  - n\p{n-1} S_\mu^\ell \p{S+\mu S_\z} \p{-1+\mu S_\z}^m S_\bmu^{n-2},
\end{align}
and
\begin{align}
  Q_{\ell mn;\mu}^{(\gamma)}
  \equiv \gamma_\bmu^* \gamma_\mu P_{\ell mn;\mu}
  + \p{\gamma_\z^* \gamma_\mu + \gamma_\bmu^* \gamma_\z}
  K_{\ell mn;\mu}
  + \gamma_\z^* \gamma_\mu L_{\ell mn;\mu}
  + \gamma_\bmu^* \gamma_\z M_{\ell mn;\mu},
  \label{eq:Q_single}
\end{align}
we finally have
\begin{align}
  \D\p{\gamma; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  = \sum_{X\in\set{\z,+,-}} \abs{\gamma_X}^2
  \D\p{s_X; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  + Q_{\ell mn;\mu}^{(\gamma)} + \sp{Q_{nm\ell;\mu}^{(\gamma)}}^\dag.
\end{align}
Note that the sum $\ell+m+n$ for operators
$S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$ does not grow under this type of
decoherence.


\section{Sandwich identities for collective-spin decoherence
  calculations}
\label{sec:sandwich_collective}

In analogy with the work in Appendix \ref{sec:sandwich_single}, in
this section we work out sandwich identities necessary for
collective-spin decoherence calculations.  The simplest cases are
\begin{align}
  S_\mu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\bmu
  &= S_\mu^{\ell+1} \p{\mu S_\z}^m S_\bmu^{n+1},
  \allowdisplaybreaks \\
  S_\mu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\z
  &= \mu S_\mu^{\ell+1} \p{n+\mu S_\z} \p{\mu S_\z}^m S_\bmu^n,
  \allowdisplaybreaks \\
  S_\z S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\z
  &= S_\mu^\ell \sp{\ell n + \p{\ell+n} \mu S_\z + \p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^n.
\end{align}
With a bit more work, we can also find
\begin{align}
  S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= S_\mu^{\ell+1} \p{1+\mu S_\z}^m S_\bmu^n
  - n S_\mu^\ell \p{n-1+2\mu S_\z} \p{\mu S_\z}^m S_\bmu^{n-1},
\end{align}
which implies
\begin{align}
  S_\mu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= S_\mu^{\ell+2} \p{1+\mu S_\z}^m S_\bmu^n
  - n S_\mu^{\ell+1} \p{n-1+2\mu S_\z} \p{\mu S_\z}^m S_\bmu^{n-1},
  \allowdisplaybreaks \\
  S_\z S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= \mu S_\mu^{\ell+1} \p{\ell+1+\mu S_\z} \p{1+\mu S_\z}^m S_\bmu^n
  \notag \\
  &\qquad - \mu n S_\mu^\ell
  \sp{\ell\p{n-1} + \p{2\ell+n-1}\mu S_\z + 2\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-1}.
\end{align}
Finally, we compute
\begin{align}
  S_\bmu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= \sp{S_\mu^\ell S_\bmu - \ell S_\mu^{\ell-1} \p{\ell-1+2\mu S_\z}}
  \p{\mu S_\z}^m
  \sp{S_\mu S_\bmu^n - n \p{n-1+2\mu S_\z} S_\bmu^{n-1}} \notag \\
  &= S_\mu^\ell S_\bmu \p{\mu S_\z}^m S_\mu S_\bmu^n \notag \\
  &\qquad - S_\mu^\ell
  \sp{\ell\p{\ell+1} + n\p{n+1}+2\p{\ell+n}\mu S_\z}
  \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n S_\mu^{\ell-1}
  \sp{\p{\ell-1}\p{n-1}+2\p{\ell+n-2}\mu S_\z + 4\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-1},
\end{align}
where
\begin{multline}
  S_\bmu \p{\mu S_\z}^m S_\mu
  = S_\bmu S_\mu \p{1+\mu S_\z}^m
  = \p{S_\mu S_\bmu - 2\mu S_\z} \p{1+\mu S_\z}^m \\
  = S_\mu \p{2+\mu S_\z}^m S_\bmu - 2\mu S_\z \p{1+\mu S_\z}^m,
\end{multline}
so
\begin{align}
  S_\bmu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= S_\mu^{\ell+1} \p{2+\mu S_\z}^m S_\bmu^{n+1} \notag \\
  &\qquad - S_\mu^\ell
  \sp{\ell\p{\ell+1} + n\p{n+1}+2\p{\ell+n+1}\mu S_\z}
  \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n S_\mu^{\ell-1}
  \sp{\p{\ell-1}\p{n-1}+2\p{\ell+n-2}\mu S_\z + 4\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-1}.
\end{align}


\section{Collective spin decoherence}
\label{sec:decoherence_collective}

In this section we work out the effects of decoherence via collective
jump operators on ordered products of collective spin operators.  For
shorthand, we define
\begin{align}
  \D\p{\Gamma;\O}
  \equiv \D\p{\set{\Gamma};\O}
  = \Gamma^\dag \O \Gamma - \f12\sp{\Gamma^\dag \Gamma, \O}_+,
\end{align}
where $\Gamma$ is a collective spin operator with weight one, i.e.~a
linear combination of $S_\z$, $S_\mu$, and $S_\bmu$.

\subsection{Decay-type decoherence and dephasing}
\label{sec:decay_dephasing_collective}

Making use of the results in Appendix \ref{sec:sandwich_collective},
we find that the effects of collective decay-type decoherence on
ordered products of collective spin operators are given by
\begin{align}
  \D\p{S_\bmu; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  &= -S_\mu^{\ell+1} \sp{\p{1+\mu S_\z}^m - \p{\mu S_\z}^m}
  S_\bmu^{n+1} \notag \\
  &\qquad + \f12 S_\mu^\ell \sp{\ell\p{\ell-1} + n\p{n-1}
    + 2\p{\ell+n}\mu S_\z} \p{\mu S_\z}^m S_\bmu^n,
\end{align}
and
\begin{align}
  \D\p{S_\mu; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  &= S_\mu^{\ell+1} \sp{\p{2+\mu S_\z}^m-\p{1+\mu S_\z}^m}
  S_\bmu^{n+1} \notag \\
  &\qquad - S_\mu^\ell
  \sp{\ell\p{\ell+1} + n\p{n+1}+2\p{\ell+n+1}\mu S_\z}
  \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \f12 S_\mu^\ell
  \sp{\ell\p{\ell+1} + n\p{n+1}+2\p{\ell+n+2}\mu S_\z}
  \p{\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n S_\mu^{\ell-1}
  \sp{\p{\ell-1}\p{n-1}+2\p{\ell+n-2}\mu S_\z + 4\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-1}.
\end{align}
Similarly, we can work out that the effect of collective spin
dephasing is given by
\begin{align}
  \D\p{S_\z; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  = -\f12 \p{\ell-n}^2 S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n.
\end{align}


\subsection{The general case}
\label{sec:general_collective}

More generally, we may need to consider collective-spin jump operators
of the form
\begin{align}
  \Gamma \equiv \Gamma_\z S_\z + \Gamma_+ S_+ + \Gamma_- S_-,
\end{align}
whose decoherence effects are determined by
\begin{align}
  \Gamma^\dag \O \Gamma
  = \abs{\Gamma_\z}^2 S_\z \O S_\z
  + \sum_\mu \p{\abs{\Gamma_\mu}^2 S_\bmu \O S_\mu
    + \Gamma_\bmu^* \Gamma_\mu S_\mu \O S_\mu
    + \Gamma_\z^* \Gamma_\mu S_\z \O S_\mu
    + \Gamma_\bmu^* \Gamma_\z S_\mu \O S_\z},
\end{align}
and
\begin{align}
  \Gamma^\dag \Gamma
  = \abs{\Gamma_\z}^2 S_\z^2
  + \sum_\mu \p{\abs{\Gamma_\mu}^2 S_\bmu S_\mu
    + \Gamma_\z^*\Gamma_\mu S_\z S_\mu
    + \Gamma_\bmu^* \Gamma_\z S_\mu S_\z
    + \Gamma_\bmu^* \Gamma_\mu S_\mu^2},
\end{align}
which implies
\begin{align}
  \D\p{\Gamma;\O}
  &= \sum_{X\in\set{\z,+,-}} \abs{\Gamma_X}^2 \D\p{S_X;\O}
  + \sum_\mu \p{\Gamma_\bmu^* \Gamma_\mu S_\mu \O S_\mu
    + \Gamma_\z^* \Gamma_\mu S_\z \O S_\mu
    + \Gamma_\bmu^* \Gamma_\z S_\mu \O S_\z}
  \notag \\
  &\qquad -\f12 \sum_\mu\p{\Gamma_\bmu^* \Gamma_\mu \sp{S_\mu^2, \O}_+
    + \Gamma_\z^*\Gamma_\mu \sp{S_\z S_\mu, \O}_+
    + \Gamma_\bmu^* \Gamma_\z \sp{S_\mu S_\z, \O}_+}.
\end{align}
In order to compute the effect of this decoherence on ordered products
of collective spin operators, we expand the anti-commutators
\begin{align}
  \sp{S_\mu^2, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  &= S_\mu^{\ell+2} \sp{\p{2+\mu S_\z}^m+\p{\mu S_\z}^m} S_\bmu^n
  - 2n S_\mu^{\ell+1} \p{n+2\mu S_\z} \p{1+\mu S_\z}^m S_\bmu^{n-1}
  \notag \\
  &\qquad + n\p{n-1} S_\mu^\ell \sp{\p{n-1}\p{n-2}
    + 2\p{2n-3}\mu S_\z + 4\p{\mu S_\z}^2} \notag \\
  &\qquad\qquad\qquad\qquad \times \p{\mu S_\z}^m S_\bmu^{n-2},
  \allowdisplaybreaks \\
  \sp{S_\z S_\mu, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  &= \mu S_\mu^{\ell+1} \sp{\p{\ell+1+\mu S_\z}\p{\mu S_\z}^m
    + \p{n+1+\mu S_\z} \p{1+\mu S_\z}^m } S_\bmu^n \notag \\
  &\qquad - \mu n S_\mu^\ell \sp{n \p{n-1}
    + \p{3n-1}\mu S_\z + 2\p{\mu S_\z}^2} \p{\mu S_\z}^m S_\bmu^{n-1},
  \allowdisplaybreaks \\
  \sp{S_\mu S_\z, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  &= \mu S_\mu^{\ell+1} \sp{\p{\ell+\mu S_\z}\p{\mu S_\z}^m
    + \p{n+\mu S_\z} \p{1+\mu S_\z}^m} S_\bmu^n \notag \\
  &\qquad - \mu n S_\mu^\ell \sp{\p{n-1}^2
    + 3\p{n-1}\mu S_\z + 2\p{\mu S_\z}^2} \p{\mu S_\z}^m S_\bmu^{n-1}.
\end{align}
Collecting terms and defining
\begin{align}
  \Gamma_{\z,\mu}^{(\pm)}
  &\equiv \f12\p{\Gamma_\z^* \Gamma_\mu \pm \Gamma_\bmu^* \Gamma_\z},
  \allowdisplaybreaks \\
  \tilde L_{\ell mn;\mu}^{(\Gamma)}
  &\equiv \mu \sp{\p{\ell-n+\f12} \Gamma_{\z,\mu}^{(+)}
    + \p{\ell+\f12} \Gamma_{\z,\mu}^{(-)}}
  S_\mu^{\ell+1} \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad -\mu \sp{\p{\ell-n+\f12} \Gamma_{\z,\mu}^{(+)}
    + \p{n+\f12} \Gamma_{\z,\mu}^{(-)}}
  S_\mu^{\ell+1} \p{\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \mu \Gamma_{\z,\mu}^{(-)}
  S_\mu^{\ell+1} \mu S_\z
  \sp{\p{1+\mu S_\z}^m - \p{\mu S_\z}^m} S_\bmu^n,
  \allowdisplaybreaks \\
  \tilde M_{\ell mn;\mu}^{(\Gamma)}
  &= -\mu n\p{n-1} \sp{\p{\ell-n+\f12} \Gamma_{\z,\mu}^{(+)}
    + \p{\ell-\f12} \Gamma_{\z,\mu}^{(-)}}
  S_\mu^\ell \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad - 2\mu n \sp{\p{\ell-n+\f12} \Gamma_{\z,\mu}^{(+)}
    + \p{\ell+\f12n-1} \Gamma_{\z,\mu}^{(-)}}
  S_\mu^\ell \p{\mu S_\z}^{m+1} S_\bmu^{n-1} \notag \\
  &\qquad - 2\mu n \Gamma_{\z,\mu}^{(-)}
  S_\mu^\ell \p{\mu S_\z}^{m+2} S_\bmu^{n-1},
  \allowdisplaybreaks \\
  \tilde P_{\ell mn;\mu}
  &\equiv -\f12 S_\mu^{\ell+2}
  \sp{\p{2+\mu S_\z}^m - 2\p{1+\mu S_\z}^m + \p{\mu S_\z}^m}
  S_\bmu^n \notag \\
  &\qquad + n S_\mu^{\ell+1} \sp{\p{n+2\mu S_\z} \p{1+\mu S_\z}^m
    - \p{n-1+2\mu S_\z} \p{\mu S_\z}^m}
  S_\bmu^{n-1} \notag \\
  &\qquad -n\p{n-1} S_\mu^\ell
  \sp{\f12\p{n-1}\p{n-2} + \p{2n-3}\mu S_\z + 2\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-2},
  \allowdisplaybreaks \\
  \tilde Q_{\ell mn;\mu}^{(\Gamma)}
  &\equiv \Gamma_\bmu^* \Gamma_\mu \tilde P_{\ell mn;\mu}
  + \tilde L_{\ell mn;\mu}^{(\Gamma)}
  + \tilde M_{\ell mn;\mu}^{(\Gamma)},
\end{align}
we then have
\begin{align}
  \D\p{\Gamma; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  = \sum_{X\in\set{\z,+,-}} \abs{\Gamma_X}^2
  \D\p{S_X; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  + \tilde Q_{\ell mn;\mu}^{(\Gamma)}
  + \sp{\tilde Q_{nm\ell;\mu}^{(\Gamma)}}^\dag.
\end{align}
Note that the sum $\ell+m+n$ for operators
$S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$ grows by one if $\Gamma_\mu\ne0$
or $\Gamma_\bmu\ne0$, and does not grow otherwise.


\section{Initial conditions}
\label{sec:initial_conditions}

Initial conditions for all collective spin operators can be determined
from the expansions
\begin{align}
  S_\z = \sum_{k=-S}^S k \op{k},
  &&
  S_\mu = \sum_{k=-S+\delta_{\mu,-1}}^{S-\delta_{\mu,1}}
  g_\mu\p{S,k} \op{k+\mu}{k},
\end{align}
with
\begin{align}
  g_\mu\p{S,k} \equiv \sqrt{\p{S-\mu k}\p{S+\mu k+1}},
\end{align}
and the initial states
\begin{align}
  \ket{\pm\Z} \equiv \ket{\pm S},
  &&
  \ket{\X} \equiv 2^{-N/2} \sum_{k=-S}^S
  { N \choose S+k }^{1/2} \ket{k},
\end{align}
using which we can compute, for $\mu,\nu\in\set{+1,-1}$,
$\bmu\equiv-\mu$,
\begin{align}
  \bk{\nu\Z|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\nu\Z}
  = \delta_{\ell n} \times
  \begin{cases}
     \p{S-n}^m \f{N! n!}{\p{N-n}!} & \mu = \nu, \\
     \delta_{n,0} \p{-S}^m & \mu \ne \nu,
  \end{cases}
\end{align}
and
\begin{align}
  \bk{\X|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\X}
  &=  \f{\mu^m}{2^N} \sum_{k=-S+\delta_{\mu,-1}\max\set{\ell,n}}
  ^{S-\delta_{\mu,1}\max\set{\ell,n}} k^m
  \sp{{ N \choose S+k+\mu\ell } { N \choose S+k+\mu n }}^{1/2}
  \notag \\
  &\qquad\qquad\qquad\qquad
  \times \prod_{p=0}^{\ell-1} g_\mu\p{S,k+\mu p}
  \prod_{q=0}^{n-1} g_\bmu\p{S,k+\mu\sp{n-q}} \\
  &= \mu^m \f{N!}{2^N} \sum_{k=-S+\delta_{\mu,-1}\max\set{\ell,n}}
  ^{S-\delta_{\mu,1}\max\set{\ell,n}}
  \f{k^m \p{S-\mu k}!}
  {\p{S+\mu k}!\p{S-\mu k-\ell}!\p{S-\mu k-n}!} \\
  &= \f{N!}{2^N} \sum_{k=-S}^{S-\max\set{\ell,n}}
  \f{k^m \p{S-k}!}{\p{S+k}!\p{S-k-\ell}!\p{S-k-n}!}.
\end{align}
Furthermore, using the fact that
\begin{align}
  e^{i\phi S_\z} S_\mu e^{-i\phi S_\z} = e^{i\mu\phi} S_\mu,
\end{align}
we can define the state
\begin{align}
  \ket{\phi} \equiv e^{-i\phi S_\z}\ket{\X},
  &&
  \p{\cos\phi S_\x + \sin\phi S_\y} \ket\phi = S \ket\phi,
\end{align}
and say that
\begin{align}
  \bk{\phi|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\phi}
  = e^{i\mu\p{\ell-n}\phi} \bk{\X|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\X}.
\end{align}
Alternatively, with the help of Mathematica we can find
\begin{align}
  \bk{\X|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\X}
  = \f{\p{N!}^2}{2^N\p{N-\ell}!\p{N-n}!}
  \sp{\p{-S}^m \alpha_{N\ell n}
    + \f{\p{N-\ell}\p{N-n}}{N} \beta_{N\ell mn}},
\end{align}
where $\alpha$ and $\beta$ are defined in terms of the generalized
hypergeometric function $\F$ by
\begin{align}
  \alpha_{N\ell n}
  \equiv \F\p{\let\scriptstyle\textstyle
    \substack{\ell-N,~n-N \\ -N}~; -1},
\end{align}
and
\begin{align}
  \beta_{N\ell mn}
  \equiv \sum_{p=0}^{m-1} \p{-S}^p { m \choose p }
  \tilde\F_{m-p-1}\p{\let\scriptstyle\textstyle
    \substack{1+\ell-N,~1+n-N \\ 1-N}~; -1},
\end{align}
for
\begin{align}
  \tilde\F_q\p{\let\scriptstyle\textstyle
    \substack{a,~b\\c}~; z}
  \equiv \F\p{\let\scriptstyle\textstyle
    \substack{2,2,\cdots,2,a,b \\ 1,1,\cdots,1,c}~; z}
\end{align}
with $q$ repetitions of 2 and 1.


\section{Changing bases for collective-spin operators}

For a collective-spin system composed of many small spins, the
operators $\S_{\v m}\equiv S_+^{m_+} S_\z^{m_\z} S_-^{m_-}$ keep track
of $\abs{\v m}$-body operators (for $\abs{\v m}\equiv\sum_\mu m_\mu$),
but also carry lots of ``baggage'' in the form of $k$-body operators
with $k<\abs{\v m}$.  To cut down on this overhead, we change our
basis for collective-spin operators from $\S_{\v m}$ to the
purely-$\abs{\v m}$-body operators
\begin{align}
  \tilde\S_{\v m} \equiv \sum_{\p{\v j;\v m}} P_{\v j},
  &&
  P_{\v j} \equiv \prod_{\mu,a} s_\mu^{\p{j^\mu_a}},
\end{align}
where $\v m \equiv \p{m_\z,m_+,m_-}\in\mathbb{N}_0^3$ with $m_\mu$ the
number of $s_\mu$ operators in each term of $\S_{\v m}$; $\v j$ is an
ordered list of indices for the spins addressed by $P_{\v j}$; and the
sum over $\p{\v j;\v m}$ denotes a sum over all possible $\v j$ for
which all indices in $\v j$ are distinct and
$\abs{\set{j^\mu_a}} = m_\mu$, such that $j^\mu_a$ indexes the $a$-th
spin addressed by a $s_\mu$ operator in $P_{\v j}$.

We now expand a product of basis operators $\tilde\S_{\v m}$ and
$\tilde\S_{\v n}$ into terms that have exactly $s$ spins addressed by
both operators:
\begin{align}
  \tilde\S_{\v m} \tilde\S_{\v n}
  = \sum_{s\ge0} \sum_{\p{\v j,\v k;\v m,\v n,s}} P_{\v j} P_{\v k},
  &&
  \sum_{\p{\v j,\v k;\v m,\v n,s}} X \equiv
  \sum_{\substack{\p{\v j;\v m},\p{\v k;\v n} \\
      \abs{\set{j_\alpha^\mu}\cap\set{k_\beta^\nu}}=s}} X.
  \label{eq:SS_PP}
\end{align}
Collecting terms in which $r_{\mu\nu}$ of the $s_\mu$ operators in
$P_{\v j}$ address the same spin as a $s_\nu$ operator in $P_{\v k}$,
we have
\begin{align}
  \tilde\S_{\v m} \tilde\S_{\v n}
  = \sum_{s\ge0} \sum_{\p{\v r;\v m,\v n,s}} f_{\v m\v n\v r}
  \sum_{\p{\v J,\v K;\v m,\v n,\v r}} P_{\v J} Q_{\v K},
  \label{eq:SS_PQ}
\end{align}
where the sum over $\p{\v r;\v m,\v n,s}$ denotes a sum over all
values of $\v r$ with the restrictions
\begin{align}
  r_{\mu\nu} \ge 0 ~\forall~ \mu,\nu,
  &&
  \sum_\nu r_{\mu\nu} \le m_\mu,
  &&
  \sum_\mu r_{\mu\nu} \le n_\nu,
  &&
  \sum_{\mu,\nu} r_{\mu\nu} = s;
  \label{eq:rest_r}
\end{align}
the factor $f_{\v m\v n\v r}$ counts the number of ways to pair
operators in $P_{\v j}$ and $P_{\v k}$ according to $\v r$, or
\begin{align}
  f_{\v m\v n\v r}
  &\equiv \sp{\prod_{\mu,\nu}
    { m_\mu - \sum_{\rho<\nu} r_{\mu\rho} \choose r_{\mu\nu} }
    { n_\mu - \sum_{\rho<\nu} r_{\rho\mu} \choose r_{\nu\mu} }}
  \sp{\prod_{\mu,\nu} r_{\mu\nu}!} \\
  &= \sp{\prod_\mu \p{m_\mu}_{\sum_\rho r_{\mu\rho}}
    \p{n_\mu}_{\sum_\rho r_{\rho\mu}}}
  \sp{\prod_{\mu,\nu} r_{\mu\nu}!}^{-1},
\end{align}
with $\p{n}_k\equiv\prod_{j=0}^{k-1}\p{n-j}$ denoting a falling
factorial; $\v J$ and $\v K$ are respectively ordered lists of indices
for spins addressed by one and two single-spin operators in a term of
the product $P_{\v j} P_{\v k}$ with fixed $\v r$; the sum over
$\p{\v J,\v K;\v m,\v n,\v r}$ denotes a sum over all values of
$\v J,\v K$ with the restrictions
\begin{align}
  \abs{\set{J_a^\mu}}
  = m_\mu + n_\mu - \sum_\rho\p{r_{\mu\rho}+r_{\rho\mu}},
  &&
  \abs{\set{K^{\mu\nu}_a}} = r_{\mu\nu},
  &&
  \set{J_a^\lambda} \cap \set{K_b^{\mu\nu}} = \set{};
\end{align}
and finally, similarly to $P_{\v j}$ in \eqref{eq:SS_PP} we define
\begin{align}
  Q_{\v K} \equiv \prod_{\mu,\nu,a}
  s_\mu^{(K^{\mu\nu}_a)} s_\nu^{(K^{\mu\nu}_a)}.
\end{align}
As the sum in \eqref{eq:SS_PQ} is invariant under permutation of the
indices in $\v K$, we can safely neglect keeping track of these
indices and simply write
\begin{align}
  Q_{\v K}
  = \prod_{\mu,\nu} \prod_{a=1}^{r_{\mu\nu}}
  s_\mu^{(K^{\mu\nu}_a)} s_\nu^{(K^{\mu\nu}_a)}
  \simeq \bigotimes_{\mu,\nu} \bigotimes_{a=1}^{r_{\mu\nu}} s_\mu s_\nu
  = \bigotimes_{\mu,\nu} \bigotimes_{a=1}^{r_{\mu\nu}}
  \sum_\rho \eta_{\mu\nu\rho} s_\rho,
  \label{eq:Q_K_eta}
\end{align}
where $\simeq$ denotes equality up to a re-indexing of spins; we have
introduced explicit dependence on
$r_{\mu\nu}=\abs{\set{K^{\mu\nu}_a}}$ for brevity; and
$\eta_{\mu\nu\rho}$ is defined by
$s_\mu s_\nu=\sum_\rho\eta_{\mu\nu\rho}s_\rho$.  Unlike the sums over
$\mu,\nu$ in most of the work above, the sum over $\rho$ here includes
an index for the identity operator $s_0\equiv\1$.  Distributing the
product of sums into a sum of products gives us
\begin{align}
  Q_{\v K}
  \simeq \sum_{\v\rho} \bigotimes_{\mu,\nu,a}
  \eta_{\mu\nu\rho^{\mu\nu}_a} s_{\rho^{\mu\nu}_a}
  = \sum_{\v\rho} \sp{\prod_{\mu,\nu,a}
    \p{\eta_{\mu\nu\rho^{\mu\nu}_a}}^{\rho^{\mu\nu}_a}}
  \bigotimes_{\mu,\nu,a} s_{\rho^{\mu\nu}_a},
  \label{eq:Q_K_rho}
\end{align}
where implicitly $\abs{\set{\rho^{\mu\nu}_a}}=r_{\mu\nu}$, as
$\p{\mu,\nu,a}$ essentially index a factor in \eqref{eq:Q_K_eta} and
$\rho^{\mu\nu}_a$ indexes one of the terms in that factor.  Letting
$\tilde\rho^{\mu\nu}_\kappa$ denote the number of elements in
$\p{\rho^{\mu\nu}_1,\rho^{\mu\nu}_2,\cdots,\rho^{\mu\nu}_{r_{\mu\nu}}}$
that are equal to $\kappa$, we observe that two terms in
\eqref{eq:Q_K_rho} with, say, $\v\rho=\v\rho_1$ and $\v\rho=\v\rho_2$
are equal up to a permutation of indices if
$\tilde{\v\rho_1}=\tilde{\v\rho_2}$.  The degeneracy of terms in
\eqref{eq:Q_K_rho}, i.e.~the number of $\v\rho$ which are consistent
with $\tilde{\v\rho}$, is
\begin{align}
  g_{\tilde{\v\rho}}
  \equiv \prod_{\mu,\nu,\kappa}
  { r_{\mu\nu} - \sum_{\lambda<\kappa} \tilde\rho^{\mu\nu}_\lambda
    \choose \tilde\rho^{\mu\nu}_\kappa }
  = \prod_{\mu,\nu}
  \f{r_{\mu\nu}!}{\prod_\kappa\tilde\rho^{\mu\nu}_\kappa!}.
\end{align}
Defining additionally
\begin{align}
  \v\eta_{\tilde{\v\rho}}
  \equiv \prod_{\mu,\nu,\kappa}
  \p{\eta_{\mu\nu\kappa}}^{\tilde\rho^{\mu\nu}_\kappa},
  \label{eq:eta_rho}
\end{align}
we can collect like factors and group together equivalent terms in
\eqref{eq:Q_K_rho} to write
\begin{align}
  Q_{\v K}
  \simeq \sum_{\tilde{\v\rho}} g_{\tilde{\v\rho}} \v\eta_{\tilde{\v\rho}}
  \bigotimes_{\kappa}
  s_\kappa^{\otimes\sum_{\mu,\nu}\tilde\rho^{\mu\nu}_\kappa}
  \simeq \sum_{\tilde{\v\rho}} g_{\tilde{\v\rho}} \v\eta_{\tilde{\v\rho}}
  \1^{\otimes\sum_{\mu,\nu}\tilde\rho^{\mu\nu}_0}
  \otimes \bigotimes_{\kappa\ne0}
  s_\kappa^{\otimes\sum_{\mu,\nu}\tilde\rho^{\mu\nu}_\kappa},
  \label{eq:Q_K_rho_simp}
\end{align}
where again implicitly
$\sum_\kappa\tilde\rho^{\mu\nu}_\kappa=r_{\mu\nu}$ for consistency
with \eqref{eq:Q_K_eta} and \eqref{eq:Q_K_rho}, and we have explicitly
factored out the identity operators in each term of $Q_{\v K}$.

We have now simplified $Q_{\v K}$ sufficiently to substitute it back
into \eqref{eq:SS_PQ}, which (removing the tilde from $\tilde{\v\rho}$
to simplify notation) gives us
\begin{align}
  \tilde\S_{\v m} \tilde\S_{\v n}
  = \sum_{s\ge0} \sum_{\p{\v r;\v m,\v n,s}} f_{\v m\v n\v r}
  \sum_{\p{\v\rho;\v r}} g_{\v\rho} \v\eta_{\v\rho}
  c_{\v\ell_{\v m\v n\v r\v\rho}\v\rho}
  \tilde\S_{\v\ell_{\v m\v n\v r\v\rho}},
  \label{eq:SS_simp}
\end{align}
where the sum over $\p{\v\rho;\v r}$ denotes a sum over all values of
$\v\rho$ and with the restrictions
\begin{align}
  \abs{\set{\rho^{\mu\nu}_\kappa}} = \abs{\set{s_\kappa}},
  &&
  \sum_{\kappa} \rho^{\mu\nu}_\kappa = r_{\mu\nu};
\end{align}
the combinatorial factor
\begin{align}
  c_{\v\ell\v\rho}
  \equiv \p{ N - \sum_\kappa\ell_\kappa }_{\sum_{\mu,\nu}\rho^{\mu\nu}_0}
\end{align}
accounts for the number of terms which are equivalent up to a
permutation of indices involving the identity operators in
\eqref{eq:Q_K_rho_simp}; and the number of $s_\mu$ operators in each
term of $\tilde\S_{\v\ell_{\v m\v n\v r\v\rho}}$ is
\begin{align}
  \ell_{\v m\v n\v r\v\rho;\mu}
  = m_\mu + n_\mu - \sum_\kappa \p{r_{\mu\kappa}+r_{\kappa\mu}}
  + \sum_{\alpha,\beta} \rho^{\alpha\beta}_\mu.
\end{align}

The sums in \eqref{eq:SS_simp} generally involve a large number of
terms; in practice, many of these terms will be equal to zero.  We
can, however, impose additional restrictions on these sums in such a
way as to throw out terms which vanish, and keep only those which do
not.  Remembering that $s$ counts the number of spins which are
addressed by both operators $P_{\v j}$ and $P_{\v k}$ in
\eqref{eq:SS_PP}, the first restriction we can impose comes from
recognizing that for given $\tilde\S_{\v m},\tilde\S_{\v n}$, the
overlap $s$ is bounded as
\begin{align}
  \max\set{0,\sum_\mu\p{m_\mu+n_\mu}-N}
  \le s \le \min\set{N,\sum_\mu\p{m_\mu+n_\mu}}.
\end{align}
In addition, the multiplication table $\eta_{\mu\nu\kappa}$ may
generally contain zeros that we can preemptively avoid with
restrictions on $\v r$ and $\v\rho$.  Recalling that $r_{\mu\nu}$
counts the number of operators addressed by
$s_\mu s_\nu=\sum_\kappa\eta_{\mu\nu\kappa} s_\kappa$, if
$\eta_{\mu\nu\kappa}=0$ for all $\kappa$, i.e.~$s_\mu s_\nu=0$, then
any term with $r_{\mu\nu}>0$ will vanish.  Our second restriction on
the sums in \eqref{eq:SS_simp} is therefore to fix $r_{\mu\nu}=0$ for
all $\mu,\nu$ with $s_\mu s_\nu=0$.  Finally, we can avoid the
nullifying effect of any additional zeros in the multiplication table
$\eta_{\mu\nu\kappa}$, which appear as factors in
$\v\eta_{\v\rho}\propto\p{\eta_{\mu\nu\kappa}}^{\rho^{\mu\nu}_\kappa}$
as defined in \eqref{eq:eta_rho}, by restricting
$\rho^{\mu\nu}_\kappa=0$ for all $\mu,\nu,\kappa$ with
$\eta_{\mu\nu\kappa}=0$.  These restrictions are sufficient to ensure
that all individual terms in \eqref{eq:SS_simp} are nonzero, although
they do not rule out the possibility of several terms canceling out.

\end{document}
\documentclass[aps,notitlepage,nofootinbib,11pt]{revtex4-1}

% linking references
\usepackage{hyperref}
\hypersetup{
  breaklinks=true,
  colorlinks=true,
  linkcolor=blue,
  filecolor=magenta,
  urlcolor=cyan,
}

%%% symbols, notations, etc.
\usepackage{physics,braket,bm,commath,amssymb} % physics and math
\renewcommand{\t}{\text} % text in math mode
\newcommand{\f}[2]{\dfrac{#1}{#2}} % shorthand for fractions
\newcommand{\p}[1]{\left(#1\right)} % parenthesis
\renewcommand{\sp}[1]{\left[#1\right]} % square parenthesis
\renewcommand{\set}[1]{\left\{#1\right\}} % curly parenthesis
\renewcommand{\v}{\bm} % bold vectors
\newcommand{\uv}[1]{\v{\hat{#1}}} % unit vectors
\renewcommand{\c}{\cdot} % inner product
\newcommand{\bk}{\Braket} % shorthand for braket notation
\renewcommand{\d}{\text{d}} % "d" for integration measure

\newcommand{\C}{\mathcal{C}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\I}{\mathcal{I}}
\renewcommand{\O}{\mathcal{O}}
\renewcommand{\S}{\mathcal{S}}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}

\newcommand{\bmu}{{\bar\mu}}
\newcommand{\floor}[1]{\left\lfloor{#1}\right\rfloor}

\usepackage{dsfont} % for identity operator
\newcommand{\1}{\mathds{1}}

\usepackage[inline]{enumitem} % for inline enumeration

%%% figures
\usepackage{graphicx} % for figures
\usepackage{grffile} % help latex properly identify figure extensions
\usepackage[caption=false]{subfig} % subfigures (via \subfloat[]{})
\graphicspath{{./figures/}} % set path for all figures

% for strikeout text
% normalem included to prevent underlining titles in the bibliography
\usepackage[normalem]{ulem}

% for leaving notes in the text
\newcommand{\note}[1]{\textcolor{red}{#1}}


\begin{document}

\title{Solving Collective Spin Hamiltonians with Decoherence}

\author{Michael A. Perlin}

\maketitle

Previous work has shown how to realize various spin-squeezing
Hamiltonians with ultracold atomic systems.  While it is
straightforward to simulate the dynamics generated by these
Hamiltonians in the context of a closed quantum system, here we try to
develop an understanding of their the squeezing behavior in the
presence of decoherence.  In particular, we will be considering
dynamics induced by the collective one-axis twisting (OAT), two-axis
twisting (TAT), and transverse field (TVF) Hamiltonians of the form
\begin{align}
  H_{\t{OAT}} = \chi S_z^2,
  &&
  H_{\t{TAT}}^{z,y} = \chi \p{S_z^2 - S_y^2},
  &&
  H_{\t{TVF}} = \chi S_z^2 + \Omega S_x,
\end{align}
for spins which decay in an uncorrelated manner at a rate $\gamma$.
The evolution of any Heisenburg operator $\O$ with a Hamiltonian $H$
is given by
\begin{align}
  \f{d}{dt} \O
  = i\sp{H,\O}_- + \gamma\D_-\p{\O},
  &&
  \D_-\p{\O} \equiv \sum_j\p{\sigma_j^+\O\sigma_j^-
    - \f12\sp{\sigma_j^+\sigma_j^-,\O}_+},
  \label{eq:EOM}
\end{align}
where $\sp{A,B}_\pm\equiv AB\pm BA$ and $j$ indexes an individual
spin.  Our measure of squeezing is
\begin{align}
  \xi^2 \equiv \f{N}{\abs{\bk{\v S}}^2}
  \min_{\uv n\perp\bk{\v S}} \bk{\p{\v S\c\uv n}^2},
  \label{eq:squeezing}
\end{align}
where $N$ is the total number of spins, $\v S$ is the collective spin
vector, and the minimization is performed over all unit vectors
$\uv n$ in the plane orthogonal to the mean spin vector $\bk{\v S}$.
This squeezing parameter is entirely determined by components
$\bk{S_\alpha}$ of the mean spin vector in addition to collective
spin-spin correlators of the form $\bk{S_\alpha S_\beta}$; our task is
therefore to compute these expectation values in all scenarios of
interest.


\section{One-axis twisting}

The case of the one-axis twisting is simplest to consider, as we can
write the Hamiltonian in the form
\begin{align}
  H_{\t{OAT}} = \f14 \chi \sum_{j,k} \sigma_j^z \sigma_k^z
  = \f12 \chi \sum_{j<k} \sigma_j^z \sigma_k^z + \f14 N \chi,
\end{align}
which admits an exact solution previously worked out by Foss-Feig et
al.~in ref.~\cite{foss-feig2013nonequilibrium}.  Adapting exact
expectation values with respect to the initial state $\ket{X}$
satisfying $S_x\ket{X}=S\ket{X}$, in terms of $\mu,\nu\in\set{+1,-1}$
we find that
\begin{align}
  \bk{S_+}
  &= \sum_j\bk{\sigma_j^+}
  = \f{N}{2} e^{-\gamma t/2} \Phi\p{\chi,t}^{N-1}, \label{eq:S+_OAT} \\
  \bk{S_\mu S_z}
  &= \f12\sum_j\bk{\sigma_j^\mu\sigma_j^z}
  + \f12\sum_{j\ne k} \bk{\sigma_j^\mu \sigma_k^z} \\
  &= -\f{\mu}{2}\bk{S_\mu} + \f14 N \p{N-1} e^{-\gamma t/2}
  \Psi\p{\mu\chi,t} \Phi\p{\chi,t}^{N-2}, \\
  \bk{S_\mu S_\nu}
  &= \sum_j \bk{\sigma_j^\mu \sigma_j^\nu}
  + \sum_{j\ne k} \bk{\sigma_j^\mu \sigma_k^\nu} \\
  &= \delta_{\mu,-\nu} \p{\f{N}{2} + \mu \bk{S_z}}
  + \f14 N \p{N-1} e^{-\gamma t}
  \Phi\p{\sp{\mu+\nu}\chi,t}^{N-2}, \label{eq:SS+-_OAT}
\end{align}
where
\begin{align}
  \Phi\p{\xi,t} \equiv e^{-\gamma t/2}
  \sp{\cos\p{s_\xi t}+\f12\gamma t~\t{sinc}\p{s_\xi t}},
  &&
  \Psi\p{\xi,t} \equiv e^{-\gamma t/2}
  \p{is_\xi-\gamma/2}t~ \t{sinc}\p{s_\xi t},
\end{align}
and $s_\xi \equiv \xi + i2\gamma$.  The last ingredients we need
to compute spin squeezing at any time are $\bk{S_z}$ and $\bk{S_z^2}$.
As these operators commute with the OAT Hamiltonian, their evolution
is governed entirely by decoherence, such that
\begin{align}
  \f{d}{dt}\p{S_z^n}
  = \gamma \D_-\p{S_z^n}
  = \gamma \p{S + S_z} \sum_{k=0}^{n-1}
  \p{-1}^{n-k} { n \choose k } S_z^k,
\end{align}
where $S\equiv N/2$ throughout this work and $\D_-\p{S_z^n}$ is worked
out in Appendix \ref{sec:decoherence}.  In particular,
\begin{align}
  \f{d}{dt} S_z = -\gamma \p{S + S_z},
  &&
  \f{d}{dt}\p{S_z^2} = \gamma \p{S + S_z} \p{1 - 2S_z}.
\end{align}
The initial conditions $\bk{S_z}_{t=0}=0$ and $\bk{S_z^2}_{t=0}=S/2$
then imply
\begin{align}
  \bk{S_z} = S\p{e^{-\gamma t}-1},
  &&
  \bk{S_z^2} = S \p{1 - \f12 e^{-\gamma t}} e^{-\gamma t} + \bk{S_z}^2.
  \label{eq:Sz_OAT}
\end{align}
The expectation values in \eqref{eq:S+_OAT}-\eqref{eq:SS+-_OAT} and
\eqref{eq:Sz_OAT} are sufficient to compute the squeezing parameter
$\xi^2$ in \eqref{eq:squeezing} at any time throughout evolution of
the initial state $\ket{X}:S_x\ket{X}=S\ket{X}$ under $H_{\t{OAT}}$.


\section{Cumulant expansion and systems of equations for Heisenberg
  operators}

Unlike the one-axis twisting Hamiltonian, the two-axis twisting and
transverse-field Hamiltonians do not admit exact analytical
solutions. We will therefore solve these Hamiltonians approximately
using systems of equations for Heisenberg operators.  The basic idea
is to find equations of motion for operators of interest, and at some
point truncate high-order terms with negligible contribution to the
spin correlators of interest.  To benchmark this method, we test it
against exact one-axis twisting results in the presence of
decoherence, as well as transverse-field and two-axis twisting in the
absence of decoherence.

All collective spin Hamiltonians can be written in the form
\begin{align}
  H = \sum_{p,q,r} h_{pqr} S_+^p S_z^q S_-^r,
  \label{eq:H_general}
\end{align}
where Hermiticity requires that $h_{pqr}=h_{rqp}$.  The Hamiltonians
for one-axis twisting with a transverse field, for example, is
\begin{align}
  H_{\t{TVF}}
  = \chi S_z^2 + \Omega S_x
  = \chi S_z^2 + \f{\Omega}{2} S_+ + \f{\Omega}{2} S_-,
\end{align}
while the two-axis twisting Hamiltonians about $\p{z,y}$ and $\p{y,x}$
are
\begin{align}
  H_{\t{TAT}}^{z,y}
  = \chi \p{S_z^2 - S_y^2}
  = \chi \p{S_z^2 + \f14 S_+^2 + \f14 S_-^2 - \f12 S_+ S_- + \f12 S_z},
\end{align}
and
\begin{align}
  H_{\t{TAT}}^{y,x}
  = \chi\p{S_y^2 - S_x^2}
  = -\f{\chi}{2} \p{S_+^2 + S_-^2}.
\end{align}
The evolution of a general operator $S_+^\ell S_-^m S_z^n$ under a
Hamiltonian of the form in \eqref{eq:H_general} is given by
\begin{align}
  \f{d}{dt} \p{S_+^\ell S_z^m S_-^n}
  = i\sum_{p,q,r} h_{pqr} \sp{S_+^p S_z^q S_-^r, S_+^\ell S_z^m S_-^n}_-
  + \gamma \D_-\p{S_+^\ell S_z^m S_-^n}
  \equiv \sum_{p,q,r} T^{\ell m n}_{pqr} S_+^p S_z^q S_-^r,
  \label{eq:time_derivative}
\end{align}
where commutator and decoherence operator necessary for computing the
matrix elements $T^{\ell m n}_{pqr}$ of the time derivative operator
$d/dt$ are respectively worked out in Appendix \ref{sec:comm_general}
and \ref{sec:decoherence}.

The time derivative operator $d/dt$ will generally couple spin
operators $S_+^\ell S_z^m S_-^n$ to spin operators $S_+^p S_z^q S_-^r$
with higher weight, i.e.~with $p+q+r>\ell+m+n$.  In practice, keeping
track of this operator growth will eventually require more
computational resources than are available, so we must truncate it at
some point by taking
\begin{align}
  \f{d}{dt} \p{S_+^\ell S_z^m S_-^n}
  = \sum_{p,q,r} T^{\ell m n}_{pqr} S_+^p S_z^q S_-^r
  \to \sum_{w\p{p,q,r}<W} T^{\ell m n}_{pqr} S_+^p S_z^q S_-^r
  \label{eq:time_derivative_truncation}
\end{align}
for some cutoff $W$ and weight function $w$, e.g.~$w\p{p,q,r}=p+q+r$,
although the most optimal weight function will generally be
system-dependent.  The truncation in
\eqref{eq:time_derivative_truncation} will close the system of
differential equations defined by \eqref{eq:time_derivative}, and
allow us to solve it using standard numerical methods.  The
expectation values of collective spin operators for initial conditions
of interest are provided in Appendix \ref{sec:initial_conditions}.

Alternately, we can formally solve the differential equation in
\eqref{eq:time_derivative} and write
\begin{align}
  S_+^\ell S_z^m S_-^n
  = \left.\exp\p{t \f{d}{dt}}\right|_{t=0} \p{S_+^\ell S_z^m S_-^n}
  = \sum_{k\ge0} \f{t^k}{k!}
  \left.\f{d^k}{dt^k}\right|_{t=0} \p{S_+^\ell S_z^m S_-^n},
\end{align}
which implies
\begin{align}
  \bk{S_+^\ell S_z^m S_-^n}
  = \sum_{k\ge0} \f{t^k}{k!}
  \sum_{p,q,r} T^{\ell m n}_{pqr;k} \bk{S_+^p S_z^q S_-^r}_{t=0},
  \label{eq:time_series}
\end{align}
where the matrix elements of the $k$-th time derivative are given by
\begin{align}
  T^{\ell m n}_{pqr;0}=\delta_{\ell p}\delta_{mq}\delta_{nr},
  &&
  T^{\ell m n}_{pqr;1}\equiv T^{\ell m n}_{pqr},
\end{align}
\begin{align}
  T^{\ell mn}_{pqr;k>1}
  \equiv \sum_{\v\lambda,\v\mu,\v\nu}
  T^{\ell mn}_{\lambda_1 \mu_1 \nu_1}
  T^{\lambda_1 \mu_1 \nu_1}_{\lambda_2 \mu_2 \nu_2}
  T^{\lambda_2 \mu_2 \nu_2}_{\lambda_3 \mu_3 \nu_3}
  \cdots T^{\lambda_{k-1} \mu_{k-1} \nu_{k-1}}_{pqr}.
\end{align}
Instead of explicitly choosing a weight function that determines which
operators to keep track of, we can now truncate the series in
\eqref{eq:time_series} by taking
\begin{align}
  \bk{S_+^\ell S_z^m S_-^n}
  = \sum_{k\ge0} \f{t^k}{k!}
  \sum_{p,q,r} T^{\ell m n}_{pqr;k} \bk{S_+^p S_z^q S_-^r}_{t=0}
  \to \sum_{k<M} \f{t^k}{k!}
  \sum_{p,q,r} T^{\ell m n}_{pqr;k} \bk{S_+^p S_z^q S_-^r}_{t=0}.
\end{align}
Examining the nonzero entries of $T^{\ell mn}_{pqr;k}$ for
$k=1,2,\cdots,M-1$ now {\it tells} us which operators we need to keep
track of in order to compute the expectation value
$\bk{S_+^\ell S_z^m S_-^n}$.  Furthermore, after computing the
expectation values of all relevant operators at $t=0$, time evolution
of $\bk{S_+^\ell S_z^m S_-^n}$ takes only $\O\p{M}$ CPU time.

As a final comment, we note that the relation
$\p{S_+^\ell S_z^m S_-^n}^\dag=S_+^n S_z^m S_-^\ell$ can be exploited
to cut the number of operators we need to keep track of roughly in
two.


\bibliography{\jobname}

\newpage
\appendix

\section{Basic spin operator identities}
\label{sec:identities}

This text makes ubiquitous use of various spin operator identities; we
collect and derive particularly useful identities here for reference.
The elementary commutation relations between single-weight spin
operators are, with $\bmu\equiv-\mu\in\set{+1,-1}$ for brevity,
\begin{align}
  \f12 \sp{\sigma_j^z,\sigma_k^\mu}_-
  &= \delta_{jk} \mu \sigma_j^\mu,
  &
  \sp{S_z,\sigma_j^\mu}_-
  &= \f12 \sp{\sigma_j^z,S_\mu}_- = \mu \sigma_j^\mu,
  &
  \sp{S_z,S_\mu}_-
  &= \mu S_\mu,
  \label{eq:comm_z_base} \\
  \sp{\sigma_j^\mu,\sigma_k^\bmu}_-
  &= \delta_{jk} \mu \sigma_j^z,
  &
  \sp{S_\mu,\sigma_j^\bmu}_-
  &= \sp{\sigma_j^\mu,S_\bmu}_- = \mu \sigma_j^z,
  &
  \sp{S_\mu,S_\bmu}_-
  &= 2 \mu S_z.
  \label{eq:comm_mu_base}
\end{align}
These relations can be used to inductively compute identities
involving powers of collective spin operators.  Working through the
possibilities, we find
\begin{align}
  S_z^m \sigma_j^\mu
  = S_z^{m-1} \sigma_j^\mu \p{\mu + S_z}
  = S_z^{m-2} \sigma_j^\mu \p{\mu + S_z}^2
  = \cdots
  = \sigma_j^\mu \p{\mu + S_z}^m,
  \label{eq:push_z_mu_Ss}
\end{align}
and
\begin{align}
  \sigma_j^z S_\mu^m
  = \p{2\mu\sigma_j^\mu + S_\mu \sigma_j^z} S_\mu^{m-1}
  = 2\mu\sigma_j^\mu S_\mu^{m-1} + S_\mu \sigma_j^z S_\mu^{m-1}
  = \cdots
  = 2\mu m\sigma_j^\mu S_\mu^{m-1} + S_\mu^m \sigma_j^z.
  \label{eq:push_z_mu_sS}
\end{align}
Summing over the single-spin index $j$ in both of these cases gives us
the purely collective-spin versions of these identities:
\begin{align}
  S_z^m S_\mu = S_\mu \p{\mu + S_z}^m,
  &&
  S_z S_\mu^m = S_\mu^m \p{\mu m + S_z},
  \label{eq:push_z_mu_single}
\end{align}
where we can repeat the process of pushing through individual
operators $\ell$ times to get
\begin{align}
  S_z^\ell S_\mu^m
  = S_z^{\ell-1} S_\mu^m \p{\mu m + S_z}
  = S_z^{\ell-2} S_\mu^m \p{\mu m + S_z}^2
  = \cdots
  = S_\mu^m \p{\mu m + S_z}^\ell.
  \label{eq:push_z_mu}
\end{align}
Similarly finding commutation relations between powers of transverse
spin operators, i.e.~$S_\mu$, turns out to be considerably more
difficult than the cases we have worked out thus far.  We therefore
save this work for Appendix \ref{sec:comm_transverse}.


\section{Commutator between powers of two transverse spin operators}
\label{sec:comm_transverse}

To find commutation relations between powers of transverse collective
spin operators, we compute (with $\bmu\equiv-\mu\in\set{+1,-1}$)
\begin{align}
  S_\mu^m \sigma_j^\bmu
  &= S_\mu^{m-1}\sigma_j^\bmu S_\mu + \mu S_\mu^{m-1} \sigma_j^z \\
  &= S_\mu^{m-2} \sigma_j^\bmu S_\mu^2 + \mu S_\mu^{m-2} \sigma_j^z S_\mu
  + \mu S_\mu^{m-1} \sigma_j^z \\
  &= \sigma_j^\bmu S_\mu^m
  + \mu \sum_{k=0}^{m-1} S_\mu^k \sigma_j^z S_\mu^{m-k-1}
  \label{eq:push_mu_Ss_start}.
\end{align}
While \eqref{eq:push_mu_Ss_start} gives us the commutator
$\sp{S_\mu^m,\sigma_j^\bmu}_-$, we would like to enforce an ordering
on products of spin operators, which will allow us to only keep track
of operators that are linearly independent.  We choose to impose an
ordering with all $\sigma_j^\bmu$ operators on the left, and all
$\sigma_j^z$ operators on the right, as such an ordering will prove
convenient for the calculations in this section.  This choice of
ordering compels us to expand
\begin{align}
  \mu \sum_{k=0}^{m-1} S_\mu^k \sigma_j^z S_\mu^{m-k-1}
  &= \mu \sum_{k=0}^{mq-1} S_\mu^k
  \p{2\mu\sp{m-k-1} \sigma_j^\mu S_\mu^{m-k-2}
    + S_\mu^{m-k-1} \sigma_j^z} \\
  &= m \p{m-1} \sigma_j^\mu S_\mu^{m-2} + \mu m S_\mu^{m-1} \sigma_j^z,
\end{align}
which implies
\begin{align}
  S_\mu^m \sigma_j^\bmu
  = \sigma_j^\bmu S_\mu^m + m \p{m-1} \sigma_j^\mu S_\mu^{m-2}
  + \mu m S_\mu^{m-1} \sigma_j^z,
  \label{eq:push_mu_Ss}
\end{align}
and in turn
\begin{align}
  S_\mu^m S_\bmu = S_\bmu S_\mu^m
  + m S_\mu^{m-1} \p{m - 1 + 2\mu S_z}.
  \label{eq:push_mu_single}
\end{align}
As the next logical step, we take on the task of computing
\begin{align}
  S_\mu^m S_\bmu^n
  &= S_\mu^{m-1} S_\bmu^n S_\mu
  + n \sp{S_\mu^{m-1} S_\bmu^{n-1} \p{1 - n + 2\mu S_z}} \\
  &= S_\bmu^n S_\mu^m
  + n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_z} S_\mu^k,
\end{align}
which implies
\begin{align}
  \sp{S_\mu^m, S_\bmu^n}_-
  = C_{mn;\mu}
  \equiv n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_z} S_\mu^k.
\end{align}
We now need rearrange the operators in $C_{mn;\mu}$ into a standard
order, which means pushing all $S_z$ operators to the right and, for
the purposes of this calculation, all $S_\bmu$ operators on the left.
We begin by pushing $S_\mu^k$ to the left of $S_z$, which takes
$2\mu S_z\to 2\mu S_z+2k$, and then push $S_\mu^{m-k-1}$ to the right
of $S_\bmu^{n-1}$, giving us
\begin{align}
  C_{mn;\mu}
  &= n \sum_{k=0}^{m-1}
  \p{S_\bmu^{n-1} S_\mu^{m-k-1} + C_{m-k-1,n-1;\mu}} S_\mu^k
  \p{2k + 1 - n + 2\mu S_z} \\
  &= D_{mn;\mu}
  + n \sum_{k=0}^{m-2} C_{m-k-1,n-1;\mu}
  S_\mu^k \p{2k + 1 - n + 2\mu S_z},
  \label{eq:C_mn}
\end{align}
where we have dropped the last term in the final sum because
$C_{m-k-1,n-1;\mu}=0$ if $k=m-1$, and
\begin{align}
  D_{mn;\mu}
  \equiv mn S_\bmu^{n-1} S_\mu^{m-1} \p{m - n + 2\mu S_z}.
  \label{eq:D_mn}
\end{align}
To our despair, we have arrived in \eqref{eq:C_mn} to a recursive
formula for $C_{mn;\mu}$.  Furthermore, we have not even managed to
order the spin operators, as $C_{m-k-1,n-1;\mu}$ contains $S_z$
operators which are to the left of $S_\mu^k$.  To sort all spin
operators once and for all, we define
\begin{align}
  C_{mn;\mu}^{(k)} \equiv C_{m-k,n;\mu} S_\mu^k,
  &&
  D_{mn;\mu}^{(k)} \equiv D_{m-k,n;\mu} S_\mu^k,
\end{align}
which we can expand as
\begin{align}
  D_{mn;\mu}^{(k)}
  &\equiv D_{m-k,n;\mu}S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-k-1}
  \p{m-k-n+2\mu S_z} S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-1} \p{k+m-n+2\mu S_z},
  \label{eq:D_mn_k}
\end{align}
and
\begin{align}
  C_{mn;\mu}^{(k)}
  &= D_{m-k,n;\mu} S_\mu^k + n \sum_{j=0}^{m-k-2}
  C_{m-k-j-1,n-1;\mu} S_\mu^j \p{2j+1-n+2\mu S_z} S_\mu^k \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{m-k-j-1,n-1;\mu} S_\mu^{j+k} \p{2j+2k+1-n+2\mu S_z} \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{m-1,n-1;\mu}^{(k+j)} \p{2\sp{j+k}+1-n+2\mu S_z} \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=k}^{m-2}
  C_{m-1,n-1;\mu}^{(j)} \p{2j+1-n+2\mu S_z}.
  \label{eq:C_mn_k}
\end{align}
While the resulting expression in \eqref{eq:C_mn_k} strongly resembles
that in \eqref{eq:C_mn}, there is one crucial difference: all spin
operators in \eqref{eq:C_mn_k} have been sorted into a standard order.
We can now repeatedly substitute $C_{mn;\mu}^{(k)}$ into itself, each
time decreasing $m$ and $n$ by 1, until one of $m$ or $n$ reaches
zero.  Such repeated substitution yields the expansion
\begin{align}
  C_{mn;\mu}
  = C_{mn;\mu}^{(0)}
  = D_{mn;\mu}
  + \sum_{p=1}^{\min\set{m,n}-1} E_{mn;\mu}^{(p)},
  \label{eq:C_mn_E}
\end{align}
where the first two terms in the sum over $p$ are
\begin{align}
  E_{mn;\mu}^{(1)}
  &= n \sum_{k=0}^{m-2} D_{m-1,n-1;\mu}^{(k)}
  \p{2k+1-n+2\mu S_z}, \\
  E_{mn;\mu}^{(2)}
  &= n \sum_{k_1=0}^{m-2} \p{n-1} \sum_{k_2=k_1}^{m-3}
  D_{m-2,n-2;\mu}^{(k_2)}
  \p{2k_2+2-n+2\mu S_z} \p{2k_1+1-n+2\mu S_z},
\end{align}
and more generally for $p>1$,
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{k_1=0}^{m-2} \sum_{k_2=k_1}^{m-3} \cdots\sum_{k_p=k_{p-1}}^{m-p-1}
  D_{m-p,n-p;\mu}^{(k_p)} \prod_{j=1}^p \p{2k_j+j-n+2\mu S_z}.
  \label{eq:E_mn_p}
\end{align}
In principle, the expressions in \eqref{eq:D_mn} and
\eqref{eq:C_mn_E}-\eqref{eq:E_mn_p} can be used to evaluate the
commutator $\sp{S_\mu^m,S_\bmu^n}_- = C_{mn;\mu}$, but these result
are -- to put it lightly -- quite a mess: the expression for
$E_{mn;\mu}^{(p)}$ in \eqref{eq:E_mn_p} involves a sum over $p$
mutually dependent intermediate variables!  We therefore devote the
rest of this section to simplifying our result for the commutator
$\sp{S_\mu^m,S_\bmu^n}_-$.

Observing that we always have
$0\le k_1\le k_2\le\cdots\le k_p\le m-p-1$ in \eqref{eq:E_mn_p}, we
can rearrange the order of the sums and relabel $k_p\to\ell$ to get
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{\ell=0}^{m-p-1} D_{m-p,n-p;\mu}^{(\ell)} \p{2\ell+F_{np;\mu}}
  \sum_{\p{\v k,p,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}},
  \label{eq:E_mn_p_sum}
\end{align}
where for shorthand we define
\begin{align}
  F_{np;\mu} \equiv p - n + 2\mu S_z,
  &&
  \sum_{\p{\v k,p,\ell}} X \equiv
  \sum_{k_1=0}^\ell \sum_{k_2=k_1}^\ell
  \cdots \sum_{k_{p-1}=k_{p-2}}^\ell X.
\end{align}
We now define
\begin{align}
  f_{np\ell;\mu}\p{k,q} \equiv \p{\ell-k+q} \p{\ell+k-q+F_{np;\mu}},
\end{align}
and evaluate sums successively over $k_{p-1},k_{p-2},\cdots,k_1$,
finding
\begin{align}
  \sum_{\p{\v k,p,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  &= \sum_{\p{\v k,p-1,\ell}}
  \prod_{j=2}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  f_{np\ell;\mu}\p{k_{p-2},1} \\
  &= \f1{r!} \sum_{\p{\v k,p-r,\ell}}
  \prod_{j=1+r}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  \prod_{q=1}^r f_{np\ell;\mu}\p{k_{p-1-r},q} \\
  &= \f1{\p{p-1}!} \prod_{q=1}^{p-1} f_{np\ell;\mu}\p{0,q} \\
  &= { \ell + p - 1 \choose p - 1 }
  \prod_{q=1}^{p-1} \p{\ell-q+F_{np;\mu}}.
\end{align}
Substitution of this result together with $D_{m-p,n-p;\mu}^{(\ell)}$
with \eqref{eq:D_mn_k} into \eqref{eq:E_mn_p_sum} then gives us
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p-1}!} S_\bmu^{n-p-1} S_\mu^{m-p-1} G_{mnp;\mu}
\end{align}
with
\begin{align}
  G_{mnp;\mu}
  &\equiv \sum_{\ell=0}^{m-p-1} { \ell + p - 1 \choose p - 1 }
  \p{m-p-\ell} \p{\ell+m-p+F_{np;\mu}}
  \p{2\ell + F_{np;\mu}}
  \prod_{q=1}^{p-1} \p{\ell-q+F_{np;\mu}} \\
  &= { m \choose p + 1 } \prod_{q=0}^p \p{m-p-q+F_{np;\mu}}.
\end{align}
We can further expand
\begin{align}
  \prod_{q=0}^p \p{m-p-q+F_{np;\mu}}
  = \prod_{q=0}^p \p{m-n-q+2\mu S_z}
  = \sum_{q=0}^{p+1} \p{-1}^{p+1-q} { p+1 \brack q } \p{m-n+2\mu S_z}^q,
\end{align}
where ${ n \brack k }$ is an unsigned Stirling number of the first
kind, and finally
\begin{align}
  \sum_{q=0}^p \p{-1}^{p-q} { p \brack q } \p{m-n+2\mu S_z}^q
  &= \sum_{q=0}^p \p{-1}^{p-q} { p \brack q } \sum_{\ell=0}^q
  { q \choose \ell } \p{m-n}^{q-\ell} \p{2\mu S_z}^\ell \\
  &= \sum_{\ell=0}^p \p{2\mu}^\ell \sum_{q=\ell}^p \p{-1}^{p-q}
  { p \brack q } { q \choose \ell } \p{m-n}^{q-\ell} S_z^\ell.
\end{align}
Putting everything together, we finally have
\begin{align}
  E_{mn;\mu}^{(p-1)}
  = p! { m \choose p } { n \choose p }
  S_\bmu^{n-p} S_\mu^{m-p} \sum_{\ell=0}^p
  \mu^\ell \epsilon_{mnp}^{(\ell)} S_z^\ell,
\end{align}
with
\begin{align}
  \epsilon_{mnp}^{(\ell)}
  \equiv 2^\ell \sum_{q=\ell}^p \p{-1}^{p-q}
  { p \brack q } { q \choose \ell } \p{m-n}^{q-\ell},
  \label{eq:eps_mnp}
\end{align}
where in this final form $E_{mn;\mu}^{(0)} = D_{mn;\mu}$, which
together with the expansion for $C_{mn;\mu}$ in \eqref{eq:C_mn_E}
implies that
\begin{align}
  \sp{S_\mu^m, S_\bmu^n}_-
  = \sum_{p=1}^{\min\set{m,n}}
  p! { m \choose p } { n \choose p } S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \mu^\ell \epsilon_{mnp}^{(\ell)} S_z^\ell,
  \label{eq:comm_mu}
\end{align}
and
\begin{align}
  S_\mu^m S_\bmu^n
  = \sum_{p=0}^{\min\set{m,n}}
  p! { m \choose p } { n \choose p } S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \mu^\ell \epsilon_{mnp}^{(\ell)} S_z^\ell,
  \label{eq:push_mu_nu}
\end{align}
If we wish to order collective spin operators with $S_z$ in between
$S_\bmu$ and $S_\mu$, then we find
\begin{align}
  S_\mu^m S_\bmu^n
  = \sum_{p=0}^{\min\set{m,n}} p! { m \choose p } { n \choose p }
  S_\bmu^{n-p} Z_{mn;\mu}^{(p)} S_\mu^{m-p},
\end{align}
where
\begin{align}
  Z_{mn;\mu}^{(p)}
  \equiv \sum_{\ell=0}^p \mu^\ell \epsilon_{mnp}^{(\ell)}
  \p{-\mu\sp{m-p} + S_z}^\ell
  = \sum_{q=0}^p \mu^q \xi_{mnp}^{(q)} S_z^q,
  \label{eq:Z_mn}
\end{align}
with
\begin{align}
  \xi_{mnp}^{(q)}
  \equiv \sum_{\ell=q}^p \p{-1}^{\ell-q}
  \epsilon_{mnp}^{(\ell)} { \ell \choose q } \p{m-p}^{\ell-q}
  \label{eq:xi_mnp}
\end{align}
in terms of $\epsilon_{mnp}^{(\ell)}$ as defined in
\eqref{eq:eps_mnp}.


\section{Commutator between general ordered collective spin operators}
\label{sec:comm_general}

If all collective spin operators are written in the form
$S_\mu^\ell S_z^m S_\bmu^n$ for $\bmu\equiv-\mu$, then the most
general commutator we need to consider is
\begin{align}
  \sp{S_\mu^p S_z^a S_\bmu^q, S_\mu^r S_z^b S_\bmu^s}_-
  = \S^{paq}_{rbs;\mu} - \S^{rbs}_{paq;\mu},
\end{align}
where
\begin{align}
  \S^{paq}_{rbs;\mu}
  \equiv S_\mu^p S_z^a S_\bmu^q S_\mu^r S_z^b S_\bmu^s
  = \sum_{k=0}^{\min\set{q,r}} k! { q \choose k } { r \choose k }
  S_\mu^{p+r-k} \tilde Z_{qrab;\bmu}^{(k)} S_\bmu^{q+s-k},
\end{align}
and, in terms of $\xi_{qrk}^{(\ell)}$ as defined in \eqref{eq:xi_mnp},
\begin{align}
  \tilde Z_{qrab;\mu}^{(k)}
  &\equiv \p{\mu\sp{r-k}+S_z}^a
  Z_{qr;\bmu}^{(k)} \p{\mu\sp{q-k}+S_z}^b \\
  &= \sum_{\ell=0}^k \p{-1}^\ell \xi_{qrk}^{(\ell)}
  \sum_{m=0}^a \p{r-k}^{a-m} { a \choose m }
  \sum_{n=0}^b \p{q-k}^{b-n} { b \choose n }
  \mu^{a+b+\ell-m-n} S_z^{\ell+m+n}.
\end{align}


\section{Decoherence of collective spin operators from uncorrelated
  spin decay}
\label{sec:decoherence}

The decoherence operator for uncorrelated decay ($\mu=-1$) or
excitation ($\mu=1$) of individual spins is, with $\bmu\equiv-\mu$,
\begin{align}
  \D_\mu\p{\O}
  \equiv \sum_j\p{\sigma_j^\bmu \O \sigma_j^\mu
    - \f12\sp{\sigma_j^\bmu \sigma_j^\mu,\O}_+},
\end{align}
where
\begin{align}
  -\f12 \sp{\sigma_j^\bmu \sigma_j^\mu,\O}_+
  = -\f12\sp{\p{S-\mu S_z}, \O}_+
  = -S\O + \f{\mu}{2} \sp{S_z, \O}_+,
\end{align}
so
\begin{align}
  \D_\mu\p{\O}
  = \sum_j\sigma_j^\bmu \O \sigma_j^\mu
    - S \O + \f{\mu}{2} \sp{S_z, \O}_+.
  \label{eq:D_mu}
\end{align}


\subsection{The simple case}

If we consider only symmetrically ordered collective spin operators,
there are two cases to work out: the effect of decoherence through
$\D_\mu$ on $S_\mu^\ell S_z^m S_\bmu^n$, and the effect on
$S_\bmu^\ell S_z^m S_\mu^n$.  We work out the latter case first,
namely
\begin{align}
  \D_\mu\p{S_\bmu^\ell S_z^m S_\mu^n}
  = \sum_j\sigma_j^\bmu S_\bmu^\ell S_z^m S_\mu^n \sigma_j^\mu
  - S S_\bmu^\ell S_z^m S_\mu^n
  + \f{\mu}{2} \sp{S_z, S_\bmu^\ell S_z^m S_\mu^n}_+.
\end{align}
To simplify the first term, we use \eqref{eq:comm_z_base} to push the
jump operators together, finding
\begin{align}
  \sum_j \sigma_j^\bmu S_\bmu^\ell S_z^m S_\mu^n \sigma_j^\mu
  = S_\bmu^\ell \sum_j \sigma_j^\bmu \sigma_j^\mu \p{\mu+S_z}^m S_\mu^n
  = S_\bmu^\ell \p{S+S_z} \p{\mu+S_z}^m S_\mu^n.
\end{align}
We can likewise push $S_z$ operators together using
\eqref{eq:push_z_mu_single} to expand
\begin{align}
  \sp{S_z, S_\bmu^\ell S_z^m S_\mu^n}_+
  = S_z S_\bmu^\ell S_z^m S_\mu^n + S_\bmu^\ell S_z^m S_\mu^n S_z
  = S_\bmu^\ell\p{\bmu\ell - \mu n + 2 S_z} S_z^m S_\mu^n,
\end{align}
which implies
\begin{align}
  \f{\mu}{2} \sp{S_z, S_\bmu^\ell S_z^m S_\mu^n}_+
  = S_\bmu^\ell\p{-\f12\sp{\ell+n} + \mu S_z} S_z^m S_\mu^n,
\end{align}
and in turn
\begin{align}
  \D_\mu\p{S_\bmu^\ell S_z^m S_\mu^n}
  &= S_\bmu^\ell \sp{\p{S+S_z} \p{\mu+S_z}^m
    - \p{S + \f12\sp{\ell+n} + S_z} S_z^m} S_\mu^n \\
  &= S_\bmu^\ell
  \sp{\p{S+S_z} \sum_{k=0}^{m-1} \mu^{m-k} { m \choose k} S_z^k
  - \f12\p{\ell+n} S_z^m} S_\mu^n.
\end{align}
Decoherence through $\D_\mu$ only couples operators of the form
$S_\bmu^\ell S_z^m S_\mu^n$ to operators of the (almost identical)
form $S_\bmu^\ell S_z^{m'} S_\mu^n$ with $m'\le m$.


\subsection{The harder case}

The second case to consider for the decoherence of general ordered
collective spin operators is
\begin{align}
  \D_\mu\p{S_\mu^\ell S_z^m S_\bmu^n}
  = \sum_j\sigma_j^\bmu S_\mu^\ell S_z^m S_\bmu^n \sigma_j^\mu
  - S S_\mu^\ell S_z^m S_\bmu^n
  + \f{\mu}{2} \sp{S_z, S_\mu^\ell S_z^m S_\bmu^n}_+.
  \label{eq:D_mu_mu}
\end{align}
The difficulty now is with the first term in \eqref{eq:D_mu_mu}, as
$\sigma_j^\bmu$ and $S_\mu$ do not commute.


\section{Initial conditions}
\label{sec:initial_conditions}

Initial conditions for all collective spin operators can be determined
from the expansions
\begin{align}
  S_z^n = \sum_{k=-S}^S k^n \op{k},
  &&
  S_\mu
  = \sum_{k=-S+\delta_{\mu,-1}}^{S-\delta_{k,1}}
  g_\mu\p{k} \op{k+\mu}{k},
\end{align}
with
\begin{align}
  g_\mu\p{S,k} \equiv \sqrt{\p{S-\mu k}\p{S+\mu k+1}},
\end{align}
and the initial states
\begin{align}
  \ket{\pm Z} \equiv \ket{\pm S},
  &&
  \ket{X} \equiv 2^{-N/2} \sum_{k=-S}^S { N \choose S+k }^{1/2} \ket{k},
\end{align}
using which we can compute
\begin{align}
  \bk{\pm Z|S_+^\ell S_z^m S_-^n|\pm Z}
  = \delta_{\ell,0} \delta_{m,0} \p{\pm S}^m,
\end{align}
and
\begin{align}
  \bk{X|S_+^\ell S_z^m S_-^n|X}
  &=  2^{-N} \sum_{k=-S}^{S-\max\set{\ell,n}} k^m
  \sp{{ N \choose S+k+\ell } { N \choose S+k+n }}^{1/2} \tag*{} \\
  &\qquad\qquad\qquad\qquad
  \times \prod_{p=0}^{\ell-1} g_+\p{S,k+p}
  \prod_{q=0}^{n-1} g_-\p{S,k+n-q} \\
  &= \f{N!}{2^N} \sum_{k=-S}^{S-\max\set{\ell,n}} k^m
  \f{\p{S-k}!}{\p{S+k}!\p{S-k-\ell}!\p{S-k-n}!}.
\end{align}
With the help of Mathematica, we can write the sum in the alternate
form
\begin{align}
  \bk{X|S_+^\ell S_z^m S_-^n|X}
  = \f{\p{N!}^2}{2^N\p{N-\ell}!\p{N-n}!}
  \sp{\p{-S}^m \alpha + \f{\p{N-\ell}\p{N-n}}{N} \beta},
\end{align}
where $\alpha$ and $\beta$ are defined in terms of the generalized
hypergeometric function $\F$ by
\begin{align}
  \alpha
  \equiv \F\p{\let\scriptstyle\textstyle
    \substack{\ell-N,~n-N\\-N}~; -1},
\end{align}
and
\begin{align}
  \beta
  \equiv \sum_{p=0}^{m-1} \p{-S}^p { m \choose p }
  \tilde\F_{m-p-1}\p{\let\scriptstyle\textstyle
    \substack{1+\ell-N,~1+n-N\\1-N}~; -1},
\end{align}
for
\begin{align}
  \tilde\F_q\p{\let\scriptstyle\textstyle
    \substack{a,~b\\c}~; z}
  \equiv \F\p{\let\scriptstyle\textstyle
    \substack{2,2,\cdots,2,a,b\\1,1,\cdots,1,c}~; z}
\end{align}
with $q$ repetitions of 2 and 1.

\end{document}

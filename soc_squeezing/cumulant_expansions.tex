\documentclass[aps,notitlepage,nofootinbib,11pt]{revtex4-1}

% linking references
\usepackage{hyperref}
\hypersetup{
  breaklinks=true,
  colorlinks=true,
  linkcolor=blue,
  filecolor=magenta,
  urlcolor=cyan,
}

%%% symbols, notations, etc.
\usepackage{physics,braket,bm,commath,amssymb} % physics and math
\renewcommand{\t}{\text} % text in math mode
\newcommand{\f}[2]{\dfrac{#1}{#2}} % shorthand for fractions
\newcommand{\p}[1]{\left(#1\right)} % parenthesis
\renewcommand{\sp}[1]{\left[#1\right]} % square parenthesis
\renewcommand{\set}[1]{\left\{#1\right\}} % curly parenthesis
\renewcommand{\v}{\bm} % bold vectors
\newcommand{\uv}[1]{\v{\hat{#1}}} % unit vectors
\renewcommand{\c}{\cdot} % inner product
\newcommand{\bk}{\Braket} % shorthand for braket notation
\renewcommand{\d}{\text{d}} % "d" for integration measure

\newcommand{\C}{\mathcal{C}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\I}{\mathcal{I}}
\newcommand{\J}{\mathcal{J}}
\renewcommand{\O}{\mathcal{O}}
\renewcommand{\S}{\mathcal{S}}

\newcommand{\N}{\mathbb{N}}

\newcommand{\z}{\text{z}}
\newcommand{\x}{\text{x}}
\newcommand{\y}{\text{y}}
\newcommand{\Z}{\text{Z}}
\newcommand{\X}{\text{X}}
\newcommand{\Y}{\text{Y}}
\newcommand{\bmu}{{\bar\mu}}
\newcommand{\bnu}{{\bar\nu}}
\newcommand{\floor}[1]{\left\lfloor{#1}\right\rfloor}

\usepackage{dsfont} % for identity operator
\newcommand{\1}{\mathds{1}}

\usepackage[inline]{enumitem} % for inline enumeration

%%% figures
\usepackage{graphicx} % for figures
\usepackage{grffile} % help latex properly identify figure extensions
\usepackage[caption=false]{subfig} % subfigures (via \subfloat[]{})
\graphicspath{{./figures/}} % set path for all figures

% for strikeout text
% normalem included to prevent underlining titles in the bibliography
\usepackage[normalem]{ulem}

% for leaving notes in the text
\newcommand{\note}[1]{\textcolor{red}{#1}}


\begin{document}

\title{Solving Collective Spin Hamiltonians with Decoherence}

\author{Michael A. Perlin}

\maketitle

\tableofcontents

\newpage

\section{Introduction}

Past work has shown how to realize spin-squeezing Hamiltonians with a
variety of ultracold atomic and trapped ion systems.  While simulating
the dynamics and squeezing behavior induced by these Hamiltonians is
straightforward in the context of a closed quantum system, here we
develop a method to simulate dynamics in the presence of decoherence.
In particular, we will consider dynamics induced by the one-axis
twisting (OAT), two-axis twisting (TAT), and transverse field (TVF)
Hamiltonians of the form
\begin{align}
  H_{\t{OAT}} = \chi S_\z^2,
  &&
  H_{\t{TAT}}^{\z,\y} = \chi \p{S_\z^2 - S_\y^2},
  &&
  H_{\t{TVF}} = \chi S_\z^2 + \Omega S_\x.
\end{align}
In order to determine the squeezing behavior of these Hamiltonians, we
will study the dynamics of Heisenburg operators $\O$, whose evolution
under a Hamiltonian $H$ is given by
\begin{align}
  \f{d}{dt} \O = i\sp{H,\O}_- + \sum_\J \gamma_\J \D\p{\J;\O},
  &&
  \D\p{\J;\O}
  \equiv \sum_{J\in\J}\p{J^\dag \O J - \f12\sp{J^\dag J,\O}_+},
  \label{eq:EOM}
\end{align}
where $\J$ is a set of jump operators with a corresponding decoherence
rate $\gamma_\J$ and $\sp{A,B}_\pm\equiv AB\pm BA$.  Our measure of
spin squeezing is
\begin{align}
  \xi^2 \equiv \f{N}{\abs{\bk{\v S}}^2}
  \min_{\uv n\perp\bk{\v S}} \bk{\p{\v S\c\uv n}^2},
  \label{eq:squeezing}
\end{align}
where $N$ is the total number of spins, $\v S$ is the collective spin
vector, and the minimization is performed over all unit vectors
$\uv n$ in the plane orthogonal to the mean spin vector $\bk{\v S}$.
This squeezing parameter is entirely determined by components
$\bk{S_\alpha}$ of the mean spin vector in addition to collective
spin-spin correlators of the form $\bk{S_\alpha S_\beta}$; our task is
therefore to compute these expectation values in all scenarios of
interest.


\section{One-axis twisting}

The case of the one-axis twisting is simplest to consider, as we can
write the Hamiltonian in the form
\begin{align}
  H_{\t{OAT}} = \f14 \chi \sum_{j,k} \sigma_\z^{(j)} \sigma_\z^{(k)}
  = \f12 \chi \sum_{j<k} \sigma_\z^{(j)} \sigma_\z^{(k)} + \f14 N \chi,
\end{align}
which admits an exact solution previously worked out by Foss-Feig et
al.~in ref.~\cite{foss-feig2013nonequilibrium}.  Adapting exact
expectation values with respect to the initial state $\ket{\X}$
satisfying $S_\x\ket{\X}=S\ket{\X}$, in terms of $S\equiv N/2$ and
$\mu,\nu\in\set{+1,-1}$ we find that
\begin{align}
  \bk{S_+}
  &= \sum_j\bk{\sigma_+^{(j)}}
  = S e^{-\Gamma t} \Phi\p{\chi,t}^{N-1}, \label{eq:S+_OAT} \\
  \bk{S_\mu S_\z}
  &= \f12\sum_j\bk{\sigma_\mu^{(j)}\sigma_\z^{(j)}}
  + \f12\sum_{j\ne k} \bk{\sigma_\mu^{(j)} \sigma_\z^{(k)}} \\
  &= -\f{\mu}{2}\bk{S_\mu} + S \p{S-\f12} e^{-\Gamma t}
  \Psi\p{\mu\chi,t} \Phi\p{\chi,t}^{N-2}, \\
  \bk{S_\mu S_\nu}
  &= \sum_j \bk{\sigma_\mu^{(j)} \sigma_\nu^{(j)}}
  + \sum_{j\ne k} \bk{\sigma_\mu^{(j)} \sigma_\nu^{(k)}} \\
  &= \delta_{\mu,-\nu} \p{S + \mu\bk{S_\z}}
  + S \p{S-\f12} e^{-2\Gamma t}
  \Phi\p{\sp{\mu+\nu}\chi,t}^{N-2}, \label{eq:SS+-_OAT}
\end{align}
where
\begin{align}
  \Phi\p{X,t}
  &\equiv e^{-\lambda t} \sp{\cos\p{t\sqrt{s_X^2-r}}
    + \lambda t~\t{sinc}\p{t\sqrt{s_X^2-r}}},
  \\
  \Psi\p{X,t}
  &\equiv e^{-\lambda t} \p{is_X-\gamma}t~
  \t{sinc}\p{t\sqrt{s_X^2-r}},
\end{align}
for
\begin{align}
  \gamma \equiv \f12 \p{\gamma_+ - \gamma_-},
  &&
  \lambda \equiv \f12 \p{\gamma_+ + \gamma_-},
  &&
  r \equiv \gamma_+ \gamma_-,
  &
  \Gamma \equiv \gamma_\z + \lambda,
  &&
  s_X \equiv X + i\gamma,
\end{align}
defined respectively in terms of spontaneous uncorrelated spin
dephasing, excitation, and decay rates $\gamma_\z$, $\gamma_+$,
$\gamma_-$.  The last ingredients we need to compute spin squeezing at
any time are $\bk{S_\z}$ and $\bk{S_\z^2}$.  As these operators
commute with the OAT Hamiltonian, their evolution is governed entirely
by decoherence (see Appendix \ref{sec:decay_single}), which means
\begin{align}
  \f{d}{dt} S_\z
  &= S\p{\gamma_+-\gamma_-} - \p{\gamma_++\gamma_-} S_\z,
  \\
  \f{d}{dt}\p{S_\z^2}
  &= S\p{\gamma_++\gamma_-} + 2\p{\gamma_+-\gamma_-}\p{S-\f12} S_\z
  - 2 \p{\gamma_++\gamma_-} S_\z^2.
\end{align}
The initial conditions $\bk{S_\z}_{t=0}=0$ and $\bk{S_\z^2}_{t=0}=S/2$
then imply
\begin{align}
  \bk{S_\z}
  = S\p{\f{\gamma_+-\gamma_-}{\gamma_++\gamma_-}}
  \p{1-e^{-\p{\gamma_+ + \gamma_-} t}},
  &&
  \bk{S_\z^2} = S \sp{\f12 + \p{S-\f12} \f{\bk{S_\z}^2}{S^2}}.
  \label{eq:Sz_OAT}
\end{align}
The expectation values in \eqref{eq:S+_OAT}-\eqref{eq:SS+-_OAT} and
\eqref{eq:Sz_OAT} are sufficient to compute the squeezing parameter
$\xi^2$ defined in \eqref{eq:squeezing} at any time throughout
evolution of the initial state $\ket{\X}:S_\x\ket{\X}=S\ket{\X}$ under
$H_{\t{OAT}}$.


\section{Truncated operator dynamics}

Unlike the one-axis twisting Hamiltonian, the two-axis twisting and
transverse-field Hamiltonians do not admit exact analytical
solutions. We will therefore solve these Hamiltonians approximately
using alternate methods.  The basic strategy will be to find equations
of motion for operators of interest, and at some point truncate
high-order terms with negligible contribution to spin correlators of
interest.  To benchmark this method, we test it against exact one-axis
twisting results in the presence of decoherence, collective
Hamiltonian dynamics in the absence of decoherence, and exact
simulations of few-spin systems.

All collective spin Hamiltonians can be written in the form
\begin{align}
  H = \sum_{\ell,m,n} h_{\ell mn} S_+^\ell S_\z^m S_-^n,
  \label{eq:H_general}
\end{align}
where Hermiticity requires that $h_{\ell mn}=h_{nm\ell}^*$.  The
Hamiltonian for one-axis twisting with a transverse field, for
example, is
\begin{align}
  H_{\t{TVF}}
  = \chi S_\z^2 + \Omega S_\x
  = \chi S_\z^2 + \f{\Omega}{2} S_+ + \f{\Omega}{2} S_-,
\end{align}
while the two-axis twisting Hamiltonians about $\p{\z,\y}$ and
$\p{\y,\x}$ are
\begin{align}
  H_{\t{TAT}}^{\z,\y}
  \propto S_\z^2 - S_\y^2
  = S_\z^2 + \f14 S_+^2 + \f14 S_-^2
  - \f12 S_+ S_- + \f12 S_\z,
\end{align}
and
\begin{align}
  H_{\t{TAT}}^{\y,\x}
  \propto S_\y^2 - S_\x^2
  = -\f12 S_+^2 - \f12 S_-^2.
\end{align}
The evolution of a general operator $S_+^\ell S_-^m S_\z^n$ under a
Hamiltonian of the form in \eqref{eq:H_general} is given by
\begin{align}
  \f{d}{dt} \p{S_+^\ell S_\z^m S_-^n}
  = i \sum_{p,q,r} h_{pqr}
  \sp{S_+^p S_\z^q S_-^r, S_+^\ell S_\z^m S_-^n}_-
  + \sum_\J \gamma_\J \D\p{\J;\O}
  \equiv \sum_{p,q,r} T^{\ell m n}_{pqr} S_+^p S_\z^q S_-^r,
  \label{eq:time_derivative}
\end{align}
where commutator and decoherence terms necessary for computing the
matrix elements $T^{\ell m n}_{pqr}$ of the time derivative operator
$d/dt$ are worked out Appendices \ref{sec:comm_general},
\ref{sec:decoherence_single}, and \ref{sec:decoherence_collective}.

The time derivative operator $d/dt$ will generally couple spin
operators $S_+^\ell S_\z^m S_-^n$ to spin operators
$S_+^p S_\z^q S_-^r$ with higher weight, i.e.~with $p+q+r>\ell+m+n$.
In practice, keeping track of this operator growth will eventually
require more computational resources than are available, so we must
truncate it at some point by taking
\begin{align}
  \f{d}{dt} \p{S_+^\ell S_\z^m S_-^n}
  = \sum_{p,q,r} T^{\ell m n}_{pqr} S_+^p S_\z^q S_-^r
  \to \sum_{w\p{p,q,r}<W} T^{\ell m n}_{pqr} S_+^p S_\z^q S_-^r
  \label{eq:time_derivative_truncation}
\end{align}
for some cutoff $W$ and weight function $w$, e.g.~$w\p{p,q,r}=p+q+r$.
The truncation in \eqref{eq:time_derivative_truncation} will close the
system of differential equations defined by
\eqref{eq:time_derivative}, and allow us to solve it using standard
numerical methods.  The initial conditions for this system of
differential equations, i.e.~expectation values of operators with
respect to states that are simple to prepare, are provided in Appendix
\ref{sec:initial_conditions}.

The truncation strategy in \eqref{eq:time_derivative_truncation} has a
few limitations:
\begin{enumerate*}[label=(\roman*)]
\item simulating a system of differential equations for a large number
  of operators can be very time-consuming,
\item the weight function $w$ must be chosen carefully, as the optimal
  weight function is generally system-dependent,
\item simulation results can only be trusted up to the time at which
  the initial value of operators $S_+^p S_\z^r S_-^q$ with weight
  $w\p{p,q,r}\ge W$ have a non-negligible contribution to operators of
  interest.
  \label{pt:limitation}
\end{enumerate*}
While the first two of these limitations might in principle be avoided
by alternate means of tracking operators, the last limitation
necessarily applies in some form to any method tracking only a subset
of {\it all} operators.  Embracing the unavoidable, we therefore try
to devise an alternate truncation strategy which is built around
\ref{pt:limitation}.

We can expand operators in a Taylor series about $t=0$ to write
\begin{align}
  S_+^\ell S_\z^m S_-^n
  = \sum_{k\ge0} \f{t^k}{k!}
  \left.\f{d^k}{dt^k}\right|_{t=0} \p{S_+^\ell S_\z^m S_-^n},
\end{align}
which implies
\begin{align}
  \bk{S_+^\ell S_\z^m S_-^n}
  = \sum_{k\ge0} \f{t^k}{k!}
  \sum_{p,q,r} T^{\ell m n}_{pqr;k} \bk{S_+^p S_\z^q S_-^r}_{t=0},
  \label{eq:time_series}
\end{align}
where the matrix elements of the $k$-th time derivative are given by
\begin{align}
  T^{\ell m n}_{pqr;0}=\delta_{\ell p}\delta_{mq}\delta_{nr},
  &&
  T^{\ell m n}_{pqr;1}\equiv T^{\ell m n}_{pqr},
\end{align}
\begin{align}
  T^{\ell mn}_{pqr;k>1}
  \equiv \sum_{\v\lambda,\v\mu,\v\nu}
  T^{\ell mn}_{\lambda_1 \mu_1 \nu_1}
  T^{\lambda_1 \mu_1 \nu_1}_{\lambda_2 \mu_2 \nu_2}
  T^{\lambda_2 \mu_2 \nu_2}_{\lambda_3 \mu_3 \nu_3}
  \cdots T^{\lambda_{k-1} \mu_{k-1} \nu_{k-1}}_{pqr}.
\end{align}
Instead of explicitly choosing a weight function that determines which
operators to keep track of, we can now truncate the series in
\eqref{eq:time_series} by taking
\begin{align}
  \bk{S_+^\ell S_\z^m S_-^n}
  = \sum_{k\ge0} \f{t^k}{k!}
  \sum_{p,q,r} T^{\ell m n}_{pqr;k} \bk{S_+^p S_\z^q S_-^r}_{t=0}
  \to \sum_{k<M} \f{t^k}{k!}
  \sum_{p,q,r} T^{\ell m n}_{pqr;k} \bk{S_+^p S_\z^q S_-^r}_{t=0}.
\end{align}
Examining the nonzero entries of $T^{\ell mn}_{pqr;k}$ for
$k=0,1,\cdots,M-1$ now {\it tells} us which operators we need to keep
track of in order to compute the expectation value
$\bk{S_+^\ell S_\z^m S_-^n}$.  Furthermore, after computing the
expectation values of all relevant operators at $t=0$, time evolution
of $\bk{S_+^\ell S_\z^m S_-^n}$ takes only $\O\p{M}$ CPU time.
Finally, the relation
$\p{S_+^\ell S_\z^m S_-^n}^\dag=S_+^n S_\z^m S_-^\ell$ can be
exploited to cut both the number of expectation values
$\bk{S_+^p S_\z^r S_-^q}_{t=0}$ and the number of matrix elements
$T^{\ell mn}_{pqr}$ which we need to compute roughly in half.


\section{Decoherence in the two-axis twisting protocols}

In the case of squeezing through spin-orbit coupling with the Sr-87
optical lattice clock, the primary form of decoherence is through
decay of individual spins, i.e.~with jump operators $\sigma_-^{(j)}$.
The two axis twisting Hamiltonians $H_{\t{TAT}}^{\z,\y}$ and
$H_{\t{TAT}}^{\z,\y}$, however, are actually realized in a rotating
frame, which implies that we must transform these jump operators
appropriately.  Specifically, the TAT protocol begins with a
time-dependent transverse-field Hamiltonian
\begin{align}
  H = \chi S_\z^2 + \Omega\p{t} S_\x,
  &&
  \Omega\p{t} = \beta\omega\cos\p{\omega t} S_\x,
\end{align}
where $\beta$ is the modulation index of the driving field, and the
drive frequency $\omega\gg N\chi$.  Moving into the rotating frame of
$\Omega\p{t}S_\x$ subtracts this term from the Hamiltonian, and
transforms operators $\O$ as
\begin{align}
  \O \to U\p{t}^\dag \O U\p{t},
  &&
  U\p{t} \equiv \exp\p{-i\int_0^t\d\tau~\Omega\p{\tau}S_\x}
  = \exp\sp{-i\beta\sin\p{\omega t}S_\x},
\end{align}
In particular, the operators $\tilde S_\pm\equiv-S_\z\pm iS_\y$
transform as
\begin{align}
  \tilde S_\pm
  \to U^\dag \tilde S_\pm U
  = e^{\pm i\beta\sin\p{\omega t}} \tilde S_\pm.
\end{align}
For large drive frequencies $\omega$, we can generally make a secular
approximation to say
\begin{align}
  e^{\pm i\beta\sin\p{\omega t}}
  = \sum_{n=-\infty}^\infty J_n\p{\pm\beta} e^{in\omega t}
  \approx J_0\p{\pm\beta} = J_0\p{\beta},
\end{align}
where $J_n$ is the $n$-th order Bessel function of the first kind.
Expanding $S_\z^2=\f14\p{\tilde S_++\tilde S_-}^2$, one can thus work
out that the effective Hamiltonian in the rotating frame of the drive
is
\begin{align}
  H_{\t{eff}}
  \approx \f{\chi}{2} \p{\sp{J_0\p{2\beta}+1} S_\z^2
  - \sp{J_0\p{2\beta}-1} S_\y^2},
\end{align}
where choosing $\beta$ such that $J_0\p{2\beta}=\pm1/3$ will give us
$H_{\t{TAT}}^{\z,\y}$ or $H_{\t{TAT}}^{\y,\x}$ up to irrelevant terms.
In a similar spirit, one can work out that
\begin{align}
  \tilde\sigma_\pm^{(j)}
  \equiv \f12\p{-\sigma_\z^{(j)}\pm i\sigma_\y^{(j)}}
  \to U^\dag \tilde\sigma_\pm^{(j)} U
  = e^{\pm i\beta\sin\p{\omega t}} \tilde\sigma_\pm^{(j)}
  \approx J_0\p{\beta} \tilde\sigma_\pm^{(j)},
\end{align}
which implies
\begin{align}
  \sigma_\z^{(j)} \to J_0\p{\beta} \sigma_\z^{(j)},
  &&
  \sigma_\pm^{(j)}
  \to \f12\sp{1 \pm J_0\p{\beta}} \sigma_+^{(j)}
  + \f12\sp{1 \mp J_0\p{\beta}} \sigma_-^{(j)}.
\end{align}
The TAT protocol about $\p{\z,\y}$ requires
\begin{align}
  J_0\p{2\beta} = 1/3
  \implies \beta \approx 0.906
  \implies J_0\p{\beta} \approx 0.805,
\end{align}
while the TAT protocol about $\p{\y,\x}$ requires
\begin{align}
  J_0\p{2\beta} = -1/3
  \implies
  \begin{cases}
    \beta \approx 1.63
    \implies J_0\p{\beta} \approx 0.440, \\
    \beta \approx 2.22
    \implies J_0\p{\beta} \approx 0.099.
  \end{cases}
\end{align}


\bibliography{\jobname}

\newpage
\appendix

\section{Basic spin operator identities}
\label{sec:identities}

The appendices in this text make ubiquitous use of various spin
operator identities; we collect and derive some basic identities here
for reference.  The elementary commutation relations between spin
operators are, with $\bmu\equiv-\mu\in\set{+1,-1}$ for brevity,
\begin{align}
  \f12 \sp{\sigma_\z^{(j)},\sigma_\mu^{(k)}}_-
  &= \delta_{jk} \mu\sigma_\mu^{(j)},
  &
  \sp{S_\z,\sigma_\mu^{(j)}}_-
  &= \f12 \sp{\sigma_\z^{(j)},S_\mu}_- = \mu\sigma_\mu^{(j)},
  &
  \sp{S_\z,S_\mu}_-
  &= \mu S_\mu,
  \label{eq:comm_z_base} \\
  \sp{\sigma_\mu^{(j)},\sigma_\bmu^{(k)}}_-
  &= \delta_{jk} \mu \sigma_\z^{(j)},
  &
  \sp{S_\mu,\sigma_\bmu^{(j)}}_-
  &= \sp{\sigma_\mu^{(j)},S_\bmu}_- = \mu \sigma_\z^{(j)},
  &
  \sp{S_\mu,S_\bmu}_-
  &= 2 \mu S_\z.
  \label{eq:comm_mu_base}
\end{align}
These relations can be used to inductively compute identities
involving powers of collective spin operators.  By pushing through one
spin operator at a time, we can find
\begin{align}
  \p{\mu S_\z}^m \sigma_\mu^{(j)}
  = \p{\mu S_\z}^{m-1} \sigma_\mu^{(j)} \p{1 + \mu S_\z}
  = \p{\mu S_\z}^{m-2} \sigma_\mu^{(j)} \p{1 + \mu S_\z}^2
  = \cdots
  = \sigma_\mu^{(j)} \p{1 + \mu S_\z}^m,
  \label{eq:push_z_mu_Ss}
\end{align}
and
\begin{align}
  \mu\sigma_\z^{(j)} S_\mu^m
  = S_\mu \mu\sigma_\z^{(j)} S_\mu^{m-1} + 2\sigma_\mu^{(j)} S_\mu^{m-1}
  = \cdots
  = 2m\sigma_\mu^{(j)} S_\mu^{m-1} + S_\mu^m \mu \sigma_\z^{(j)},
  \label{eq:push_z_mu_sS}
\end{align}
where we will generally find it nicer to express our results in terms
of $\mu\sigma_\z^{(j)}$ and $\mu S_\z$ rather than $\sigma_\z^{(j)}$
and $S_\z$.  Summing over the single-spin index $j$ in both of these
cases gives us the purely collective-spin versions of these
identities:
\begin{align}
  \p{\mu S_\z}^m S_\mu = S_\mu \p{1 + \mu S_\z}^m,
  &&
  \mu S_\z S_\mu^m = S_\mu^m \p{m + \mu S_\z},
  \label{eq:push_z_mu_single}
\end{align}
where we can repeat the process of pushing through individual $S_\z$
operators $\ell$ times to get
\begin{align}
  \p{\mu S_\z}^\ell S_\mu^m
  = \p{\mu S_\z}^{\ell-1} S_\mu^m \p{m + \mu S_\z}
  = \p{\mu S_\z}^{\ell-2} S_\mu^m \p{m + \mu S_\z}^2
  = \cdots
  = S_\mu^m \p{m + \mu S_\z}^\ell.
  \label{eq:push_z_mu}
\end{align}
Multiplying \eqref{eq:push_z_mu} through by $\p{\mu\nu}^\ell$ (for
$\nu\in\set{+1,-1}$) and taking its Hermitian conjugate, we can say
that more generally
\begin{align}
  \p{\nu S_z}^\ell S_\mu^m
  = S_\mu^m \p{\mu\nu m+\nu S_\z}^\ell,
  &&
  S_\mu^m \p{\nu S_z}^\ell
  = \p{-\mu\nu m+\nu S_\z}^\ell S_\mu^m.
\end{align}
Finding commutation relations between powers of transverse spin
operators, i.e.~$S_\mu$ and $S_\bmu$, turns out to be considerably
more difficult than the cases we have worked out thus far.  We
therefore save this work for Appendix \ref{sec:comm_transverse}.


\section{Commutation relations between powers of transverse spin
  operators}
\label{sec:comm_transverse}

To find commutation relations between powers of transverse collective
spin operators, we compute (with $\bmu\equiv-\mu\in\set{+1,-1}$)
\begin{align}
  S_\mu^m \sigma_\bmu^{(j)}
  &= S_\mu^{m-1}\sigma_\bmu^{(j)} S_\mu
  + S_\mu^{m-1} \mu\sigma_\z^{(j)} \\
  &= S_\mu^{m-2} \sigma_\bmu^{(j)} S_\mu^2
  + S_\mu^{m-2} \mu\sigma_\z^{(j)} S_\mu
  + S_\mu^{m-1} \mu\sigma_\z^{(j)} \\
  &= \sigma_\bmu^{(j)} S_\mu^m
  + \sum_{k=0}^{m-1} S_\mu^k \mu\sigma_\z^{(j)} S_\mu^{m-k-1}
  \label{eq:push_mu_Ss_start}.
\end{align}
While \eqref{eq:push_mu_Ss_start} gives us the commutator
$\sp{S_\mu^m,\sigma_\bmu^{(j)}}_-$, we would like to enforce an
ordering on products of spin operators, which will allow us to only
keep track of operators that are linearly independent.  We choose (for
now) to impose an ordering with all $\sigma_\bmu^{(j)}$ operators on
the left, and all $\sigma_\z^{(j)}$ operators on the right, as such an
ordering will prove convenient for the calculations in this section.
This choice of ordering compels us to expand
\begin{align}
  \sum_{k=0}^{m-1} S_\mu^k \mu\sigma_\z^{(j)} S_\mu^{m-k-1}
  &= \sum_{k=0}^{m-1} S_\mu^k
  \sp{2\p{m-k-1} \sigma_\mu^{(j)} S_\mu^{m-k-2}
    + S_\mu^{m-k-1} \mu\sigma_\z^{(j)}} \\
  &= m \p{m-1} \sigma_\mu^{(j)} S_\mu^{m-2}
  + m S_\mu^{m-1} \mu\sigma_\z^{(j)},
\end{align}
which implies
\begin{align}
  S_\mu^m \sigma_\bmu^{(j)}
  = \sigma_\bmu^{(j)} S_\mu^m + m \p{m-1} \sigma_\mu^{(j)} S_\mu^{m-2}
  + m S_\mu^{m-1} \mu\sigma_\z^{(j)},
  \label{eq:push_mu_Ss}
\end{align}
and in turn
\begin{align}
  S_\mu^m S_\bmu = S_\bmu S_\mu^m
  + m S_\mu^{m-1} \p{m - 1 + 2\mu S_\z}.
  \label{eq:push_mu_single}
\end{align}
As the next logical step, we take on the task of computing
\begin{align}
  S_\mu^m S_\bmu^n
  &= S_\mu^{m-1} S_\bmu^n S_\mu
  + n \sp{S_\mu^{m-1} S_\bmu^{n-1} \p{1 - n + 2\mu S_\z}} \\
  &= S_\bmu^n S_\mu^m
  + n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_\z} S_\mu^k,
\end{align}
which implies
\begin{align}
  \sp{S_\mu^m, S_\bmu^n}_-
  = C_{mn;\mu}
  \equiv n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_\z} S_\mu^k.
\end{align}
We now need rearrange the operators in $C_{mn;\mu}$ into a standard
order, which means pushing all $S_\z$ operators to the right and, for
the purposes of this calculation, all $S_\bmu$ operators on the left.
We begin by pushing $S_\mu^k$ to the left of $S_\z$, which takes
$2\mu S_\z\to 2\mu S_\z+2k$, and then push $S_\mu^{m-k-1}$ to the
right of $S_\bmu^{n-1}$, giving us
\begin{align}
  C_{mn;\mu}
  &= n \sum_{k=0}^{m-1}
  \p{S_\bmu^{n-1} S_\mu^{m-k-1} + C_{m-k-1,n-1;\mu}} S_\mu^k
  \p{2k + 1 - n + 2\mu S_\z} \\
  &= D_{mn;\mu}
  + n \sum_{k=0}^{m-2} C_{m-k-1,n-1;\mu}
  S_\mu^k \p{2k + 1 - n + 2\mu S_\z},
  \label{eq:C_mn}
\end{align}
where we have dropped the last ($k=m-1$) term in the remaining sum
because $C_{m-k-1,n-1;\mu}=0$ if $k=m-1$, and
\begin{align}
  D_{mn;\mu}
  \equiv mn S_\bmu^{n-1} S_\mu^{m-1} \p{m - n + 2\mu S_\z}.
  \label{eq:D_mn}
\end{align}
To our despair, we have arrived in \eqref{eq:C_mn} at a {\it
  recursive} formula for $C_{mn;\mu}$.  Furthermore, we have not even
managed to order all spin operators, as $C_{m-k-1,n-1;\mu}$ contains
$S_\z$ operators which are to the left of $S_\mu^k$.  To sort all spin
operators once and for all, we define
\begin{align}
  C_{mn;\mu}^{(k)} \equiv C_{m-k,n;\mu} S_\mu^k,
  &&
  D_{mn;\mu}^{(k)} \equiv D_{m-k,n;\mu} S_\mu^k,
\end{align}
which we can expand as
\begin{align}
  D_{mn;\mu}^{(k)}
  &\equiv D_{m-k,n;\mu}S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-k-1}
  \p{m-k-n+2\mu S_\z} S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-1} \p{k+m-n+2\mu S_\z},
  \label{eq:D_mn_k}
\end{align}
and
\begin{align}
  C_{mn;\mu}^{(k)}
  &= D_{m-k,n;\mu} S_\mu^k + n \sum_{j=0}^{m-k-2}
  C_{m-k-j-1,n-1;\mu} S_\mu^j \p{2j+1-n+2\mu S_\z} S_\mu^k \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{m-k-j-1,n-1;\mu} S_\mu^{j+k} \p{2j+2k+1-n+2\mu S_\z} \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{m-1,n-1;\mu}^{(k+j)} \p{2\sp{j+k}+1-n+2\mu S_\z} \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=k}^{m-2}
  C_{m-1,n-1;\mu}^{(j)} \p{2j+1-n+2\mu S_\z}.
  \label{eq:C_mn_k}
\end{align}
While the resulting expression in \eqref{eq:C_mn_k} strongly resembles
that in \eqref{eq:C_mn}, there is one crucial difference: all spin
operators in \eqref{eq:C_mn_k} have been sorted into a standard order.
We can now repeatedly substitute $C_{mn;\mu}^{(k)}$ into itself, each
time decreasing $m$ and $n$ by 1, until one of $m$ or $n$ reaches
zero.  Such repeated substitution yields the expansion
\begin{align}
  C_{mn;\mu}
  = C_{mn;\mu}^{(0)}
  = D_{mn;\mu}
  + \sum_{p=1}^{\min\set{m,n}-1} E_{mn;\mu}^{(p)},
  \label{eq:C_mn_E}
\end{align}
where the first two terms in the sum over $p$ are
\begin{align}
  E_{mn;\mu}^{(1)}
  &= n \sum_{k=0}^{m-2} D_{m-1,n-1;\mu}^{(k)} \p{2k+1-n+2\mu S_\z}, \\
  E_{mn;\mu}^{(2)}
  &= n \sum_{k_1=0}^{m-2} \p{n-1} \sum_{k_2=k_1}^{m-3}
  D_{m-2,n-2;\mu}^{(k_2)} \p{2k_2+2-n+2\mu S_\z} \p{2k_1+1-n+2\mu S_\z},
\end{align}
and more generally for $p>1$,
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{k_1=0}^{m-2} \sum_{k_2=k_1}^{m-3} \cdots\sum_{k_p=k_{p-1}}^{m-p-1}
  D_{m-p,n-p;\mu}^{(k_p)} \prod_{j=1}^p \p{2k_j+j-n+2\mu S_\z}.
  \label{eq:E_mn_p}
\end{align}
In principle, the expressions in \eqref{eq:D_mn_k} and
\eqref{eq:C_mn_E}-\eqref{eq:E_mn_p} can be used to evaluate the
commutator $\sp{S_\mu^m,S_\bmu^n}_- = C_{mn;\mu}$, but these result
are -- to put it lightly -- quite a mess: the expression for
$E_{mn;\mu}^{(p)}$ in \eqref{eq:E_mn_p} involves a sum over $p$
mutually dependent intermediate variables!  We therefore devote the
rest of this section to simplifying our result for the commutator
$\sp{S_\mu^m,S_\bmu^n}_-$.

Observing that we always have
$0\le k_1\le k_2\le\cdots\le k_p\le m-p-1$ in \eqref{eq:E_mn_p}, we
can rearrange the order of the sums and relabel $k_p\to\ell$ to get
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{\ell=0}^{m-p-1} D_{m-p,n-p;\mu}^{(\ell)} \p{2\ell+F_{np;\mu}}
  \sum_{\p{\v k,p-1,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}},
  \label{eq:E_mn_p_sum}
\end{align}
where for shorthand we define
\begin{align}
  F_{np;\mu} \equiv p - n + 2\mu S_\z,
  &&
  \sum_{\p{\v k,q,\ell}} X \equiv
  \sum_{k_1=0}^\ell \sum_{k_2=k_1}^\ell
  \cdots \sum_{k_q=k_{q-1}}^\ell X.
\end{align}
We now further define
\begin{align}
  f_{np\ell;\mu}\p{k,q} \equiv \p{\ell-k+q} \p{\ell+k-q+F_{np;\mu}},
\end{align}
and evaluate sums successively over $k_{p-1},k_{p-2},\cdots,k_1$,
finding
\begin{align}
  \sum_{\p{\v k,p-1,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  &= \sum_{\p{\v k,p-2,\ell}}
  \prod_{j=2}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  f_{np\ell;\mu}\p{k_{p-2},1} \\
  &= \f1{r!} \sum_{\p{\v k,p-r,\ell}}
  \prod_{j=r}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  \prod_{q=1}^{r-1} f_{np\ell;\mu}\p{k_{p-r},q} \\
  &= \f1{\p{p-1}!} \prod_{q=1}^{p-1} f_{np\ell;\mu}\p{0,q} \\
  &= { \ell + p - 1 \choose p - 1 }
  \prod_{q=1}^{p-1} \p{\ell-q+F_{np;\mu}}.
\end{align}
Substitution of this result together with $D_{m-p,n-p;\mu}^{(\ell)}$
using \eqref{eq:D_mn_k} into \eqref{eq:E_mn_p_sum} then gives us
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p-1}!} S_\bmu^{n-p-1} S_\mu^{m-p-1} G_{mnp;\mu}
\end{align}
with
\begin{align}
  G_{mnp;\mu}
  &\equiv \sum_{\ell=0}^{m-p-1} { \ell + p - 1 \choose p - 1 }
  \p{m-p-\ell} \p{\ell+m-p+F_{np;\mu}}
  \p{2\ell + F_{np;\mu}}
  \prod_{q=1}^{p-1} \p{\ell-q+F_{np;\mu}} \\
  &= { m \choose p + 1 } \prod_{q=0}^p \p{m-p-q+F_{np;\mu}}.
\end{align}
We can further simplify
\begin{align}
  \prod_{q=0}^p \p{m-p-q+F_{np;\mu}}
  = \prod_{q=0}^p \p{m-n-q+2\mu S_\z}
  = \sum_{q=0}^{p+1} \p{-1}^{p+1-q}
  { p+1 \brack q } \p{m-n+2\mu S_\z}^q,
\end{align}
where ${ n \brack k }$ is an unsigned Stirling number of the first
kind, i.e.~the number of ways to pick a set of $k$ elements from a set
of $n$ elements, and finally
\begin{align}
  \sum_{q=0}^p \p{-1}^{p-q} { p \brack q } \p{m-n+2\mu S_\z}^q
  &= \sum_{q=0}^p \p{-1}^{p-q} { p \brack q } \sum_{\ell=0}^q
  { q \choose \ell } \p{m-n}^{q-\ell} \p{2\mu S_\z}^\ell \\
  &= \sum_{\ell=0}^p 2^\ell \sum_{q=\ell}^p \p{-1}^{p-q}
  { p \brack q } { q \choose \ell } \p{m-n}^{q-\ell} \p{\mu S_\z}^\ell.
\end{align}
Putting everything together, we finally have
\begin{align}
  E_{mn;\mu}^{(p-1)}
  = p! { m \choose p } { n \choose p }
  S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \epsilon_{mn}^{p\ell} \p{\mu S_\z}^\ell,
\end{align}
with
\begin{align}
  \epsilon_{mn}^{p\ell}
  \equiv 2^\ell \sum_{q=\ell}^p \p{-1}^{p-q}
  { p \brack q } { q \choose \ell } \p{m-n}^{q-\ell},
\end{align}
where in this final form $E_{mn;\mu}^{(0)} = D_{mn;\mu}$, which
together with the expansion for $C_{mn;\mu}$ in \eqref{eq:C_mn_E}
implies that
\begin{align}
  \sp{S_\mu^m, S_\bmu^n}_-
  = \sum_{p=1}^{\min\set{m,n}}
  p! { m \choose p } { n \choose p } S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \epsilon_{mn}^{p\ell} \p{\mu S_\z}^\ell,
  \label{eq:comm_mu}
\end{align}
and
\begin{align}
  S_\mu^m S_\bmu^n
  = \sum_{p=0}^{\min\set{m,n}}
  p! { m \choose p } { n \choose p } S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \epsilon_{mn}^{p\ell} \p{\mu S_\z}^\ell,
  \label{eq:push_mu_bmu}
\end{align}
If we wish to order products of collective spin operators with $S_\z$
in between $S_\bmu$ and $S_\mu$, then
\begin{align}
  S_\mu^m S_\bmu^n
  = \sum_{p=0}^{\min\set{m,n}} p! { m \choose p } { n \choose p }
  S_\bmu^{n-p} Z_{mn;\bmu}^{(p)} S_\mu^{m-p},
\end{align}
where
\begin{align}
  Z_{mn;\bmu}^{(p)}
  \equiv \sum_{\ell=0}^p \epsilon_{mn}^{p\ell}
  \p{-\sp{m-p} + \mu S_\z}^\ell
  = \sum_{\ell=0}^p \epsilon_{mn}^{p\ell}
  \p{-1}^\ell \p{\sp{m-p} + \bmu S_\z}^\ell
  = \sum_{q=0}^p \zeta_{mn}^{pq} \p{\bmu S_\z}^q,
  \label{eq:Z_mnp}
\end{align}
with
\begin{align}
  \zeta_{mn}^{pq}
  \equiv \sum_{\ell=q}^p \epsilon_{mn}^{p\ell} \p{-1}^\ell
  { \ell \choose q } \p{m-p}^{\ell-q}
  = \p{-1}^p 2^q \sum_{s=q}^p
  { p \brack s } { s \choose q } \p{m+n-2p}^{s-q}.
  \label{eq:zeta_mnpq}
\end{align}


\section{Commutation relations between ordered products of collective
  spin operators}
\label{sec:comm_general}

We will generally be concerned with ordered products of collective
spin operators of the form $S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$ for
$\bmu\equiv-\mu\in\set{+1,-1}$.  The most general (anti-)commutator we
need to consider is then
\begin{align}
  \sp{S_\mu^p \p{\mu S_\z}^q S_\bmu^r,
    S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_\pm
  = \S^{pqr}_{\ell mn;\mu} \pm \S^{\ell mn}_{pqr;\mu},
\end{align}
where
\begin{align}
  \S^{pqr}_{\ell mn;\mu}
  = S_\mu^p \p{\mu S_\z}^q S_\bmu^r
  S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n
  = \sum_{k=0}^{\min\set{r,\ell}} k! { r \choose k } { \ell \choose k }
  S_\mu^{p+\ell-k} \tilde Z_{qr\ell m;\mu}^{(k)} S_\bmu^{r+n-k},
  \label{eq:general_product}
\end{align}
for
\begin{align}
  \tilde Z_{qr\ell m;\mu}^{(k)}
  &\equiv \p{\sp{\ell-k}+\mu S_\z}^q
  Z_{r\ell;\mu}^{(k)} \p{\sp{r-k}+\mu S_\z}^m \\
  &= \sum_{a=0}^k \zeta_{r\ell}^{ka}
  \sum_{b=0}^q \p{\ell-k}^{q-b} { q \choose b }
  \sum_{c=0}^m \p{r-k}^{m-c} { m \choose c }
  \p{\mu S_\z}^{a+b+c},
\end{align}
defined in terms of $Z_{r\ell;\mu}^{(k)}$ and $\zeta_{r\ell}^{ka}$ as
given in \eqref{eq:Z_mnp} and \eqref{eq:zeta_mnpq}.


\section{Sandwich identities for single-spin decoherence calculations}
\label{sec:sandwich_single}

In this section we derive several identities which will be necessary
for computing the effects of single-spin decoherence on ordered
products of collective spin operators.  These identities all involve
sandwiching a collective spin operator between operators that act on
individual spins only, and summing such terms over all individual spin
indices.  Our general strategy will be to use commutation relations to
push single-spin operators together, and then evaluate the sum to
arrive at an expression in terms of collective spin operators only.

We first compute sums of single-spin operators sandwiching
$\p{\mu S_\z}^m$, which will in turn be used to compute similar sums
sandwiching $S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$.  Up to Hermitian
conjugation, the unique cases are, for $\mu,\nu\in\set{+1,-1}$ and
$\bmu\equiv-\mu$,
\begin{align}
  \sum_j \sigma_\z^{(j)} \p{\mu S_\z}^m \sigma_\z^{(j)}
  &= \sum_j \sigma_\z^{(j)} \sigma_\z^{(j)} \p{\mu S_\z}^m
  = \sum_j \1_j \p{\mu S_\z}^m
  = 2 S \p{\mu S_\z}^m, \\
  \sum_j \sigma_\z^{(j)} \p{\mu S_\z}^m \sigma_\nu^{(j)}
  &= \p{\mu S_\z}^m \sum_j \sigma_\z^{(j)} \sigma_\nu^{(j)}
  = \p{\mu S_\z}^m \nu S_\nu
  = \nu S_\nu \p{\mu\nu+\mu S_\z}^m, \\
  \sum_j \sigma_\nu^{(j)} \p{\mu S_\z}^m \sigma_\nu^{(j)}
  &= \sum_j \sigma_\nu^{(j)} \sigma_\nu^{(j)} \p{\mu\nu+\mu S_\z}^m
  = 0, \\
  \sum_j \sigma_\bnu^{(j)} \p{\mu S_\z}^m \sigma_\nu^{(j)}
  &= \sum_j \sigma_\bnu^{(j)} \sigma_\nu^{(j)} \p{\mu\nu+\mu S_\z}^m
  = \p{S-\nu S_\z} \p{\mu\nu+\mu S_\z}^m.
\end{align}
We are now equipped to derive similar identities for general ordered
products of collective spin operators.  Making heavy use of identities
\eqref{eq:push_z_mu_sS} and \eqref{eq:push_mu_Ss} to push single-spin
operators through transverse collective-spin operators, we again work
through all combinations that are unique up to Hermitian conjugation,
finding
\begin{align}
  \sum_j \sigma_\z^{(j)} S_\mu^\ell
  \p{\mu S_\z}^n S_\bmu^n \sigma_\z^{(j)}
  &= 2\p{S-\ell-n} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + 4\ell n S_\mu^{\ell-1} \p{S+\mu S_\z}
  \p{-1+\mu S_\z}^m S_\bmu^{n-1},
  \label{eq:san_z_z} \allowdisplaybreaks \\
  \sum_j \sigma_\z^{(j)} S_\mu^\ell
  \p{\mu S_\z}^n S_\bmu^n \sigma_\mu^{(j)}
  &= \mu S_\mu^{\ell+1} \p{1+\mu S_\z}^m S_\bmu^n
  + \mu n \p{-2S+2\ell+n-1} S_\mu^\ell
  \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad - 2\mu\ell n\p{n-1} S_\mu^{\ell-1}
  \p{S+\mu S_\z} \p{-1+\mu S_\z}^m S_\bmu^{n-2},
  \label{eq:san_z_mu} \allowdisplaybreaks \\
  \sum_j \sigma_\z^{(j)} S_\mu^\ell
  \p{\mu S_\z}^n S_\bmu^n \sigma_\bmu^{(j)}
  &= -\mu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^{n+1}
  + 2\mu \ell S_\mu^{\ell-1} \p{S+\mu S_\z}\p{-1+\mu S_\z}^m S_\bmu^n,
  \label{eq:san_z_bmu} \allowdisplaybreaks \\
  \sum_j \sigma_\mu^{(j)} S_\mu^\ell
  \p{\mu S_\z}^n S_\bmu^n \sigma_\mu^{(j)}
  &= n S_\mu^{\ell+1} \p{\mu S_\z}^m S_\bmu^{n-1}
  - n\p{n-1} S_\mu^\ell \p{S+\mu S_\z} \p{-1+\mu S_\z}^m S_\bmu^{n-2},
  \label{eq:san_mu_mu} \allowdisplaybreaks \\
  \sum_j \sigma_\mu^{(j)} S_\mu^\ell
  \p{\mu S_\z}^n S_\bmu^n \sigma_\bmu^{(j)}
  &= S_\mu^\ell \p{S+\mu S_\z}\p{-1+\mu S_\z}^m S_\bmu^n,
  \label{eq:san_mu_bmu} \allowdisplaybreaks \\
  \sum_j \sigma_\bmu^{(j)} S_\mu^\ell
  \p{\mu S_\z}^n S_\bmu^n \sigma_\mu^{(j)}
  &= S_\mu^\ell \p{S - \ell - n - \mu S_\z}
  \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n \p{2S - \ell - n + 2}
  S_\mu^{\ell-1} \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad + \ell n \p{\ell-1} \p{n-1} S_\mu^{\ell-2} \p{S+\mu S_\z}
  \p{-1+\mu S_\z}^m S_\bmu^{n-2}.
  \label{eq:san_bmu_mu}
\end{align}


\section{Uncorrelated, permutationally-symmetric single-spin
  decoherence}
\label{sec:decoherence_single}

In this section we work out the effects of permutationally-symmetric
decoherence of individual spins on ordered products of collective spin
operators.  For shorthand, we define
\begin{align}
  \D\p{\gamma;\O} \equiv \D\p{\set{\gamma^{(j)}};\O}
  = \sum_j\p{{\gamma^{(j)}}^\dag \O \gamma^{(j)}
    - \f12\sp{{\gamma^{(j)}}^\dag \gamma^{(j)}, \O}_+},
\end{align}
where $\gamma$ is an operator that acts on a single spin, and
$\gamma^{(j)}$ is an operator that acts with $\gamma$ on spin $j$ and
the identity on all other spins.


\subsection{Decay-type decoherence}
\label{sec:decay_single}

The effect of decoherence via uncorrelated decay ($\mu=-1$) or
excitation ($\mu=1$) of individual spins is described by (with
$\bmu\equiv-\mu$),
\begin{align}
  \D\p{\sigma_\mu; \O}
  = \sum_j\p{\sigma_\bmu^{(j)} \O \sigma_\mu^{(j)}
    - \f12\sp{\sigma_\bmu^{(j)} \sigma_\mu^{(j)},\O}_+}
  = \sum_j \sigma_\bmu^{(j)} \O \sigma_\mu^{(j)}
    - S \O + \f{\mu}{2} \sp{S_\z, \O}_+.
\end{align}
In order to determine the effect of this decoherence on ordered
products of collective spin operators, we expand the anti-commutator
\begin{align}
  \sp{S_\z, S_\mu^\ell \p{\mu S_\z}^n S_\bmu^n}_+
  = S_\z S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n
  + S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\z
  = \mu S_\mu^\ell\p{\ell+n+2\mu S_\z} \p{\mu S_\z}^m S_\bmu^n,
\end{align}
which implies, using \eqref{eq:san_mu_bmu},
\begin{align}
  \D\p{\sigma_\bmu; S_\mu^\ell \p{\mu S_\z}^n S_\bmu^n}
  = S_\mu^\ell \p{S+\mu S_\z}\p{-1+\mu S_\z}^m S_\bmu^n
  - S_\mu^\ell\sp{S + \f12\p{\ell+n} + \mu S_\z}
  \p{\mu S_\z}^m S_\bmu^n,
  \label{eq:decay_diff}
\end{align}
and, using \eqref{eq:san_bmu_mu},
\begin{align}
  \D\p{\sigma_\mu; S_\mu^\ell \p{\mu S_\z}^n S_\bmu^n}
  &= S_\mu^\ell \p{S - \ell - n - \mu S_\z} \p{1+\mu S_\z}^m S_\bmu^n
  - S_\mu^\ell\sp{S - \f12\p{\ell+n} - \mu S_\z}
  \p{\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n \p{2S - \ell - n + 2}
  S_\mu^{\ell-1} \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad + \ell n \p{\ell-1} \p{n-1} S_\mu^{\ell-2} \p{S + \mu S_\z}
  \p{-1+\mu S_\z}^m S_\bmu^{n-2}.
  \label{eq:decay_same}
\end{align}
Decoherence via jump operators $\sigma_\bmu^{(j)}$ only couples
operators $S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$ to operators
$S_\mu^\ell \p{\mu S_\z}^{m'} S_\bmu^n$ with $m'\le m$.  Decoherence
via jump operators $\sigma_\mu^{(j)}$, meanwhile, makes operators
$S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$ ``grow'' in $m$ through the last
term in \eqref{eq:decay_same} with $k=m$, although the sum $\ell+m+n$
does not grow.


\subsection{Dephasing}
\label{sec:dephasing_single}

The effect of decoherence via single-spin dephasing is described by
\begin{align}
  \D\p{\sigma_\z/\sqrt2; \O}
  = \f12 \sum_j\p{\sigma_\z^{(j)} \O \sigma_\z^{(j)}
    - \f12\sp{\sigma_\z^{(j)} \sigma_\z^{(j)},\O}_+}
  = \f12 \sum_j \sigma_\z^{(j)} \O \sigma_\z^{(j)} - S \O,
\end{align}
where the factor $\sqrt2$ is inserted as
e.g.~$\D\p{\sigma_\z/\sqrt2;S_\mu}=-S_\mu$, such that the above
expression generates decay of single-weight transverse collective spin
operators at a unit rate.  From \eqref{eq:san_z_z}, we then have
\begin{align}
  \D\p{\sigma_\z/\sqrt2; S_\mu^\ell \p{\mu S_\z}^n S_\bmu^n}
  = -\p{\ell+n} S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n
  + 2 \ell n S_\mu^{\ell-1} \p{S + \mu S_\z}
  \p{-1 + \mu S_\z}^m S_\bmu^{n-1}.
\end{align}
Decoherence via single-spin dephasing makes operators
$S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n$ ``grow'' in $m$, although the sum
$\ell+m+n$ does not grow.


\subsection{The general case}
\label{sec:general_single}

The most general type of single-spin decoherence is described by
\begin{align}
  \D\p{\gamma;\O}
  = \sum_j\p{{\gamma^{(j)}}^\dag \O \gamma^{(j)}
    - \f12\sp{{\gamma^{(j)}}^\dag \gamma^{(j)}, \O}_+},
  &&
  \gamma \equiv \gamma_\z \sigma_\z
  + \gamma_+ \sigma_+ + \gamma_- \sigma_-.
  \label{eq:D_general_single}
\end{align}
To simplify \eqref{eq:D_general_single}, we expand
\begin{align}
  \gamma^\dag \O \gamma
  = \abs{\gamma_\z}^2 \sigma_\z \O \sigma_\z
  + \sum_\mu \p{\abs{\gamma_\mu}^2 \sigma_\bmu \O \sigma_\mu
    + \gamma_\bmu^* \gamma_\mu \sigma_\mu \O \sigma_\mu
    + \gamma_\z^* \gamma_\mu \sigma_\z \O \sigma_\mu
    + \gamma_\bmu^* \gamma_\z \sigma_\mu \O \sigma_\z},
\end{align}
and
\begin{align}
  \gamma^\dag \gamma
  = \abs{\gamma_\z}^2
  + \sum_\mu \sp{\abs{\gamma_\mu}^2 \f12 \p{1-\mu\sigma_\z}
    + \mu \p{\gamma_\z^*\gamma_\mu - \gamma_\bmu^*\gamma_\z}
    \sigma_\mu},
\end{align}
which implies
\begin{align}
  \D\p{\gamma;\O}
  &= \sum_{X\in\set{\z,+,-}} \abs{\gamma_X}^2 \D\p{\sigma_X;\O}
  + \sum_{\mu,j}
  \p{\gamma_\bmu^* \gamma_\mu \sigma_\mu^{(j)} \O \sigma_\mu^{(j)}
    + \gamma_\z^* \gamma_\mu \sigma_\z^{(j)} \O \sigma_\mu^{(j)}
    + \gamma_\bmu^* \gamma_\z \sigma_\mu^{(j)} \O \sigma_\z^{(j)}}
  \notag \\
  &\qquad -\f12 \sum_\mu \mu
  \p{\gamma_\z^*\gamma_\mu - \gamma_\bmu^*\gamma_\z} \sp{S_\mu, \O}_+.
\end{align}
In order to compute the effect of this decoherence on ordered products
of collective spin operators, we expand the anti-commutator
\begin{align}
  \sp{S_\mu, S_\mu^\ell \p{\mu S_\z}^n S_\bmu^n}_+
  = S_\mu^{\ell+1} \sp{S_\z^m+\p{1+\mu S_\z}^m} S_\bmu^n
  - n S_\mu^\ell \p{n-1+2\mu S_\z} \p{\mu S_\z}^m S_\bmu^{n-1}.
  \label{eq:S_mu_acomm}
\end{align}
Recognizing a resemblance between \eqref{eq:S_mu_acomm} and
\eqref{eq:san_z_mu}, we can collect terms to simplify
\begin{align}
  \sum_j \sigma_\z^{(j)} S_\mu^\ell
  \p{\mu S_\z}^n S_\bmu^n \sigma_\mu^{(j)}
  - \f{\mu}{2} \sp{S_\mu, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  = K_{\ell mn;\mu} + L_{\ell mn;\mu}
  \label{eq:dec_z_mu}
\end{align}
and likewise
\begin{align}
  \sum_j \sigma_\mu^{(j)} S_\mu^\ell
  \p{\mu S_\z}^n S_\bmu^n \sigma_\z^{(j)}
  + \f{\mu}{2} \sp{S_\mu, S_\mu^\ell \p{\mu S_\z}^n S_\bmu^n}_+
  = K_{\ell mn;\mu} + M_{\ell mn;\mu}
  \label{eq:dec_mu_z}
\end{align}
with
\begin{align}
  K_{\ell mn;\mu}
  &\equiv \f{\mu}{2} S_\mu^{\ell+1}
  \sp{\p{1+\mu S_\z}^m-\p{\mu S_\z}^m} S_\bmu^n, \\
  L_{\ell mn;\mu}
  &\equiv \mu n S_\mu^\ell \sp{-2S+2\ell+\f32\p{n-1}+\mu S_\z}
  \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad - 2\mu\ell n\p{n-1} S_\mu^{\ell-1}
  \p{S+\mu S_\z} \p{-1+\mu S_\z}^m S_\bmu^{n-2}, \\
  M_{\ell mn;\mu}
  &\equiv \mu n S_\mu^\ell \sp{2\p{S+\mu S_\z}\p{-1+\mu S_\z}^m
    - \p{\f12\sp{n-1}+\mu S_\z}\p{\mu S_\z}^m} S_\bmu^{n-1}.
\end{align}
Defining for completion
\begin{align}
  P_{\ell mn;\mu}
  &\equiv \sum_j \sigma_\mu^{(j)} S_\mu^\ell
  \p{\mu S_\z}^m S_\bmu^n \sigma_\mu^{(j)} \\
  &= n S_\mu^{\ell+1} \p{\mu S_\z}^m S_\bmu^{n-1}
  - n\p{n-1} S_\mu^\ell \p{S+\mu S_\z} \p{-1+\mu S_\z}^m S_\bmu^{n-2},
\end{align}
and
\begin{align}
  Q_{\ell mn;\mu}^{(\gamma)}
  \equiv \gamma_\bmu^* \gamma_\mu P_{\ell mn;\mu}
  + \p{\gamma_\z^* \gamma_\mu + \gamma_\bmu^* \gamma_\z}
  K_{\ell mn;\mu}
  + \gamma_\z^* \gamma_\mu L_{\ell mn;\mu}
  + \gamma_\bmu^* \gamma_\z M_{\ell mn;\mu},
  \label{eq:Q_single}
\end{align}
we finally have
\begin{align}
  \D\p{\gamma; S_\mu^\ell \p{\mu S_\z}^n S_\bmu^n}
  = \sum_{X\in\set{\z,+,-}} \abs{\gamma_X}^2
  \D\p{\sigma_X; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  + Q_{\ell mn;\mu}^{(\gamma)} + \sp{Q_{nm\ell;\mu}^{(\gamma)}}^\dag.
\end{align}
Note that the sum $\ell+m+n$ for operators
$S_\mu^\ell \p{\mu S_\z}^n S_\bmu^n$ does not grow under this type of
decoherence.


\section{Sandwich identities for collective-spin decoherence
  calculations}
\label{sec:sandwich_collective}

In analogy with the work in Appendix \ref{sec:sandwich_single}, in
this section we work out sandwich identities necessary for
collective-spin decoherence calculations.  The simplest cases are
\begin{align}
  S_\mu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\bmu
  &= S_\mu^{\ell+1} \p{\mu S_\z}^m S_\bmu^{n+1},
  \allowdisplaybreaks \\
  S_\mu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\z
  &= \mu S_\mu^{\ell+1} \p{n+\mu S_\z} \p{\mu S_\z}^m S_\bmu^n,
  \allowdisplaybreaks \\
  S_\z S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\z
  &= S_\mu^\ell \sp{\ell n + \p{\ell+n} \mu S_\z + \p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^n.
\end{align}
With a bit more work, we can also find
\begin{align}
  S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= S_\mu^{\ell+1} \p{1+\mu S_\z}^m S_\bmu^n
  - n S_\mu^\ell \p{n-1+2\mu S_\z} \p{\mu S_\z}^m S_\bmu^{n-1},
\end{align}
which implies
\begin{align}
  S_\mu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= S_\mu^{\ell+2} \p{1+\mu S_\z}^m S_\bmu^n
  - n S_\mu^{\ell+1} \p{n-1+2\mu S_\z} \p{\mu S_\z}^m S_\bmu^{n-1},
  \allowdisplaybreaks \\
  S_\z S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= \mu S_\mu^{\ell+1} \p{\ell+1+\mu S_\z} \p{1+\mu S_\z}^m S_\bmu^n
  \notag \\
  &\qquad - \mu n S_\mu^\ell
  \sp{\ell\p{n-1} + \p{2\ell+n-1}\mu S_\z + 2\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-1}.
\end{align}
Finally, we compute
\begin{align}
  S_\bmu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= \sp{S_\mu^\ell S_\bmu - \ell S_\mu^{\ell-1} \p{\ell-1+2\mu S_\z}}
  \p{\mu S_\z}^m
  \sp{S_\mu S_\bmu^n - n \p{n-1+2\mu S_\z} S_\bmu^{n-1}} \notag \\
  &= S_\mu^\ell S_\bmu \p{\mu S_\z}^m S_\mu S_\bmu^n \notag \\
  &\qquad - S_\mu^\ell
  \sp{\ell\p{\ell+1} + n\p{n+1}+2\p{\ell+n}\mu S_\z}
  \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n S_\mu^{\ell-1}
  \sp{\p{\ell-1}\p{n-1}+2\p{\ell+n-2}\mu S_\z + 4\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-1},
\end{align}
where
\begin{multline}
  S_\bmu \p{\mu S_\z}^m S_\mu
  = S_\bmu S_\mu \p{1+\mu S_\z}^m
  = \p{S_\mu S_\bmu - 2\mu S_\z} \p{1+\mu S_\z}^m \\
  = S_\mu \p{2+\mu S_\z}^m S_\bmu - 2\mu S_\z \p{1+\mu S_\z}^m,
\end{multline}
so
\begin{align}
  S_\bmu S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n S_\mu
  &= S_\mu^{\ell+1} \p{2+\mu S_\z}^m S_\bmu^{n+1} \notag \\
  &\qquad - S_\mu^\ell
  \sp{\ell\p{\ell+1} + n\p{n+1}+2\p{\ell+n+1}\mu S_\z}
  \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n S_\mu^{\ell-1}
  \sp{\p{\ell-1}\p{n-1}+2\p{\ell+n-2}\mu S_\z + 4\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-1}.
\end{align}


\section{Collective spin decoherence}
\label{sec:decoherence_collective}

In this section we work out the effects of decoherence via collective
jump operators on ordered products of collective spin operators.  For
shorthand, we define
\begin{align}
  \D\p{\Gamma;\O}
  \equiv \D\p{\set{\Gamma};\O}
  = \Gamma^\dag \O \Gamma - \f12\sp{\Gamma^\dag \Gamma, \O}_+,
\end{align}
where $\Gamma$ is a collective spin operator with weight one i.e.~a
linear combination of $S_\z$, $S_\mu$, and $S_\bmu$.

\subsection{Decay-type decoherence and dephasing}
\label{sec:decay_dephasing_collective}

Making use of the results in Appendix \ref{sec:sandwich_collective},
we find that the effects of collective decay-type decoherence on
ordered products of collective spin operators are given by
\begin{align}
  \D\p{S_\bmu; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  &= -S_\mu^{\ell+1} \sp{\p{1+\mu S_\z}^m - \p{\mu S_\z}^m}
  S_\bmu^{n+1} \notag \\
  &\qquad + \f12 S_\mu^\ell \sp{\ell\p{\ell-1} + n\p{n-1}
    + 2\p{\ell+n}\mu S_\z} \p{\mu S_\z}^m S_\bmu^n,
\end{align}
and
\begin{align}
  \D\p{S_\mu; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  &= S_\mu^{\ell+1} \sp{\p{2+\mu S_\z}^m-\p{1+\mu S_\z}^m}
  S_\bmu^{n+1} \notag \\
  &\qquad - S_\mu^\ell
  \sp{\ell\p{\ell+1} + n\p{n+1}+2\p{\ell+n+1}\mu S_\z}
  \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \f12 S_\mu^\ell
  \sp{\ell\p{\ell+1} + n\p{n+1}+2\p{\ell+n+2}\mu S_\z}
  \p{\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \ell n S_\mu^{\ell-1}
  \sp{\p{\ell-1}\p{n-1}+2\p{\ell+n-2}\mu S_\z + 4\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-1}.
\end{align}
Similarly, we can work out that the effect of collective spin
dephasing is given by
\begin{align}
  \D\p{S_\z; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  = -\f12 \p{\ell-n}^2 S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n.
\end{align}


\subsection{The general case}
\label{sec:general_collective}

More generally, we may need to consider collective-spin jump operators
of the form
\begin{align}
  \Gamma \equiv \Gamma_\z S_\z + \Gamma_+ S_+ + \Gamma_- S_-,
\end{align}
whose decoherence effects are determined by
\begin{align}
  \Gamma^\dag \O \Gamma
  = \abs{\Gamma_\z}^2 S_\z \O S_\z
  + \sum_\mu \p{\abs{\Gamma_\mu}^2 S_\bmu \O S_\mu
    + \Gamma_\bmu^* \Gamma_\mu S_\mu \O S_\mu
    + \Gamma_\z^* \Gamma_\mu S_\z \O S_\mu
    + \Gamma_\bmu^* \Gamma_\z S_\mu \O S_\z},
\end{align}
and
\begin{align}
  \Gamma^\dag \Gamma
  = \abs{\Gamma_\z}^2 S_\z^2
  + \sum_\mu \p{\abs{\Gamma_\mu}^2 S_\bmu S_\mu
    + \Gamma_\z^*\Gamma_\mu S_\z S_\mu
    + \Gamma_\bmu^* \Gamma_\z S_\mu S_\z
    + \Gamma_\bmu^* \Gamma_\mu S_\mu^2},
\end{align}
which implies
\begin{align}
  \D\p{\Gamma;\O}
  &= \sum_{X\in\set{\z,+,-}} \abs{\Gamma_X}^2 \D\p{S_X;\O}
  + \sum_\mu \p{\Gamma_\bmu^* \Gamma_\mu S_\mu \O S_\mu
    + \Gamma_\z^* \Gamma_\mu S_\z \O S_\mu
    + \Gamma_\bmu^* \Gamma_\z S_\mu \O S_\z}
  \notag \\
  &\qquad -\f12 \sum_\mu\p{\Gamma_\bmu^* \Gamma_\mu \sp{S_\mu^2, \O}_+
    + \Gamma_\z^*\Gamma_\mu \sp{S_\z S_\mu, \O}_+
    + \Gamma_\bmu^* \Gamma_\z \sp{S_\mu S_\z, \O}_+}.
\end{align}
In order to compute the effect of this decoherence on ordered products
of collective spin operators, we expand the anti-commutators
\begin{align}
  \sp{S_\mu^2, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  &= S_\mu^{\ell+2} \sp{\p{2+\mu S_\z}^m+\p{\mu S_\z}^m} S_\bmu^n
  - 2n S_\mu^{\ell+1} \p{n+2\mu S_\z} \p{1+\mu S_\z}^m S_\bmu^{n-1}
  \notag \\
  &\qquad + n\p{n-1} S_\mu^\ell \sp{\p{n-1}\p{n-2}
    + 2\p{2n-3}\mu S_\z + 4\p{\mu S_\z}^2} \notag \\
  &\qquad\qquad\qquad\qquad \times \p{\mu S_\z}^m S_\bmu^{n-2},
  \allowdisplaybreaks \\
  \sp{S_\z S_\mu, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  &= \mu S_\mu^{\ell+1} \sp{\p{\ell+1+\mu S_\z}\p{\mu S_\z}^m
    + \p{n+1+\mu S_\z} \p{1+\mu S_\z}^m } S_\bmu^n \notag \\
  &\qquad - \mu n S_\mu^\ell \sp{n \p{n-1}
    + \p{3n-1}\mu S_\z + 2\p{\mu S_\z}^2} \p{\mu S_\z}^m S_\bmu^{n-1},
  \allowdisplaybreaks \\
  \sp{S_\mu S_\z, S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}_+
  &= \mu S_\mu^{\ell+1} \sp{\p{\ell+\mu S_\z}\p{\mu S_\z}^m
    + \p{n+\mu S_\z} \p{1+\mu S_\z}^m} S_\bmu^n \notag \\
  &\qquad - \mu n S_\mu^\ell \sp{\p{n-1}^2
    + 3\p{n-1}\mu S_\z + 2\p{\mu S_\z}^2} \p{\mu S_\z}^m S_\bmu^{n-1}.
\end{align}
Collecting terms and defining
\begin{align}
  \Gamma_{\z,\mu}^{(\pm)}
  &\equiv \f12\p{\Gamma_\z^* \Gamma_\mu \pm \Gamma_\bmu^* \Gamma_\z},
  \allowdisplaybreaks \\
  \tilde L_{\ell mn;\mu}^{(\Gamma)}
  &\equiv \mu \sp{\p{\ell-n+\f12} \Gamma_{\z,\mu}^{(+)}
    + \p{\ell+\f12} \Gamma_{\z,\mu}^{(-)}}
  S_\mu^{\ell+1} \p{1+\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad -\mu \sp{\p{\ell-n+\f12} \Gamma_{\z,\mu}^{(+)}
    + \p{n+\f12} \Gamma_{\z,\mu}^{(-)}}
  S_\mu^{\ell+1} \p{\mu S_\z}^m S_\bmu^n \notag \\
  &\qquad + \mu \Gamma_{\z,\mu}^{(-)}
  S_\mu^{\ell+1} \p{\mu S_\z}
  \sp{\p{1+\mu S_\z}^m - \p{\mu S_\z}^m} S_\bmu^n,
  \allowdisplaybreaks \\
  \tilde M_{\ell mn;\mu}^{(\Gamma)}
  &= -\mu n\p{n-1} \sp{\p{\ell-n+\f12} \Gamma_{\z,\mu}^{(+)}
    + \p{\ell-\f12} \Gamma_{\z,\mu}^{(-)}}
  S_\mu^\ell \p{\mu S_\z}^m S_\bmu^{n-1} \notag \\
  &\qquad - 2\mu n \sp{\p{\ell-n+\f12} \Gamma_{\z,\mu}^{(+)}
    + \p{\ell+\f12n-1} \Gamma_{\z,\mu}^{(-)}}
  S_\mu^\ell \p{\mu S_\z}^{m+1} S_\bmu^{n-1} \notag \\
  &\qquad - 2\mu n \Gamma_{\z,\mu}^{(-)}
  S_\mu^\ell \p{\mu S_\z}^{m+2} S_\bmu^{n-1},
  \allowdisplaybreaks \\
  \tilde P_{\ell mn;\mu}
  &\equiv -\f12 S_\mu^{\ell+2}
  \sp{\p{2+\mu S_\z}^m - 2\p{1+\mu S_\z}^m + \p{\mu S_\z}^m}
  S_\bmu^n \notag \\
  &\qquad + n S_\mu^{\ell+1} \sp{\p{n+2\mu S_\z} \p{1+\mu S_\z}^m
    - \p{n-1+2\mu S_\z} \p{\mu S_\z}^m}
  S_\bmu^{n-1} \notag \\
  &\qquad -n\p{n-1} S_\mu^\ell
  \sp{\f12\p{n-1}\p{n-2} + \p{2n-3}\mu S_\z + 2\p{\mu S_\z}^2}
  \p{\mu S_\z}^m S_\bmu^{n-2},
  \allowdisplaybreaks \\
  \tilde Q_{\ell mn;\mu}^{(\Gamma)}
  &\equiv \Gamma_\bmu^* \Gamma_\mu \tilde P_{\ell mn;\mu}
  + \tilde L_{\ell mn;\mu}^{(\Gamma)}
  + \tilde M_{\ell mn;\mu}^{(\Gamma)},
\end{align}
we then have
\begin{align}
  \D\p{\Gamma; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  = \sum_{X\in\set{\z,+,-}} \abs{\Gamma_X}^2
  \D\p{S_X; S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n}
  + \tilde Q_{\ell mn;\mu}^{(\Gamma)}
  + \sp{\tilde Q_{nm\ell;\mu}^{(\Gamma)}}^\dag.
\end{align}
Note that the sum $\ell+m+n$ for operators
$S_\mu^\ell \p{\mu S_\z}^n S_\bmu^n$ grows by one if $\Gamma_\mu\ne0$
or $\Gamma_\bmu\ne0$, and does not grow otherwise.


\section{Initial conditions}
\label{sec:initial_conditions}

Initial conditions for all collective spin operators can be determined
from the expansions
\begin{align}
  S_\z = \sum_{k=-S}^S k \op{k},
  &&
  S_\mu = \sum_{k=-S+\delta_{\mu,-1}}^{S-\delta_{\mu,1}}
  g_\mu\p{S,k} \op{k+\mu}{k},
\end{align}
with
\begin{align}
  g_\mu\p{S,k} \equiv \sqrt{\p{S-\mu k}\p{S+\mu k+1}},
\end{align}
and the initial states
\begin{align}
  \ket{\pm\Z} \equiv \ket{\pm S},
  &&
  \ket{\X} \equiv 2^{-N/2} \sum_{k=-S}^S
  { N \choose S+k }^{1/2} \ket{k},
\end{align}
using which we can compute, for $\mu,\nu\in\set{+1,-1}$,
$\bmu\equiv-\mu$,
\begin{align}
  \bk{\nu\Z|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\nu\Z}
  = \delta_{\ell n} \times
  \begin{cases}
     \p{S-n}^m \f{N! n!}{\p{N-n}!} & \mu = \nu, \\
     \delta_{n,0} \p{-S}^m & \mu \ne \nu,
  \end{cases}
\end{align}
and
\begin{align}
  \bk{\X|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\X}
  &=  \f{\mu^m}{2^N} \sum_{k=-S+\delta_{\mu,-1}\max\set{\ell,n}}
  ^{S-\delta_{\mu,1}\max\set{\ell,n}} k^m
  \sp{{ N \choose S+k+\mu\ell } { N \choose S+k+\mu n }}^{1/2}
  \notag \\
  &\qquad\qquad\qquad\qquad
  \times \prod_{p=0}^{\ell-1} g_\mu\p{S,k+\mu p}
  \prod_{q=0}^{n-1} g_\bmu\p{S,k+\mu\sp{n-q}} \\
  &= \mu^m \f{N!}{2^N} \sum_{k=-S+\delta_{\mu,-1}\max\set{\ell,n}}
  ^{S-\delta_{\mu,1}\max\set{\ell,n}}
  \f{k^m \p{S-\mu k}!}
  {\p{S+\mu k}!\p{S-\mu k-\ell}!\p{S-\mu k-n}!} \\
  &= \f{N!}{2^N} \sum_{k=-S}^{S-\max\set{\ell,n}}
  \f{k^m \p{S-k}!}{\p{S+k}!\p{S-k-\ell}!\p{S-k-n}!}.
\end{align}
Furthermore, using the fact that
\begin{align}
  e^{i\phi S_\z} S_\mu e^{-i\phi S_\z} = e^{i\mu\phi} S_\mu,
\end{align}
we can say
\begin{align}
  \bk{\phi|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\phi}
  = e^{i\mu\p{\ell-n}\phi} \bk{\X|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\X},
\end{align}
where
\begin{align}
  \ket{\phi} \equiv e^{-i\phi S_\z}\ket{\X},
  &&
  \p{\cos\phi S_\x + \sin\phi S_\y} \ket\phi = S \ket\phi.
\end{align}
Alternatively, with the help of Mathematica we can find
\begin{align}
  \bk{\X|S_\mu^\ell \p{\mu S_\z}^m S_\bmu^n|\X}
  = \f{\p{N!}^2}{2^N\p{N-\ell}!\p{N-n}!}
  \sp{\p{-S}^m \alpha_{N\ell n}
    + \f{\p{N-\ell}\p{N-n}}{N} \beta_{N\ell mn}},
\end{align}
where $\alpha$ and $\beta$ are defined in terms of the generalized
hypergeometric function $\F$ by
\begin{align}
  \alpha_{N\ell n}
  \equiv \F\p{\let\scriptstyle\textstyle
    \substack{\ell-N,~n-N \\ -N}~; -1},
\end{align}
and
\begin{align}
  \beta_{N\ell mn}
  \equiv \sum_{p=0}^{m-1} \p{-S}^p { m \choose p }
  \tilde\F_{m-p-1}\p{\let\scriptstyle\textstyle
    \substack{1+\ell-N,~1+n-N \\ 1-N}~; -1},
\end{align}
for
\begin{align}
  \tilde\F_q\p{\let\scriptstyle\textstyle
    \substack{a,~b\\c}~; z}
  \equiv \F\p{\let\scriptstyle\textstyle
    \substack{2,2,\cdots,2,a,b \\ 1,1,\cdots,1,c}~; z}
\end{align}
with $q$ repetitions of 2 and 1.

\end{document}

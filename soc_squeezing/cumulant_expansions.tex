\documentclass[aps,notitlepage,nofootinbib,11pt]{revtex4-1}

% linking references
\usepackage{hyperref}
\hypersetup{
  breaklinks=true,
  colorlinks=true,
  linkcolor=blue,
  filecolor=magenta,
  urlcolor=cyan,
}

%%% symbols, notations, etc.
\usepackage{physics,braket,bm,commath,amssymb} % physics and math
\renewcommand{\t}{\text} % text in math mode
\newcommand{\f}[2]{\dfrac{#1}{#2}} % shorthand for fractions
\newcommand{\p}[1]{\left(#1\right)} % parenthesis
\renewcommand{\sp}[1]{\left[#1\right]} % square parenthesis
\renewcommand{\set}[1]{\left\{#1\right\}} % curly parenthesis
\renewcommand{\v}{\bm} % bold vectors
\newcommand{\uv}[1]{\v{\hat{#1}}} % unit vectors
\renewcommand{\c}{\cdot} % inner product
\newcommand{\bk}{\Braket} % shorthand for braket notation
\renewcommand{\d}{\text{d}} % "d" for integration measure

\newcommand{\C}{\mathcal{C}}
\newcommand{\D}{\mathcal{D}}
\renewcommand{\O}{\mathcal{O}}
\renewcommand{\S}{\mathcal{S}}

\newcommand{\Z}{\mathbb{Z}}

\newcommand{\bmu}{{\bar\mu}}

\usepackage{dsfont} % for identity operator
\newcommand{\1}{\mathds{1}}

\usepackage[inline]{enumitem} % for inline enumeration

%%% figures
\usepackage{graphicx} % for figures
\usepackage{grffile} % help latex properly identify figure extensions
\usepackage[caption=false]{subfig} % subfigures (via \subfloat[]{})
\graphicspath{{./figures/}} % set path for all figures

% for strikeout text
% normalem included to prevent underlining titles in the bibliography
\usepackage[normalem]{ulem}

% for leaving notes in the text
\newcommand{\note}[1]{\textcolor{red}{#1}}


\begin{document}

\title{Solving Collective Spin Hamiltonians with Decoherence}

\author{Michael A. Perlin}

\maketitle

Previous work has shown how to realize various spin-squeezing
Hamiltonians with ultracold atomic systems.  While it is
straightforward to simulate the dynamics generated by these
Hamiltonians in the context of a closed quantum system, here we try to
develop an understanding of their the squeezing behavior in the
presence of decoherence.  In particular, we will be considering
dynamics induced by the collective one-axis twisting (OAT), two-axis
twisting (TAT), and transverse field (TVF) Hamiltonians of the form
\begin{align}
  H_{\t{OAT}} = \chi S_z^2,
  &&
  H_{\t{TAT}} = \chi \p{S_z^2 - S_y^2},
  &&
  H_{\t{TVF}} = \chi S_z^2 - \Omega S_x,
\end{align}
for spins which decay in an uncorrelated manner at a rate $\gamma$.
The evolution of any Heisenburg operator $\O$ with a Hamiltonian $H$
is given by
\begin{align}
  \f{d}{dt} \O
  = i\sp{H,\O}_- + \gamma\D\p{\O},
  &&
  \D\p{\O} \equiv \sum_j\p{\sigma_j^+\O\sigma_j^-
    - \f12\sp{\sigma_j^+\sigma_j^-,\O}_+},
  \label{eq:EOM}
\end{align}
where $\sp{A,B}_\pm\equiv AB\pm BA$ and $j$ indexes an individual
spin.  Our measure of squeezing is
\begin{align}
  \xi^2 \equiv \f{N}{\abs{\bk{\v S}}^2}
  \min_{\uv n\perp\bk{\v S}} \bk{\p{\v S\c\uv n}^2},
  \label{eq:squeezing}
\end{align}
where $N$ is the total number of spins, $\v S$ is the collective spin
vector, and the minimization is performed over all unit vectors
$\uv n$ in the plane orthogonal to the mean spin vector $\bk{\v S}$.
This squeezing parameter is entirely determined by components
$\bk{S_\alpha}$ of the mean spin vector in addition to collective
spin-spin correlators of the form $\bk{S_\alpha S_\beta}$; our task is
therefore to compute these expectation values in all scenarios of
interest.


\section{One-axis twisting}

The case of the one-axis twisting is simplest to consider, as we can
write the Hamiltonian in the form
\begin{align}
  H_{\t{OAT}} = \f14 \chi \sum_{j,k} \sigma_j^z \sigma_k^z
  = \f12 \chi \sum_{j<k} \sigma_j^z \sigma_k^z + \f14 N \chi,
\end{align}
which admits an exact solution previously worked out by Foss-Feig et
al.~in ref.~\cite{foss-feig2013nonequilibrium}.  Adapting exact
expectation values with respect to the initial state $\ket{X}$ which
has all spins pointing in $x$, in terms of $\mu,\nu\in\set{+1,-1}$ we
find that
\begin{align}
  \bk{S_+}
  &= \sum_j\bk{\sigma_j^+}
  = \f{N}{2} e^{-\gamma t/2} \Phi\p{\chi,t}^{N-1}, \label{eq:S+_OAT} \\
  \bk{S_\mu S_z}
  &= \f12\sum_j\bk{\sigma_j^\mu\sigma_j^z}
  + \f12\sum_{j\ne k} \bk{\sigma_j^\mu \sigma_k^z} \\
  &= -\f{\mu}{2}\bk{S_\mu} + \f14 N \p{N-1} e^{-\gamma t/2}
  \Psi\p{\mu\chi,t} \Phi\p{\chi,t}^{N-2}, \\
  \bk{S_\mu S_\nu}
  &= \sum_j \bk{\sigma_j^\mu \sigma_j^\nu}
  + \sum_{j\ne k} \bk{\sigma_j^\mu \sigma_k^\nu} \\
  &= \delta_{\mu,-\nu} \p{\f{N}{2} + \mu \bk{S_z}}
  + \f14 N \p{N-1} e^{-\gamma t}
  \Phi\p{\sp{\mu+\nu}\chi,t}^{N-2}, \label{eq:SS+-_OAT}
\end{align}
where
\begin{align}
  \Phi\p{\zeta,t} \equiv e^{-\gamma t/2}
  \sp{\cos\p{s_\zeta t}+\f12\gamma t~\t{sinc}\p{s_\zeta t}},
  &&
  \Psi\p{\zeta,t} \equiv e^{-\gamma t/2}
  \p{is_\zeta-\gamma/2}t~ \t{sinc}\p{s_\zeta t},
\end{align}
and $s_\zeta \equiv \zeta + i2\gamma$.  The last ingredients we need
to compute spin squeezing at any time are $\bk{S_z}$ and $\bk{S_z^2}$.
As these operators commute with the OAT Hamiltonian, their evolution
is governed entirely by decoherence, such that
\begin{align}
  \f{d}{dt}\p{S_z^n}
  = \gamma \D\p{S_z^n}
  = \gamma \p{S + S_z} \sum_{k=0}^{n-1}
  \p{-1}^{n-k} { n \choose k } S_z^k,
\end{align}
where $S\equiv N/2$ and $\D\p{S_z^n}$ is worked out in Appendix
\ref{sec:decoherence}.  In particular,
\begin{align}
  \f{d}{dt} S_z = -\gamma \p{S + S_z},
  &&
  \f{d}{dt}\p{S_z^2} = \gamma \p{S + S_z} \p{1 - 2S_z}.
\end{align}
The initial conditions $\bk{S_z}_{t=0}=0$ and $\bk{S_z^2}_{t=0}=S/2$
then imply
\begin{align}
  \bk{S_z} = S\p{e^{-\gamma t}-1},
  &&
  \bk{S_z^2} = S \p{1 - \f12 e^{-\gamma t}} e^{-\gamma t} + \bk{S_z}^2.
  \label{eq:Sz_OAT}
\end{align}
The expectation values in \eqref{eq:S+_OAT}-\eqref{eq:SS+-_OAT} and
\eqref{eq:Sz_OAT} are sufficient to compute the squeezing parameter
$\xi^2$ in \eqref{eq:squeezing} at any time throughout evolution of
the initial state $\ket{X}$ under $H_{\t{OAT}}$.


\subsection{Heisenberg systems of equations}

Unlike the one-axis twisting Hamiltonian, the two-axis twisting and
transverse-field Hamiltonians do not admit exact analytical
solutions. We will therefore solve these Hamiltonians approximately
using systems of equations for Heisenberg operators.  The basic idea
is to find equations of motion for operators of interest, and at some
point truncate high-order terms to arrive at a closed,
reasonably-sized system of equations.  To benchmark this method, we
will test it against exact one-axis twisting results.

The equations of motion for $S_\mu$, $S_\mu S_z$, and $S_\mu S_\nu$
(i.e.~where $\mu,\nu\in\set{+1,-1}$) under the OAT Hamiltonian
$H_{\t{OAT}}=\chi S_z^2$ are determined by
\begin{align}
  \f{d}{dt} \p{S_+^\ell S_-^m S_z^n}
  = i\chi \sp{S_z^2, S_+^\ell S_-^m S_z^n}_-
  + \gamma \D\p{S_+^\ell S_-^m S_z^n},
\end{align}
where we can use identity \eqref{eq:comm_z_mu_nu_pow} to simplify
\begin{align}
  \sp{S_z^2, S_+^\ell S_-^m S_z^n}_-
  = \sp{S_z^2, S_+^\ell S_-^m}_- S_z^n
  = S_+^\ell S_-^m \p{\sp{\ell-m}^2 + 2\sp{\ell-m} S_z} S_z^n,
\end{align}
and the effect of decoherence through $\D\p{S_+^\ell S_-^m S_z^n}$ is
worked out in Appendix \ref{sec:decoherence}.  In order to compute
squeezing of the OAT Hamiltonian in the presence of single-spin decay,
we therefore need to solve the systems of equations defined by
\begin{align}
  \f{d}{dt} \p{S_\mu S_z^n}
  = i\chi S_\mu \p{1 + 2\mu S_z} S_z^n
  + \gamma S_\mu \sp{\p{S - \delta_{\mu,-1} + S_z} \sum_{k=0}^{n-1}
    \p{-1}^{n-k} { n \choose k } S_z^k - \f12 S_z^n}
\end{align}
and
\begin{multline}
  \f{d}{dt} \p{S_\mu S_\nu S_z^n}
  = i\chi S_\mu S_\nu \p{\sp{\mu+\nu}^2 + 2 \sp{\mu+\nu} S_z} S_z^n \\
  + \gamma S_\mu S_\nu
  \sp{\p{S - \delta_{\mu,-1} - \delta_{\nu,-1} + S_z} \sum_{k=0}^{n-1}
    \p{-1}^{n-k} { n \choose k } S_z^k - S_z^n},
\end{multline}
for $\mu\ge\nu$.  The initial conditions for these systems of equations can be determined from the expansions
\begin{align}
  S_\mu = \sum_{m=-S}^S \sqrt{\p{S-\mu m}\p{S+\mu m+1}} \op{m+\mu}{m},
  &&
  S_z^n = \sum_{m=-S}^S m^n \op{m},
\end{align}
and the initial state
\begin{align}
  \ket{X} = 2^{-N/2} \sum_{m=-S}^S { N \choose S+m }^{1/2} \ket{m},
\end{align}
from which we can determine
\begin{align}
  \bk{S_\mu S_z^n}_{t=0}
  &= 2^{-N} \sum_{m=-S}^S m^n
  \sp{{ N \choose S+m } { N \choose S+m+\mu }
    \p{S-\mu m}\p{S+\mu m+1}}^{1/2} \\
  &= 2^{-N} \sum_{m=-S}^S m^n { N \choose S+m } \abs{m - \mu S},
\end{align}
and
\begin{multline}
  \bk{S_\mu S_\nu S_z^n}_{t=0}
  = 2^{-N} \sum_{m=-S}^S m^n
  \sp{{ N \choose S+m } { N \choose S+m+\mu+\nu }}^{1/2} \\
  \times \sp{\p{S-\nu\sp{m+\nu}}\p{S+\mu\sp{m+\nu}+1}
    \p{S-\nu m}\p{S+\nu m+1}}^{1/2}.
\end{multline}


\section{One-axis twisting with a transverse field}

We now consider again squeezing the initial state $\ket{X}$, but this
time with the transverse field Hamiltonian
\begin{align}
  H_{\t{TVF}}
  \equiv \chi S_z^2- \Omega S_x.
\end{align}
To determine the coherent evolution of the operator
$S_\mu^m S_\nu^n S_z^n$, we now need to compute
\begin{align}
  \sp{H_{\t{TVF}}, S_\mu^m S_\nu^n S_z^n}_-
  = \chi \sp{S_z^2, S_\mu^m S_\nu^n S_z^n}_-
  - \Omega \sp{S_x, S_\mu^m S_\nu^n S_z^n}_-.
\end{align}
Here first commutator is identical to that for OAT, while


\bibliography{\jobname}

\newpage
\appendix

\section{Basic spin operator identities}
\label{sec:identities}

This text makes ubiquitous use of various spin operator identities; we
collect and derive particularly useful identities here for reference.
The elementary commutation relations between single-weight spin
operators are
\begin{align}
  \f12 \sp{\sigma_j^z,\sigma_k^\mu}_-
  &= \delta_{jk} \mu \sigma_j^\mu,
  &
  \sp{S_z,\sigma_j^\mu}_-
  &= \f12 \sp{\sigma_j^z,S_\mu}_- = \mu \sigma_j^\mu,
  &
  \sp{S_z,S_\mu}_-
  &= \mu S_\mu,
  \label{eq:comm_z_mu} \\
  \sp{\sigma_j^\mu,\sigma_k^\nu}_-
  &= \delta_{jk} \delta_{\mu,-\nu} \mu \sigma_j^z,
  &
  \sp{S_\mu,\sigma_j^\nu}_-
  &= \sp{\sigma_j^\mu,S_\nu}_-
  = \delta_{\mu,-\nu} \mu \sigma_j^z,
  &
  \sp{S_\mu,S_\nu}_-
  &= \delta_{\mu,-\nu} 2 \mu S_z.
  \label{eq:comm_mu_nu}
\end{align}
These relations can be used to inductively determine commutation
relations between higher-weight spin operators.  In particular, we can
find that
\begin{align}
  S_z S_\mu^m
  = \p{\mu S_\mu + S_\mu S_z} S_\mu^{m-1}
  = \mu S_\mu^m + S_\mu S_z S_\mu^{m-1}
  = 2 \mu S_\mu^m + S_\mu S_z S_\mu^{m-2}
  = S_\mu^m \p{\mu m + S_z},
  \label{eq:push_z_mu}
\end{align}
and in turn
\begin{align}
  S_z S_\mu^m S_\nu^n
  = S_\mu^m \p{\mu m + S_z} S_\nu^n
  = S_\mu^m S_\nu^n \p{\mu m + \nu n + S_z}.
  \label{eq:push_z_mu_nu}
\end{align}
Repeating this process $\ell$ times tells us
\begin{align}
  S_z^\ell S_\mu^m S_\nu^n
  = S_\mu^m S_\nu^n \p{\mu m + \nu n + S_z}^\ell,
\end{align}
which implies
\begin{align}
  \sp{S_z^\ell, S_\mu^m S_\nu^n}_-
  = S_\mu^m S_\nu^n \p{\sp{\mu m + \nu n + S_z}^\ell - S_z^\ell}
  = S_\mu^m S_\nu^n  \sum_{k=0}^{\ell-1} {\ell \choose k}
  \p{\mu m + \nu n}^{\ell-k} S_z^k.
  \label{eq:comm_z_mu_nu_pow}
\end{align}


\section{Commutators between high-weight transverse spin operators}

To determine commutation relations between high-weight operators
transverse to the decoherence (i.e.~$z$) axis, we compute (with
$\bmu\equiv-\mu$ for brevity)
\begin{align}
  S_\mu S_\bmu^n
  &= \p{2\mu S_z + S_\bmu S_\mu} S_\bmu^{n-1} \\
  &= 2\mu S_z S_\bmu^{n-1} + S_\bmu S_\mu S_\bmu^{n-1} \\
  &= 2\mu S_z S_\bmu^{n-1}
  + S_\bmu \sp{2\mu S_z S_\bmu^{n-2}
    + S_\bmu S_\mu S_\bmu^{n-2}} \\
  &= 2\mu \p{S_z S_\bmu^{n-1} + S_\bmu S_z S_\bmu ^{n-2}}
  + S_\bmu^2 S_\mu S_\bmu^{n-2} \\
  &= 2\mu \p{S_z S_\bmu^{n-1} + S_\bmu S_z S_\bmu ^{n-2}
    + S_\bmu^2 S_z S_\bmu ^{n-3}} + S_\bmu^3 S_\mu S_\bmu^{n-3} \\
  &= 2\mu \sum_{k=0}^{n-1} S_\bmu^k S_z S_\bmu^{n-k-1}
  + S_\bmu^n S_\mu.
  \label{eq:comm_mu_nu_single}
\end{align}
While \eqref{eq:comm_mu_nu_single} gives us the commutator
$\sp{S_\mu,S_\bmu^n}_-$, we would like to enforce an ordering on
products of collective spin operators, which allows us to only keep
track of high-weight operators which are linearly independent.  We
(arbitrarily) choose to impose an ordering with all $S_z$ operators on
the right.  This choice of ordering compels us to expand
\begin{align}
  2 \mu \sum_{k=0}^{n-1} S_\bmu^k S_z S_\bmu^{n-k-1}
  = 2 \mu \sum_{k=0}^{n-1}
  S_\bmu^k S_\bmu^{n-k-1} \p{\bmu\sp{n-k-1} + S_z}
  = n S_\bmu^{n-1}\p{1 - n + 2\mu S_z},
\end{align}
so
\begin{align}
  \sp{S_\mu, S_\bmu^n}_-
  = n S_\bmu^{n-1}\p{1 - n + 2\mu S_z}.
\end{align}
As the next logical step, we take on the task of computing
\begin{align}
  S_\mu^m S_\bmu^n
  &= S_\mu^{m-1} \sp{n S_\bmu^{n-1}\p{1 - n + 2\mu S_z}
    + S_\bmu^n S_\mu} \\
  &= n \sp{S_\mu^{m-1} S_\bmu^{n-1} \p{1 - n + 2\mu S_z}}
  + S_\mu^{m-1} S_\bmu^n S_\mu \\
  &= n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_z} S_\mu^k + S_\bmu^n S_\mu^m,
\end{align}
which implies
\begin{align}
  \sp{S_\mu^m, S_\bmu^n}_-
  = C_{\mu mn}
  \equiv n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_z} S_\mu^k.
\end{align}
We now need rearrange the operators in $C_{\mu mn}$ into a standard
order, which means pushing all $S_z$ operators to the right and, for
the purposes of this calculation, all $S_\bmu$ operators on the left.
We begin by pushing $S_\mu^k$ to the left of $S_z$, which takes
$2\mu S_z\to 2\mu S_z+2k$, and then push $S_\mu^{m-k-1}$ to the right
of $S_\bmu^{n-1}$, giving us
\begin{align}
  C_{\mu mn}
  &= n \sum_{k=0}^{m-1}
  \p{S_\bmu^{n-1} S_\mu^{m-k-1} + C_{\mu,m-k-1,n-1}} S_\mu^k
  \p{2k + 1 - n + 2\mu S_z} \\
  &= D_{\mu mn}
  + n \sum_{k=0}^{m-2} C_{\mu,m-k-1,n-1}
  S_\mu^k \p{2k + 1 - n + 2\mu S_z},
  \label{eq:C_mn}
\end{align}
where we have dropped the last term in the final sum because
$C_{\mu,m-k-1,n-1}=\sp{S_\mu^{m-k-1},S_\bmu^{n-1}}_-=0$ if $k=m-1$,
and
\begin{align}
  D_{\mu mn}
  \equiv mn S_\bmu^{n-1} S_\mu^{m-1} \p{m - n + 2\mu S_z}.
  \label{eq:D_mn}
\end{align}
To our despair, we have arrived in \eqref{eq:C_mn} to a {\it
  recursive} expression for $C_{\mu mn}$, and we have not even managed
to order the spin operators, as $C_{\mu,m-k-1,n-1}$ contains $S_z$
operators which are to the left of $S_\mu^k$.  To sort all spin
operators once and for all, we define
\begin{align}
  C_{\mu mn}^{(k)} \equiv C_{\mu,m-k,n} S_\mu^k,
  &&
  D_{\mu mn}^{(k)} \equiv D_{\mu,m-k,n} S_\mu^k,
\end{align}
which we can expand as
\begin{align}
  D_{\mu mn}^{(k)}
  &\equiv D_{\mu,m-k,n}S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-k-1}
  \p{m-k-n+2\mu S_z} S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-1} \p{k+m-n+2\mu S_z},
  \label{eq:D_mn_k}
\end{align}
and
\begin{align}
  C_{\mu mn}^{(k)}
  &= D_{\mu,m-k,n} S_\mu^k + n \sum_{j=0}^{m-k-2}
  C_{\mu,m-k-j-1,n-1} S_\mu^j \p{2j+1-n+2\mu S_z} S_\mu^k \\
  &= D_{\mu mn}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{\mu,m-k-j-1,n-1} S_\mu^{j+k} \p{2j+2k+1-n+2\mu S_z} \\
  &= D_{\mu mn}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{\mu,m-1,n-1}^{(k+j)} \p{2\sp{j+k}+1-n+2\mu S_z} \\
  &= D_{\mu mn}^{(k)} + n \sum_{j=k}^{m-2}
  C_{\mu,m-1,n-1}^{(j)} \p{2j+1-n+2\mu S_z}.
  \label{eq:C_mn_k}
\end{align}
While the resulting expression strongly resembles that in
\eqref{eq:C_mn}, there is one crucial difference: all spin operators
in \eqref{eq:C_mn_k} have been ordered.  We can now repeatedly
substitute $C_{\mu mn}^{(k)}$ into itself, each time decreasing $m$
and $n$ by 1, until one of $m$ or $n$ reaches zero.  Such repeated
substitution yields the expansion
\begin{align}
  C_{\mu mn}
  = C_{\mu mn}^{(0)}
  = D_{\mu mn}
  + \sum_{p=1}^{\min\set{m,n}-1} E_{\mu mn}^{(p)},
  \label{eq:C_mn_E}
\end{align}
where the first terms in the sum over $p$ is
\begin{align}
  E_{\mu mn}^{(1)}
  = n \sum_{k=0}^{m-2} D_{\mu,m-1,n-1}^{(k)}
  \p{2k+1-n+2\mu S_z},
\end{align}
the second
\begin{align}
  E_{\mu mn}^{(2)}
  = n \sum_{k_1=0}^{m-2} \p{n-1} \sum_{k_2=k_1}^{m-3}
  D_{\mu,m-2,n-2}^{(k_2)}
  \p{2k_2+2-n+2\mu S_z} \p{2k_1+1-n+2\mu S_z},
\end{align}
and more generally for $p>1$,
\begin{align}
  E_{\mu mn}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{k_1=0}^{m-2}\cdots\sum_{k_p=k_{p-1}}^{m-p-1}
  D_{\mu,m-p,n-p}^{(k_p)} \prod_{j=1}^p \p{2k_j+j-n+2\mu S_z}.
  \label{eq:E_mn_p}
\end{align}
In principle, the expressions in \eqref{eq:D_mn} and
\eqref{eq:C_mn_E}-\eqref{eq:E_mn_p} provide a well-defined expansion
for the commutator $\sp{S_\mu^m,S_\nu^n}_- = C_{\mu mn}$, but the
expression for $E_{\mu mn}^{(p)}$ in \eqref{eq:E_mn_p} is -- put it
lightly -- quite a mess, involving a sum over $p$ mutually related
intermediate variables!  We therefore devote the rest of this section
to simplifying $E_{\mu mn}^{(p)}$.

Observing that we always have $k_1\le k_2\le\cdots\le k_p$, we can
reverse the order of the sums in \eqref{eq:E_mn_p} and re-index
$k_p\to\ell$ to get
\begin{align}
  E_{\mu mn}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{\ell=0}^{m-p-1} D_{\mu,m-p,n-p}^{(\ell)} \p{2\ell+p-n+2\mu S_z}
  \sum_{\substack{\v k\in\Z_{\ell+1}^{p-1}\\k_{p-1}\ge\cdots\ge k_1}}
  \prod_{j=1}^{p-1} \p{2k_j+j-n+2\mu S_z},
\end{align}
where $\Z_q$ denotes the set of $q$ smallest non-negative integers,
e.g.~$\Z_{\ell+1}=\set{0,1,\cdots,\ell}$.  Defining for shorthand
\begin{align}
  \sum_{\p{\v k,p,\ell}} X \equiv
  \sum_{\substack{\v k\in\Z_{\ell+1}^{p-1}\\k_{p-1}\ge\cdots\ge k_1}} X,
  &&
  F_{\mu np} \equiv p - n + 2\mu S_z,
\end{align}
we can say
\begin{align}
  E_{\mu mn}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{\ell=0}^{m-p-1} D_{\mu,m-p,n-p}^{(\ell)} \p{2\ell+F_{\mu np}}
  \sum_{\p{\v k,p,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{\mu np}}.
  \label{eq:E_mn_p_k_sum}
\end{align}
We now define
\begin{align}
  f_{\mu np\ell}\p{k,q} \equiv \p{\ell-k+q} \p{\ell+k-q+F_{\mu np}},
\end{align}
and evaluate sums successively over $k_{p-1},k_{p-2},\cdots,k_2,k_1$
respectively from $k_{p-2},k_{p-3},\cdots,k_1,0$ to $\ell$, finding
\begin{align}
  \sum_{\p{\v k,p,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{\mu np}}
  &= \sum_{\p{\v k;p-1;\ell}}
  \prod_{j=2}^{p-1} \p{2k_{p-j}-j+F_{\mu np}}
  f_{\mu n\ell}\p{k_{p-2},1} \\
  &= \f12 \sum_{\p{\v k,p-2,\ell}}
  \prod_{j=3}^{p-1} \p{2k_{p-j}-j+F_{\mu np}}
  f_{\mu np\ell}\p{k_{p-3},1} f_{\mu np\ell}\p{k_{p-3},2} \\
  &= \f1{r!} \sum_{\p{\v k,p-r,\ell}}
  \prod_{j=1+r}^{p-1} \p{2k_{p-j}-j+F_{\mu np}}
  \prod_{q=1}^r f_{\mu np\ell}\p{k_{p-1-r},q} \\
  &= \f1{\p{p-1}!} \prod_{q=1}^{p-1} f_{\mu np\ell}\p{0,q} \\
  &= { \ell + p - 1 \choose p - 1 }
  \prod_{q=1}^{p-1} \p{\ell-q+F_{\mu np}}.
\end{align}
Substitution of this result together with $D_{\mu,m-p,n-p}^{(\ell)}$
as given in using \eqref{eq:D_mn_k} into $E_{\mu mn}^{(p)}$ as
expressed in \eqref{eq:E_mn_p_k_sum} then gives us
\begin{align}
  E_{\mu mn}^{(p)}
  = \f{n!}{\p{n-p-1}!} S_\bmu^{n-p-1} S_\mu^{m-p-1} G_{\mu mnp}
  \label{eq:E_mn_p_G}
\end{align}
with
\begin{align}
  G_{\mu mnp}
  \equiv
  \sum_{\ell=0}^{m-p-1} { \ell + p - 1 \choose p - 1 }
  \p{m-p-\ell} \p{\ell+m-p+F_{\mu np}}
  \p{2\ell + F_{\mu np}}
  \prod_{q=1}^{p-1} \p{\ell-q+F_{\mu np}}.
\end{align}


% \vspace{3cm}

% With reference to \eqref{eq:E_mn_p_G}, we finally have
% \begin{align}
%   \sp{S_\mu^m, S_\bmu^n}_-
%   = C_{\mu mn}
%   = mn S_\bmu^{n-1} S_\mu^{m-1}
%   \sum_{q\in\set{0,1}} \p{m-n}^{1-q}\p{2\mu S_z}^q
%   + \sum_{p=1}^{\min\set{m,n}-1} E_{\mu mn}^{(p)}.
% \end{align}


% \begin{align}
%   \prod_{j=1}^{p-1} \p{2k_j+j-n+2\mu S_z}
%   = \sum_{q=0}^{p-1} \p{2\mu S_z}^q
%   \sum_{c\in\C_{p-1-q}\p{\Z_{p-1}}} \prod_{j\in c} \p{2k_{j+1}+j+1-n},
%   \label{eq:product_expansion}
% \end{align}
% where $\C\p{k,\S}$ denotes the set of $k$-combinations (i.e.~subsets
% with $k$ elements) of $\S$; the number of elements in
% $\C_{p-1-q}\p{\Z_{p-1}}$ is
% ${ p-1 \choose p-1-q } = { p-1 \choose q }$.

\vspace{3cm}

To derive a system of equations for the two-axis twisting Hamiltonian
we need to know $\sp{S_\mu^2,S_\bmu^n}_-$, so we expand
\begin{align}
  \sp{S_\mu^2,S_\bmu^n}_-
  = C_{\mu mn}
  = D_{\mu,2,n} + n D_{\mu,1,n-1} \p{1 - n + 2\mu S_z}
\end{align}


\newpage

\section{Decoherence of Heisenberg spin operators}
\label{sec:decoherence}

The decoherence operator for uncorrelated single-spin decay at a
uniform rate is
\begin{align}
  \D\p{\O}
  \equiv \sum_j\p{\sigma_j^+\O\sigma_j^-
    - \f12\sp{\sigma_j^+\sigma_j^-,\O}_+},
\end{align}
where
\begin{align}
  \sum_j \f12\sp{\sigma_j^+\sigma_j^-,\O}_+
  = \f12\sp{S+S_z,\O}_+
  = S\O + \f12\sp{S_z,\O}_+
  = \O\p{S+S_z} + \f12\sp{S_z,\O}_-,
\end{align}
so
\begin{align}
  \D\p{\O}
  = \sum_j \sigma_j^+\O\sigma_j^- - \O\p{S + S_z} - \f12 \sp{S_z,\O}_-.
\end{align}
We are interested in the effect of this decoherence on the dynamics of
collective spin operators, all of which are determined by operators of
the form $S_+^\ell S_-^m S_z^n$.  We thus expand
\begin{align}
  \D\p{S_+^\ell S_-^m S_z^n}
  = \sum_j \sigma_j^+ S_+^\ell S_-^m S_z^n \sigma_j^-
  - S_+^\ell S_-^m S_z^n \p{S + S_z}
  - \f12 \sp{S_z, S_+^\ell S_-^m S_z^n}_-.
  \label{eq:D_z+-}
\end{align}
The last term in \eqref{eq:D_z+-} is straightforward to simplify using
\eqref{eq:push_z_mu_nu}:
\begin{align}
  \f12 \sp{S_z, S_+^\ell S_-^m S_z^n}_-
  = \f12 \sp{S_z, S_+^\ell S_-^m}_- S_z^n
  = \f12 \p{\ell-m} S_+^\ell S_-^m S_z^n,
\end{align}
while the first term in \eqref{eq:D_z+-} can be written in terms of
collective spin operators if we use
\eqref{eq:comm_z_mu}-\eqref{eq:comm_mu_nu} to push the jump operators
together:
\begin{align}
  \sum_j \sigma_j^+ S_+^\ell S_-^m S_z^n \sigma_j^-
  = \sum_j S_+^\ell \sigma_j^+ \sigma_j^- S_-^m \p{S_z-1}^n
  = S_+^\ell \p{S + S_z} S_-^m
  \sum_{k=0}^n \p{-1}^{n-k} { n \choose k } S_z^k.
\end{align}
Finally, we need to push the middle $S_z$ to the right, which we can
do using \eqref{eq:push_z_mu}:
\begin{align}
  \sum_j \sigma_j^+ S_+^\ell S_-^m S_z^n \sigma_j^-
  = S_+^\ell S_-^m \p{S - m + S_z}
  \sum_{k=0}^n \p{-1}^{n-k} { n \choose k } S_z^k.
\end{align}
Putting everything together, we have that
\begin{align}
  \D\p{S_+^\ell S_-^m S_z^n}
  &= S_+^\ell S_-^m \sp{\p{S - m + S_z} \sum_{k=0}^n
    \p{-1}^{n-k} { n \choose k } S_z^k
    - \p{S + S_z + \f12\sp{\ell-m}} S_z^n} \\
  &= S_+^\ell S_-^m \sp{\p{S - m + S_z} \sum_{k=0}^{n-1}
    \p{-1}^{n-k} { n \choose k } S_z^k - \f12 \p{\ell+m} S_z^n}.
\end{align}

\end{document}

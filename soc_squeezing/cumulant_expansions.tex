\documentclass[aps,notitlepage,nofootinbib,11pt]{revtex4-1}

% linking references
\usepackage{hyperref}
\hypersetup{
  breaklinks=true,
  colorlinks=true,
  linkcolor=blue,
  filecolor=magenta,
  urlcolor=cyan,
}

%%% symbols, notations, etc.
\usepackage{physics,braket,bm,commath,amssymb} % physics and math
\renewcommand{\t}{\text} % text in math mode
\newcommand{\f}[2]{\dfrac{#1}{#2}} % shorthand for fractions
\newcommand{\p}[1]{\left(#1\right)} % parenthesis
\renewcommand{\sp}[1]{\left[#1\right]} % square parenthesis
\renewcommand{\set}[1]{\left\{#1\right\}} % curly parenthesis
\renewcommand{\v}{\bm} % bold vectors
\newcommand{\uv}[1]{\v{\hat{#1}}} % unit vectors
\renewcommand{\c}{\cdot} % inner product
\newcommand{\bk}{\Braket} % shorthand for braket notation
\renewcommand{\d}{\text{d}} % "d" for integration measure

\newcommand{\C}{\mathcal{C}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\I}{\mathcal{I}}
\renewcommand{\O}{\mathcal{O}}
\renewcommand{\S}{\mathcal{S}}

\newcommand{\Z}{\mathbb{Z}}

\newcommand{\bmu}{{\bar\mu}}

\usepackage{dsfont} % for identity operator
\newcommand{\1}{\mathds{1}}

\usepackage[inline]{enumitem} % for inline enumeration

%%% figures
\usepackage{graphicx} % for figures
\usepackage{grffile} % help latex properly identify figure extensions
\usepackage[caption=false]{subfig} % subfigures (via \subfloat[]{})
\graphicspath{{./figures/}} % set path for all figures

% for strikeout text
% normalem included to prevent underlining titles in the bibliography
\usepackage[normalem]{ulem}

% for leaving notes in the text
\newcommand{\note}[1]{\textcolor{red}{#1}}


\begin{document}

\title{Solving Collective Spin Hamiltonians with Decoherence}

\author{Michael A. Perlin}

\maketitle

Previous work has shown how to realize various spin-squeezing
Hamiltonians with ultracold atomic systems.  While it is
straightforward to simulate the dynamics generated by these
Hamiltonians in the context of a closed quantum system, here we try to
develop an understanding of their the squeezing behavior in the
presence of decoherence.  In particular, we will be considering
dynamics induced by the collective one-axis twisting (OAT), two-axis
twisting (TAT), and transverse field (TVF) Hamiltonians of the form
\begin{align}
  H_{\t{OAT}} = \chi S_z^2,
  &&
  H_{\t{TAT}}^{z,y} = \chi \p{S_z^2 - S_y^2},
  &&
  H_{\t{TVF}} = \chi S_z^2 - \Omega S_x,
\end{align}
for spins which decay in an uncorrelated manner at a rate $\gamma$.
The evolution of any Heisenburg operator $\O$ with a Hamiltonian $H$
is given by
\begin{align}
  \f{d}{dt} \O
  = i\sp{H,\O}_- + \gamma\D_-\p{\O},
  &&
  \D_-\p{\O} \equiv \sum_j\p{\sigma_j^+\O\sigma_j^-
    - \f12\sp{\sigma_j^+\sigma_j^-,\O}_+},
  \label{eq:EOM}
\end{align}
where $\sp{A,B}_\pm\equiv AB\pm BA$ and $j$ indexes an individual
spin.  Our measure of squeezing is
\begin{align}
  \xi^2 \equiv \f{N}{\abs{\bk{\v S}}^2}
  \min_{\uv n\perp\bk{\v S}} \bk{\p{\v S\c\uv n}^2},
  \label{eq:squeezing}
\end{align}
where $N$ is the total number of spins, $\v S$ is the collective spin
vector, and the minimization is performed over all unit vectors
$\uv n$ in the plane orthogonal to the mean spin vector $\bk{\v S}$.
This squeezing parameter is entirely determined by components
$\bk{S_\alpha}$ of the mean spin vector in addition to collective
spin-spin correlators of the form $\bk{S_\alpha S_\beta}$; our task is
therefore to compute these expectation values in all scenarios of
interest.


\section{One-axis twisting}

The case of the one-axis twisting is simplest to consider, as we can
write the Hamiltonian in the form
\begin{align}
  H_{\t{OAT}} = \f14 \chi \sum_{j,k} \sigma_j^z \sigma_k^z
  = \f12 \chi \sum_{j<k} \sigma_j^z \sigma_k^z + \f14 N \chi,
\end{align}
which admits an exact solution previously worked out by Foss-Feig et
al.~in ref.~\cite{foss-feig2013nonequilibrium}.  Adapting exact
expectation values with respect to the initial state $\ket{X}$ which
has all spins pointing in $x$, in terms of $\mu,\nu\in\set{+1,-1}$ we
find that
\begin{align}
  \bk{S_+}
  &= \sum_j\bk{\sigma_j^+}
  = \f{N}{2} e^{-\gamma t/2} \Phi\p{\chi,t}^{N-1}, \label{eq:S+_OAT} \\
  \bk{S_\mu S_z}
  &= \f12\sum_j\bk{\sigma_j^\mu\sigma_j^z}
  + \f12\sum_{j\ne k} \bk{\sigma_j^\mu \sigma_k^z} \\
  &= -\f{\mu}{2}\bk{S_\mu} + \f14 N \p{N-1} e^{-\gamma t/2}
  \Psi\p{\mu\chi,t} \Phi\p{\chi,t}^{N-2}, \\
  \bk{S_\mu S_\nu}
  &= \sum_j \bk{\sigma_j^\mu \sigma_j^\nu}
  + \sum_{j\ne k} \bk{\sigma_j^\mu \sigma_k^\nu} \\
  &= \delta_{\mu,-\nu} \p{\f{N}{2} + \mu \bk{S_z}}
  + \f14 N \p{N-1} e^{-\gamma t}
  \Phi\p{\sp{\mu+\nu}\chi,t}^{N-2}, \label{eq:SS+-_OAT}
\end{align}
where
\begin{align}
  \Phi\p{\zeta,t} \equiv e^{-\gamma t/2}
  \sp{\cos\p{s_\zeta t}+\f12\gamma t~\t{sinc}\p{s_\zeta t}},
  &&
  \Psi\p{\zeta,t} \equiv e^{-\gamma t/2}
  \p{is_\zeta-\gamma/2}t~ \t{sinc}\p{s_\zeta t},
\end{align}
and $s_\zeta \equiv \zeta + i2\gamma$.  The last ingredients we need
to compute spin squeezing at any time are $\bk{S_z}$ and $\bk{S_z^2}$.
As these operators commute with the OAT Hamiltonian, their evolution
is governed entirely by decoherence, such that
\begin{align}
  \f{d}{dt}\p{S_z^n}
  = \gamma \D_-\p{S_z^n}
  = \gamma \p{S + S_z} \sum_{k=0}^{n-1}
  \p{-1}^{n-k} { n \choose k } S_z^k,
\end{align}
where $S\equiv N/2$ and $\D_-\p{S_z^n}$ is worked out in Appendix
\ref{sec:decoherence}.  In particular,
\begin{align}
  \f{d}{dt} S_z = -\gamma \p{S + S_z},
  &&
  \f{d}{dt}\p{S_z^2} = \gamma \p{S + S_z} \p{1 - 2S_z}.
\end{align}
The initial conditions $\bk{S_z}_{t=0}=0$ and $\bk{S_z^2}_{t=0}=S/2$
then imply
\begin{align}
  \bk{S_z} = S\p{e^{-\gamma t}-1},
  &&
  \bk{S_z^2} = S \p{1 - \f12 e^{-\gamma t}} e^{-\gamma t} + \bk{S_z}^2.
  \label{eq:Sz_OAT}
\end{align}
The expectation values in \eqref{eq:S+_OAT}-\eqref{eq:SS+-_OAT} and
\eqref{eq:Sz_OAT} are sufficient to compute the squeezing parameter
$\xi^2$ in \eqref{eq:squeezing} at any time throughout evolution of
the initial state $\ket{X}$ under $H_{\t{OAT}}$.


\subsection{Heisenberg systems of equations}

Unlike the one-axis twisting Hamiltonian, the two-axis twisting and
transverse-field Hamiltonians do not admit exact analytical
solutions. We will therefore solve these Hamiltonians approximately
using systems of equations for Heisenberg operators.  The basic idea
is to find equations of motion for operators of interest, and at some
point truncate high-order terms to arrive at a closed,
reasonably-sized system of equations.  To benchmark this method, we
will test it against exact one-axis twisting results.

The equations of motion for $S_\mu$, $S_\mu S_z$, and $S_\mu S_\nu$
(i.e.~where $\mu,\nu\in\set{+1,-1}$) under the OAT Hamiltonian
$H_{\t{OAT}}=\chi S_z^2$ are determined by
\begin{align}
  \f{d}{dt} \p{S_+^\ell S_-^m S_z^n}
  = i\chi \sp{S_z^2, S_+^\ell S_-^m S_z^n}_-
  + \gamma \D_-\p{S_+^\ell S_-^m S_z^n},
\end{align}
where we can use identity \eqref{eq:comm_z_mu} to simplify
\begin{align}
  \sp{S_z^2, S_+^\ell S_-^m S_z^n}_-
  = \sp{S_z^2, S_+^\ell S_-^m}_- S_z^n
  = S_+^\ell S_-^m \p{\sp{\ell-m}^2 + 2\sp{\ell-m} S_z} S_z^n,
  \label{eq:S_z^2_comm}
\end{align}
and the effect of decoherence through $\D_-\p{S_+^\ell S_-^m S_z^n}$ is
worked out in Appendix \ref{sec:decoherence}.  In order to compute
squeezing of the OAT Hamiltonian in the presence of single-spin decay,
we therefore need to solve the systems of equations defined by
\begin{align}
  \f{d}{dt} \p{S_\mu S_z^n}
  = i\chi S_\mu \p{1 + 2\mu S_z} S_z^n
  + \gamma S_\mu \sp{\p{S - \delta_{\mu,-1} + S_z} \sum_{k=0}^{n-1}
    \p{-1}^{n-k} { n \choose k } S_z^k - \f12 S_z^n}
  \label{eq:evolution_OAT_single}
\end{align}
and
\begin{align}
  \f{d}{dt} \p{S_\mu S_\nu S_z^n}
  &= i\chi S_\mu S_\nu \p{\sp{\mu+\nu}^2 + 2 \sp{\mu+\nu} S_z} S_z^n
  \tag*{} \\
  &\quad + \gamma S_\mu S_\nu
  \sp{\p{S - \delta_{\mu,-1} - \delta_{\nu,-1} + S_z} \sum_{k=0}^{n-1}
    \p{-1}^{n-k} { n \choose k } S_z^k - S_z^n},
  \eqref{eq:evolution_OAT_pair}
\end{align}
for $\mu\ge\nu$.  The initial conditions for these systems of
equations can be determined from the expansions
\begin{align}
  S_\mu = \sum_{m=-S}^S \sqrt{\p{S-\mu m}\p{S+\mu m+1}} \op{m+\mu}{m},
  &&
  S_z^n = \sum_{m=-S}^S m^n \op{m},
\end{align}
and the initial state
\begin{align}
  \ket{X} = 2^{-N/2} \sum_{m=-S}^S { N \choose S+m }^{1/2} \ket{m},
\end{align}
from which we can determine
\begin{align}
  \bk{S_\mu S_z^n}_{t=0}
  &= 2^{-N} \sum_{m=-S}^S m^n
  \sp{{ N \choose S+m } { N \choose S+m+\mu }
    \p{S-\mu m}\p{S+\mu m+1}}^{1/2} \\
  &= 2^{-N} \sum_{m=-S}^S m^n { N \choose S+m } \abs{m - \mu S},
\end{align}
and
\begin{multline}
  \bk{S_\mu S_\nu S_z^n}_{t=0}
  = 2^{-N} \sum_{m=-S}^S m^n
  \sp{{ N \choose S+m } { N \choose S+m+\mu+\nu }}^{1/2} \\
  \times \sp{\p{S-\nu\sp{m+\nu}}\p{S+\mu\sp{m+\nu}+1}
    \p{S-\nu m}\p{S+\nu m+1}}^{1/2}.
\end{multline}

\subsection{Operator imbalance, conservation laws, and time evolution}

For convenience of language, for collective spin operators of the form
$S_+^\ell S_-^m S_z^n$ we respectively define the {\it upper}, {\it
  lower}, and {\it net imbalance}
\begin{align}
  \I_+\p{S_+^\ell S_-^m S_z^n} \equiv \ell,
  &&
  \I_-\p{S_+^\ell S_-^m S_z^n} \equiv m,
  &&
  \I\p{S_+^\ell S_-^m S_z^n} \equiv \ell - m.
\end{align}
In the case of one-axis twisting, both upper and lower (and net)
imbalances are {\it conserved}, meaning that operators with upper and
lower imbalances $\p{\ell,m}$ depend only on other operators with the
same imbalances.  We can therefore divide the task of operator time
evolution into sectors of constant imbalances, which greatly reduces
computational overhead.  Specifically, operator time evolution now
involves evolving ``operator vectors''
\begin{align}
  \v V_{\t{OAT}}^{(\ell,m)}
  \equiv S_+^\ell S_-^m \sum_{n\ge0} S_z^n \uv x_n,
\end{align}
which in practice must be truncated at some maximal $n=M$.  In the
case of OAT, the time derivative of $S_+^\ell S_-^m S_z^n$ depends on
$S_+^\ell S_-^m S_z^{n+1}$ which implies that we can only trust the
value of $S_+^\ell S_-^m S_z^n$ up to the time at which the initial
value of $S_+^\ell S_-^m S_z^M$ has (conservatively) an $\O\p{1}$
contribution to $S_+^\ell S_-^m S_z^n$.

In order to compute squeezing from OAT, we need only need to evolve
$\v V_{\t{OAT}}^{(1,0)}$, $\v V_{\t{OAT}}^{(0,1)}$,
$\v V_{\t{OAT}}^{(1,1)}$, and $\v V_{\t{OAT}}^{(2,0)}$.  The values of
axial spin operators $S_z$ and $S_z^2$ are known exactly at all times
from \eqref{eq:Sz_OAT}.


\section{Transverse-field and two-axis twisting}

All collective spin Hamiltonians can be written in the form
\begin{align}
  H = \sum_{p,q,r} h_{pqr} S_+^p S_-^q S_z^r.
  \label{eq:H_general}
\end{align}
The evolution of a general operator $S_+^\ell S_-^m S_z^n$ under a
Hamiltonian of the form in \eqref{eq:H_general} is given by
\begin{align}
  \f{d}{dt} \p{S_+^\ell S_-^m S_z^n}
  = i\sum_{p,q,r} h_{pqr} \sp{S_+^p S_-^q S_z^r, S_+^\ell S_-^m S_z^n}_-
  + \gamma \D_-\p{S_+^\ell S_-^m S_z^n},
\end{align}
where the commutator is given in Appendix \ref{sec:comm_general}, and
the decoherence operator in Appendix \ref{sec:decoherence}.

\subsection{Transverse-field Hamiltonian}

The transverse-field (TVF) twisting Hamiltonian with unit twisting
strength is
\begin{align}
  H_{\t{TVF}}
  = S_z^2 - \Omega S_x
  = S_z^2 - \f{\Omega}{2} S_+ - \f{\Omega}{2} S_-.
\end{align}
Unlike in the case of OAT, we now cannot divide all operators of the
form $S_+^\ell S_-^m S_z^n$ into independent sectors of constant
imbalances $\ell,m$.  We therefore need to keep track of all operators
in one vector $\v V_{\t{TVF}}$, which in turn requires imposing an
ordering on all operators of the form $S_+^\ell S_-^m S_z^n$.  Such an
ordering is provided by the one-to-one map
$p:\mathbb{N}_0^3\to\mathbb{N}_0$, where $\mathbb{N}_0$ denotes the
set of non-negative integers, given by
\begin{align}
  v\p{\ell,m,n} = B\p{T_{\ell mn}} + R\p{T_{\ell mn},\ell} + m,
  \label{eq:vec_map}
\end{align}
where
\begin{align}
  T_{\ell mn} \equiv \ell + m + n,
  &&
  B\p{T} \equiv \f16 T \p{T+1} \p{T+2},
  &&
  R\p{T,\ell} \equiv \f12 \ell \p{2 T - \ell + 3}.
\end{align}
This map is designed to sort integers $\p{\ell,m,n}$ first by their
sum $T_{\ell mn}$ (i.e.~the total weight of $S_+^\ell S_-^m S_z^n$),
and then in turn by the values of $\ell$, $m$, and $n$, such that
$v\p{\ell,m,n}<v\p{\ell',m',n'}$ if
\begin{enumerate*}[label=(\roman*)]
\item $T_{\ell mn}<T_{\ell'm'n'}$,
\item $T_{\ell mn}=T_{\ell'm'n'}$ and $\ell<\ell'$,
\item $\p{T_{\ell mn},\ell}=\p{T_{\ell'm'n'},\ell'}$ and $m<m'$, or
\item $\p{T_{\ell mn},\ell,m}=\p{T_{\ell'm'n'},\ell',m'}$ and $n<n'$.
\end{enumerate*}
Fixing a maximal operator weight $M$, the vector keeping track of all
operators is then
\begin{align}
  \v V_{\t{TVF}}
  \equiv \sum_{\ell+m+n\le M} S_+^\ell S_-^m S_z^n \uv x_{v\p{\ell,m,n}}.
\end{align}


\subsection{Two-axis twisting in-plane with the decoherence axis}

The two-axis twisting Hamiltonian one axis oriented along the
decoherence axis is
\begin{align}
  H_{\t{TAT}}^{z,y}
  = S_z^2 - S_y^2
  = S_z^2 + \f14 S_+^2 + \f14 S_-^2 - \f12 S_+ S_- + \f12 S_z.
\end{align}
While upper and lower imbalances are not conserved by this
Hamiltonians, the parity of the net imbalance, i.e.~$\ell-m~\t{mod}~2$
for an operator $S_+^\ell S_-^m S_z^n$, is conserved.  There are
therefore two sectors of operators which we can evolve independently
to save computational overhead.


\subsection{Two-axis twisting transverse to the decoherence axis}


The two-axis twisting Hamiltonian with both axes transverse to the
decoherence axis is
\begin{align}
  H_{\t{TAT}}^{y,x}
  = S_y^2 - S_x^2
  = - \f12 S_+^2 - \f12 S_-^2.
\end{align}
Just as with the previous TAT Hamiltonian, the parity of the net
imbalance of operators is conserved by $H_{\t{TAT}}^{y,x}$, implying
that there are two independent sectors of operators to evolve.


\bibliography{\jobname}

\newpage
\appendix

\section{Basic spin operator identities}
\label{sec:identities}

This text makes ubiquitous use of various spin operator identities; we
collect and derive particularly useful identities here for reference.
The elementary commutation relations between single-weight spin
operators are, with $\bmu\equiv-\mu\in\set{+1,-1}$ for brevity,
\begin{align}
  \f12 \sp{\sigma_j^z,\sigma_k^\mu}_-
  &= \delta_{jk} \mu \sigma_j^\mu,
  &
  \sp{S_z,\sigma_j^\mu}_-
  &= \f12 \sp{\sigma_j^z,S_\mu}_- = \mu \sigma_j^\mu,
  &
  \sp{S_z,S_\mu}_-
  &= \mu S_\mu,
  \label{eq:comm_z_mu_base} \\
  \sp{\sigma_j^\mu,\sigma_k^\bmu}_-
  &= \delta_{jk} \mu \sigma_j^z,
  &
  \sp{S_\mu,\sigma_j^\bmu}_-
  &= \sp{\sigma_j^\mu,S_\bmu}_- = \mu \sigma_j^z,
  &
  \sp{S_\mu,S_\bmu}_-
  &= 2 \mu S_z.
  \label{eq:comm_mu_base}
\end{align}
These relations can be used to inductively determine commutation
relations with higher-weight spin operators.  For example, we can find
that
\begin{align}
  S_z S_\mu^m
  = \p{\mu S_\mu + S_\mu S_z} S_\mu^{m-1}
  = \mu S_\mu^m + S_\mu S_z S_\mu^{m-1}
  = 2 \mu S_\mu^m + S_\mu S_z S_\mu^{m-2}
  = S_\mu^m \p{\mu m + S_z},
  \label{eq:push_z_mu_single}
\end{align}
and in turn
\begin{align}
  S_z S_\mu^m S_\bmu^n
  = S_\mu^m \p{\mu m + S_z} S_\bmu^n
  = S_\mu^m S_\bmu^n \p{\mu\sp{m - n} + S_z}.
\end{align}
Repeating this process $\ell$ times tells us
\begin{align}
  S_z^\ell S_\mu^m S_\bmu^n
  = S_\mu^m S_\bmu^n \p{\mu\sp{m - n} + S_z}^\ell,
  \label{eq:push_z_mu}
\end{align}
which implies
\begin{align}
  \sp{S_z^\ell, S_\mu^m S_\bmu^n}_-
  = S_\mu^m S_\bmu^n \sp{\mu^\ell \p{\mu\sp{m - n} + S_z}^\ell - S_z^\ell}
  = S_\mu^m S_\bmu^n  \sum_{k=0}^{\ell-1} {\ell \choose k}
  \mu^{\ell-k} \p{m-n}^{\ell-k} S_z^k.
  \label{eq:comm_z_mu}
\end{align}
Similarly finding commutation relations between high-weight transverse
spin operators, i.e.~$S_\mu^m$ and $S_\bmu^n$, turns out to be
considerably more difficult than the cases we have worked out thus
far.  We therefore save this work for Appendix
\ref{sec:comm_transverse}.


\section{Commutator between powers of two transverse spin operators}
\label{sec:comm_transverse}

To determine commutation relations between high-weight collective spin
operators transverse to the decoherence (i.e.~$z$) axis, we compute
(with $\bmu\equiv-\mu\in\set{+1,-1}$)
\begin{align}
  S_\mu S_\bmu^n
  &= S_\bmu S_\mu S_\bmu^{n-1} + 2\mu S_z S_\bmu^{n-1} \\
  &= S_\bmu \sp{S_\bmu S_\mu S_\bmu^{n-2} + 2\mu S_z S_\bmu^{n-2}}
  + 2\mu S_z S_\bmu^{n-1} \\
  &= S_\bmu^2 S_\mu S_\bmu^{n-2}
  + 2\mu \p{S_\bmu S_z S_\bmu ^{n-2} + S_z S_\bmu^{n-1}} \\
  &= S_\bmu^n S_\mu + 2\mu \sum_{k=0}^{n-1} S_\bmu^k S_z S_\bmu^{n-k-1}.
  \label{eq:comm_mu_single}
\end{align}
While \eqref{eq:comm_mu_single} gives us the commutator
$\sp{S_\mu,S_\bmu^n}_-$, we would like to enforce an ordering on
products of collective spin operators, which allows us to only keep
track of high-weight operators that are linearly independent.  We
(arbitrarily) choose to impose an ordering with all $S_z$ operators on
the right.  This choice of ordering compels us to expand
\begin{align}
  2 \mu \sum_{k=0}^{n-1} S_\bmu^k S_z S_\bmu^{n-k-1}
  = 2 \mu \sum_{k=0}^{n-1}
  S_\bmu^k S_\bmu^{n-k-1} \p{\bmu\sp{n-k-1} + S_z}
  = n S_\bmu^{n-1}\p{1 - n + 2\mu S_z},
\end{align}
so
\begin{align}
  \sp{S_\mu, S_\bmu^n}_-
  = n S_\bmu^{n-1}\p{1 - n + 2\mu S_z}.
\end{align}
As the next logical step, we take on the task of computing
\begin{align}
  S_\mu^m S_\bmu^n
  &= S_\mu^{m-1} S_\bmu^n S_\mu
  + n \sp{S_\mu^{m-1} S_\bmu^{n-1} \p{1 - n + 2\mu S_z}} \\
  &= S_\bmu^n S_\mu^m
  + n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_z} S_\mu^k,
\end{align}
which implies
\begin{align}
  \sp{S_\mu^m, S_\bmu^n}_-
  = C_{mn;\mu}
  \equiv n \sum_{k=0}^{m-1} S_\mu^{m-k-1} S_\bmu^{n-1}
  \p{1 - n + 2\mu S_z} S_\mu^k.
\end{align}
We now need rearrange the operators in $C_{mn;\mu}$ into a standard
order, which means pushing all $S_z$ operators to the right and, for
the purposes of this calculation, all $S_\bmu$ operators on the left.
We begin by pushing $S_\mu^k$ to the left of $S_z$, which takes
$2\mu S_z\to 2\mu S_z+2k$, and then push $S_\mu^{m-k-1}$ to the right
of $S_\bmu^{n-1}$, giving us
\begin{align}
  C_{mn;\mu}
  &= n \sum_{k=0}^{m-1}
  \p{S_\bmu^{n-1} S_\mu^{m-k-1} + C_{m-k-1,n-1;\mu}} S_\mu^k
  \p{2k + 1 - n + 2\mu S_z} \\
  &= D_{mn;\mu}
  + n \sum_{k=0}^{m-2} C_{m-k-1,n-1;\mu}
  S_\mu^k \p{2k + 1 - n + 2\mu S_z},
  \label{eq:C_mn}
\end{align}
where we have dropped the last term in the final sum because
$C_{m-k-1,n-1;\mu}=0$ if $k=m-1$, and
\begin{align}
  D_{mn;\mu}
  \equiv mn S_\bmu^{n-1} S_\mu^{m-1} \p{m - n + 2\mu S_z}.
  \label{eq:D_mn}
\end{align}
To our despair, we have arrived in \eqref{eq:C_mn} to a recursive
formula for $C_{mn;\mu}$.  Furthermore, we have not even managed to
order the spin operators, as $C_{m-k-1,n-1;\mu}$ contains $S_z$
operators which are to the left of $S_\mu^k$.  To sort all spin
operators once and for all, we define
\begin{align}
  C_{mn;\mu}^{(k)} \equiv C_{m-k,n;\mu} S_\mu^k,
  &&
  D_{mn;\mu}^{(k)} \equiv D_{m-k,n;\mu} S_\mu^k,
\end{align}
which we can expand as
\begin{align}
  D_{mn;\mu}^{(k)}
  &\equiv D_{m-k,n;\mu}S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-k-1}
  \p{m-k-n+2\mu S_z} S_\mu^k \\
  &= \p{m-k}n S_\bmu^{n-1} S_\mu^{m-1} \p{k+m-n+2\mu S_z},
  \label{eq:D_mn_k}
\end{align}
and
\begin{align}
  C_{mn;\mu}^{(k)}
  &= D_{m-k,n;\mu} S_\mu^k + n \sum_{j=0}^{m-k-2}
  C_{m-k-j-1,n-1;\mu} S_\mu^j \p{2j+1-n+2\mu S_z} S_\mu^k \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{m-k-j-1,n-1;\mu} S_\mu^{j+k} \p{2j+2k+1-n+2\mu S_z} \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=0}^{m-k-2}
  C_{m-1,n-1;\mu}^{(k+j)} \p{2\sp{j+k}+1-n+2\mu S_z} \\
  &= D_{mn;\mu}^{(k)} + n \sum_{j=k}^{m-2}
  C_{m-1,n-1;\mu}^{(j)} \p{2j+1-n+2\mu S_z}.
  \label{eq:C_mn_k}
\end{align}
While the resulting expression in \eqref{eq:C_mn_k} strongly resembles
that in \eqref{eq:C_mn}, there is one crucial difference: all spin
operators in \eqref{eq:C_mn_k} have been sorted into a standard order.
We can now repeatedly substitute $C_{mn;\mu}^{(k)}$ into itself, each
time decreasing $m$ and $n$ by 1, until one of $m$ or $n$ reaches
zero.  Such repeated substitution yields the expansion
\begin{align}
  C_{mn;\mu}
  = C_{mn;\mu}^{(0)}
  = D_{mn;\mu}
  + \sum_{p=1}^{\min\set{m,n}-1} E_{mn;\mu}^{(p)},
  \label{eq:C_mn_E}
\end{align}
where the first two terms in the sum over $p$ are
\begin{align}
  E_{mn;\mu}^{(1)}
  &= n \sum_{k=0}^{m-2} D_{m-1,n-1;\mu}^{(k)}
  \p{2k+1-n+2\mu S_z}, \\
  E_{mn;\mu}^{(2)}
  &= n \sum_{k_1=0}^{m-2} \p{n-1} \sum_{k_2=k_1}^{m-3}
  D_{m-2,n-2;\mu}^{(k_2)}
  \p{2k_2+2-n+2\mu S_z} \p{2k_1+1-n+2\mu S_z},
\end{align}
and more generally for $p>1$,
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{k_1=0}^{m-2} \sum_{k_2=k_1}^{m-3} \cdots\sum_{k_p=k_{p-1}}^{m-p-1}
  D_{m-p,n-p;\mu}^{(k_p)} \prod_{j=1}^p \p{2k_j+j-n+2\mu S_z}.
  \label{eq:E_mn_p}
\end{align}
In principle, the expressions in \eqref{eq:D_mn} and
\eqref{eq:C_mn_E}-\eqref{eq:E_mn_p} can be used to evaluate the
commutator $\sp{S_\mu^m,S_\bmu^n}_- = C_{mn;\mu}$, but these result
are -- to put it lightly -- quite a mess: the expression for
$E_{mn;\mu}^{(p)}$ in \eqref{eq:E_mn_p} involves a sum over $p$
mutually dependent intermediate variables!  We therefore devote the
rest of this section to simplifying our result for the commutator
$\sp{S_\mu^m,S_\bmu^n}_-$.

Observing that we always have
$0\le k_1\le k_2\le\cdots\le k_p\le m-p-1$ in \eqref{eq:E_mn_p}, we
can rearrange the order of the sums and relabel $k_p\to\ell$ to get
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p}!}
  \sum_{\ell=0}^{m-p-1} D_{m-p,n-p;\mu}^{(\ell)} \p{2\ell+F_{np;\mu}}
  \sum_{\p{\v k,p,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}},
  \label{eq:E_mn_p_sum}
\end{align}
where for shorthand we define
\begin{align}
  F_{np;\mu} \equiv p - n + 2\mu S_z,
  &&
  \sum_{\p{\v k,p,\ell}} X \equiv
  \sum_{k_1=0}^\ell \sum_{k_2=k_1}^\ell
  \cdots \sum_{k_{p-1}=k_{p-2}}^\ell X.
\end{align}
We now define
\begin{align}
  f_{np\ell;\mu}\p{k,q} \equiv \p{\ell-k+q} \p{\ell+k-q+F_{np;\mu}},
\end{align}
and evaluate sums successively over $k_{p-1},k_{p-2},\cdots,k_1$,
finding
\begin{align}
  \sum_{\p{\v k,p,\ell}} \prod_{j=1}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  &= \sum_{\p{\v k,p-1,\ell}}
  \prod_{j=2}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  f_{np\ell;\mu}\p{k_{p-2},1} \\
  &= \f1{r!} \sum_{\p{\v k,p-r,\ell}}
  \prod_{j=1+r}^{p-1} \p{2k_{p-j}-j+F_{np;\mu}}
  \prod_{q=1}^r f_{np\ell;\mu}\p{k_{p-1-r},q} \\
  &= \f1{\p{p-1}!} \prod_{q=1}^{p-1} f_{np\ell;\mu}\p{0,q} \\
  &= { \ell + p - 1 \choose p - 1 }
  \prod_{q=1}^{p-1} \p{\ell-q+F_{np;\mu}}.
\end{align}
Substitution of this result together with $D_{m-p,n-p;\mu}^{(\ell)}$
with \eqref{eq:D_mn_k} into \eqref{eq:E_mn_p_sum} then gives us
\begin{align}
  E_{mn;\mu}^{(p)}
  = \f{n!}{\p{n-p-1}!} S_\bmu^{n-p-1} S_\mu^{m-p-1} G_{mnp;\mu}
\end{align}
with
\begin{align}
  G_{mnp;\mu}
  &\equiv \sum_{\ell=0}^{m-p-1} { \ell + p - 1 \choose p - 1 }
  \p{m-p-\ell} \p{\ell+m-p+F_{np;\mu}}
  \p{2\ell + F_{np;\mu}}
  \prod_{q=1}^{p-1} \p{\ell-q+F_{np;\mu}} \\
  &= { m \choose p + 1 } \prod_{q=0}^p \p{m-p-q+F_{np;\mu}}.
\end{align}
We can further expand
\begin{align}
  \prod_{q=0}^p \p{m-p-q+F_{np;\mu}}
  = \prod_{q=0}^p \p{m-n-q+2\mu S_z}
  = \sum_{q=0}^{p+1} \p{-1}^{p+1-q} { p+1 \brack q } \p{m-n+2\mu S_z}^q,
\end{align}
where ${ n \brack k }$ is an unsigned Stirling number of the first
kind, and finally
\begin{align}
  \sum_{q=0}^p \p{-1}^{p-q} { p \brack q } \p{m-n+2\mu S_z}^q
  &= \sum_{q=0}^p \p{-1}^{p-q} { p \brack q } \sum_{\ell=0}^q
  { q \choose \ell } \p{m-n}^{q-\ell} \p{2\mu S_z}^\ell \\
  &= \sum_{\ell=0}^p \p{2\mu}^\ell \sum_{q=\ell}^p \p{-1}^{p-q}
  { p \brack q } { q \choose \ell } \p{m-n}^{q-\ell} S_z^\ell.
\end{align}
Putting everything together, we finally have
\begin{align}
  E_{mn;\mu}^{(p-1)}
  = p! { m \choose p } { n \choose p }
  S_\bmu^{n-p} S_\mu^{m-p} \sum_{\ell=0}^p
  \mu^\ell \epsilon_{mnp}^{(\ell)} S_z^\ell,
\end{align}
with
\begin{align}
  \epsilon_{mnp}^{(\ell)}
  \equiv 2^\ell \sum_{q=\ell}^p \p{-1}^{p-q}
  { p \brack q } { q \choose \ell } \p{m-n}^{q-\ell},
  \label{eq:epsilon}
\end{align}
where in this final form $E_{mn;\mu}^{(0)} = D_{mn;\mu}$, which
together with \eqref{eq:C_mn_E} implies that
\begin{align}
  \sp{S_\mu^m, S_\bmu^n}_-
  = \sum_{p=1}^{\min\set{m,n}}
  p! { m \choose p } { n \choose p } S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \mu^\ell \epsilon_{mnp}^{(\ell)} S_z^\ell,
  \label{eq:comm_mu}
\end{align}
and
\begin{align}
  S_\mu^m S_\bmu^n
  = \sum_{p=0}^{\min\set{m,n}}
  p! { m \choose p } { n \choose p } S_\bmu^{n-p} S_\mu^{m-p}
  \sum_{\ell=0}^p \mu^\ell \epsilon_{mnp}^{(\ell)} S_z^\ell.
  \label{eq:push_mu_nu}
\end{align}



\section{Commutator between general ordered collective spin operators}
\label{sec:comm_general}

If all collective spin operators are written as ordered products of
$S_+$, $S_-$, and $S_z$ with all $S_z$ on the right, then the most
general commutator we need to consider is (with
$\bmu\equiv-\mu\in\set{+1,-1}$)
\begin{align}
  \sp{S_\mu^p S_\bmu^q S_z^a, S_\mu^r S_\bmu^s S_z^b}_-
  = \S^{pqa}_{rsb;\mu} - \S^{rsb}_{pqa;\mu},
  &&
  \S^{pqa}_{rsb;\mu}
  \equiv S_\mu^p S_\bmu^q S_z^a S_\mu^r S_\bmu^s S_z^b.
\end{align}
We can push the $S_z^a$ in $\S^{pqa}_{rsb;\mu}$ to the right through
$S_\mu^r S_\bmu^s$ to get
\begin{align}
  \S^{pqa}_{rsb;\mu}
  = S_\mu^p S_\bmu^q S_\mu^r S_\bmu^s  \p{\mu\sp{r-s}+S_z}^a S_z^b,
\end{align}
then reorder $S_\bmu^q S_\mu^r$ with \eqref{eq:push_mu_nu} to expand
\begin{align}
  S_\mu^p S_\bmu^q S_\mu^r S_\bmu^s
  = \sum_{k=0}^{\min\set{q,r}}
  k! { q \choose k } { r \choose k } S_\mu^{p+r-k} S_\bmu^{q-k}
  \sum_{\ell=0}^k \p{-\mu}^\ell \epsilon_{qrk}^{(\ell)}
  S_z^\ell S_\bmu^s,
\end{align}
and finally push $S_z^\ell$ to the right through $S_\bmu^s$, finding
\begin{align}
  \S^{pqa}_{rsb;\mu}
  = \sum_{k=0}^{\min\set{q,r}} k! { q \choose k } { r \choose k }
  S_\mu^{p+r-k} S_\bmu^{q+s-k}
  \sum_{\ell=0}^k \p{-\mu}^\ell \epsilon_{qrk}^{(\ell)}
  Z_{abrs;\mu}^{(\ell)},
\end{align}
where $\epsilon_{qrk}^{(\ell)}$ is defined in \eqref{eq:epsilon} and
\begin{align}
  Z_{abrs;\mu}^{(\ell)}
  &\equiv \p{-\mu s+S_z}^\ell \p{\mu\sp{r-s}+S_z}^a S_z^b \\
  &= \sum_{m=0}^\ell { \ell \choose m } \p{-\mu s}^{\ell-m}
  \sum_{n=0}^a { a \choose n } \p{\mu\sp{r-s}}^{a-n} S_z^{b+m+n}.
\end{align}


\section{Decoherence of collective spin operators through individual
  spin decay}
\label{sec:decoherence}

The decoherence operator for uncorrelated decay ($\mu=-1$) or
excitation ($\mu=1$) of individual spins is, with $\bmu\equiv-\mu$,
\begin{align}
  \D_\mu\p{\O}
  \equiv \sum_j\p{\sigma_j^\bmu \O \sigma_j^\mu
    - \f12\sp{\sigma_j^\bmu \sigma_j^\mu,\O}_+},
\end{align}
where
\begin{align}
  \sum_j \f12\sp{\sigma_j^\bmu \sigma_j^\mu,\O}_+
  = \f12\sp{S-\mu S_z,\O}_+
  = S\O - \f{\mu}{2}\sp{S_z,\O}_+
  = \O\p{S-\mu S_z} - \f{\mu}{2}\sp{S_z,\O}_-,
\end{align}
so
\begin{align}
  \D_\mu\p{\O}
  = \sum_j \sigma_j^\bmu \O \sigma_j^\mu
  - \O\p{S - \mu S_z} + \f{\mu}{2} \sp{S_z,\O}_-.
\end{align}

\subsection{The simple case}

If we consider only ordered collective spin operators, there are two
cases to work out: the effect of decoherence through $\D_\mu$ on
$S_\mu^\ell S_\bmu^m S_z^n$, and the effect on
$S_\bmu^\ell S_\mu^m S_z^n$.  We work out the latter case first,
namely
\begin{align}
  \D_\mu\p{S_\bmu^\ell S_\mu^m S_z^n}
  = \sum_j \sigma_j^\bmu S_\bmu^\ell S_\mu^m S_z^n \sigma_j^\mu
  - S_\bmu^\ell S_\mu^m S_z^n \p{S - \mu S_z}
  + \f{\mu}{2} \sp{S_z, S_\bmu^\ell S_\mu^m S_z^n}_-.
  \label{eq:D_mu_nu}
\end{align}
The commutator in \eqref{eq:D_mu_nu} is straightforward to simplify
using \eqref{eq:comm_z_mu}:
\begin{align}
  \mu \sp{S_z, S_\bmu^\ell S_\mu^m S_z^n}_-
  = \mu \sp{S_z, S_\bmu^\ell S_\mu^m}_- S_z^n
  = \mu\bmu \p{\ell-m} S_\bmu^\ell S_\mu^m S_z^n
  = - \p{\ell-m} S_\bmu^\ell S_\mu^m S_z^n,
\end{align}
while the first term in \eqref{eq:D_mu_nu} can be written in terms of
collective spin operators if we use \eqref{eq:comm_z_mu_base} to push
the jump operators together, noting that $\sigma_j^\mu$ commutes with
$S_\mu$:
\begin{align}
  \sum_j \sigma_j^\bmu S_\bmu^\ell S_\mu^m S_z^n \sigma_j^\mu
  = \sum_j S_\bmu^\ell \sigma_j^\bmu \sigma_j^\mu S_\mu^m \p{\mu+S_z}^n
  = S_\bmu^\ell \p{S - \mu S_z} S_\mu^m
  \sum_{k=0}^n \mu^{n-k} { n \choose k } S_z^k.
  \label{eq:combine_jumps}
\end{align}
Finally, we push the middle $S_z$ to the right using
\eqref{eq:push_z_mu_single}:
\begin{align}
  \sum_j \sigma_j^\bmu S_\bmu^\ell S_\mu^m S_z^n \sigma_j^\mu
  = S_\bmu^\ell S_\mu^m \p{S - m - \mu S_z}
  \sum_{k=0}^n \mu^{n-k} { n \choose k } S_z^k.
\end{align}
Altogether, we have that
\begin{align}
  \D_\mu\p{S_\bmu^\ell S_\mu^m S_z^n}
  &= S_\bmu^\ell S_\mu^m \sp{\p{S - m - \mu S_z} \sum_{k=0}^n
    \mu^{n-k} { n \choose k } S_z^k
    - \p{S - \mu S_z + \f12\sp{\ell-m}} S_z^n} \\
  &= S_\bmu^\ell S_\mu^m \sp{\p{S - m - \mu S_z} \sum_{k=0}^{n-1}
    \mu^{n-k} { n \choose k } S_z^k - \f12 \p{\ell+m} S_z^n}.
\end{align}
Decoherence through $\D_\mu$ only couples operators of the form
$S_\bmu^\ell S_\mu^m S_z^n$ to operators of the (almost identical)
form $S_\bmu^\ell S_\mu^m S_z^{n'}$ with $n'\le n$.


\subsection{The harder case}

The second case to consider for the decoherence of general ordered
collective spin operators is
\begin{align}
  \D_\mu\p{S_\mu^\ell S_\bmu^m S_z^n}
  = \sum_j \sigma_j^\bmu S_\mu^\ell S_\bmu^m S_z^n \sigma_j^\mu
  - S_\mu^\ell S_\bmu^m S_z^n \p{S - \mu S_z}
  + \f{\mu}{2} \sp{S_z, S_\mu^\ell S_\bmu^m S_z^n}_-.
  \label{eq:D_mu_mu}
\end{align}
Similarly to before, the commutator in \eqref{eq:D_mu_mu} is
\begin{align}
  \mu \sp{S_z, S_\mu^\ell S_\bmu^m S_z^n}_-
  = \mu \sp{S_z, S_\mu^\ell S_\bmu^m}_- S_z^n
  = \mu\mu \p{\ell-m} S_\mu^\ell S_\bmu^m S_z^n
  = \p{\ell-m} S_\mu^\ell S_\bmu^m S_z^n.
\end{align}
The difficulty now is with the first term in \eqref{eq:D_mu_mu}, as
$\sigma_j^\bmu$ and $S_\mu$ do not commute.

\end{document}
